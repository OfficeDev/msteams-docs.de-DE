---
title: Erstellen einer Seite zum Entfernen von Registerkarten
author: laujan
description: So erstellen Sie eine Registerkarte zum Entfernen von Registerkarten
keywords: Teams Registerkarten Gruppenkanal konfigurierbar entfernen löschen
localization_priority: Normal
ms.topic: conceptual
ms.author: lajanuar
ms.openlocfilehash: e1a1f38a2bcb3b5bc4bc54f469c8727e44d8695e
ms.sourcegitcommit: 51e4a1464ea58c254ad6bd0317aca03ebf6bf1f6
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 05/19/2021
ms.locfileid: "52566670"
---
# <a name="modify-or-remove-a-channel-group-tab"></a><span data-ttu-id="4d9f8-104">Ändern oder Entfernen einer Kanalgruppenregisterkarte</span><span class="sxs-lookup"><span data-stu-id="4d9f8-104">Modify or remove a channel group tab</span></span>

<span data-ttu-id="4d9f8-105">Sie können die Benutzerfreundlichkeit erweitern und verbessern, indem Sie Entfernungs- und Änderungsoptionen in Ihrer App unterstützen.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-105">You can extend and enhance the user experience by supporting removal and modification options in your app.</span></span> <span data-ttu-id="4d9f8-106">Teams ermöglicht benutzern das Umbenennen oder Entfernen einer Kanal-/Gruppenregisterkarte, und Sie können Benutzern erlauben, die Registerkarte nach der Installation neu zu konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-106">Teams enables users to rename or remove a channel/group tab and you can permit users to reconfigure your tab after installation.</span></span> <span data-ttu-id="4d9f8-107">Darüber hinaus kann Ihre Registerkartenentfernungserfahrung die Angabe dessen umfassen, was mit dem Inhalt geschieht, wenn Ihre Registerkarte entfernt wird, oder Benutzern Optionen für das Nachentfernen nach dem Entfernen wie Löschen oder Archivieren des Inhalts zu geben.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-107">Additionally, your tab removal experience can include designating what happens to the content when your tab is removed or giving users post-removal options such as deleting or archiving the content.</span></span>

## <a name="enable-your-tab-to-be-reconfigured-after-installation"></a><span data-ttu-id="4d9f8-108">Aktivieren Sie die Neukonfiguration der Registerkarte nach der Installation</span><span class="sxs-lookup"><span data-stu-id="4d9f8-108">Enable your tab to be reconfigured after installation</span></span>

<span data-ttu-id="4d9f8-109">Ihre **manifest.jsauf** definiert die Funktionen und Funktionen Ihrer Registerkarte.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-109">Your **manifest.json** defines your tab's features and capabilities.</span></span> <span data-ttu-id="4d9f8-110">Die Tabstoppinstanzeigenschaft `canUpdateConfiguration` nimmt einen booleschen Wert an, der angibt, ob ein Benutzer die Registerkarte ändern oder neu konfigurieren kann, nachdem sie erstellt wurde:</span><span class="sxs-lookup"><span data-stu-id="4d9f8-110">The tab instance `canUpdateConfiguration` property takes a Boolean value that indicates whether a user can modify or reconfigure the tab after it is created:</span></span>

|<span data-ttu-id="4d9f8-111">Name</span><span class="sxs-lookup"><span data-stu-id="4d9f8-111">Name</span></span>| <span data-ttu-id="4d9f8-112">Typ</span><span class="sxs-lookup"><span data-stu-id="4d9f8-112">Type</span></span>| <span data-ttu-id="4d9f8-113">Maximale Größe</span><span class="sxs-lookup"><span data-stu-id="4d9f8-113">Maximum size</span></span> | <span data-ttu-id="4d9f8-114">Erforderlich</span><span class="sxs-lookup"><span data-stu-id="4d9f8-114">Required</span></span> | <span data-ttu-id="4d9f8-115">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="4d9f8-115">Description</span></span>|
|---|---|---|---|---|
|`canUpdateConfiguration`|<span data-ttu-id="4d9f8-116">Boolescher Wert</span><span class="sxs-lookup"><span data-stu-id="4d9f8-116">Boolean</span></span>|||<span data-ttu-id="4d9f8-117">Ein Wert, der angibt, ob eine Instanz der Registerkartenkonfiguration vom Benutzer nach der Erstellung aktualisiert werden kann.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-117">A value indicating whether an instance of the tab's configuration can be updated by the user after creation.</span></span> <span data-ttu-id="4d9f8-118">Standard: `true`</span><span class="sxs-lookup"><span data-stu-id="4d9f8-118">Default: `true`</span></span>|

<span data-ttu-id="4d9f8-119">Wenn Ihre Registerkarte in einen Kanal- oder Gruppenchat hochgeladen wird, wird Teams ein Dropdown-Menü mit rechts klicken. Die verfügbaren Optionen werden durch die `canUpdateConfiguration` Einstellung bestimmt:</span><span class="sxs-lookup"><span data-stu-id="4d9f8-119">When your tab is uploaded to a channel or group chat, Teams will add a right-click drop-down menu for your tab. The available options are determined by the `canUpdateConfiguration` setting:</span></span>

| `canUpdateConfiguration`| <span data-ttu-id="4d9f8-120">true</span><span class="sxs-lookup"><span data-stu-id="4d9f8-120">true</span></span>   | <span data-ttu-id="4d9f8-121">false</span><span class="sxs-lookup"><span data-stu-id="4d9f8-121">false</span></span> | <span data-ttu-id="4d9f8-122">description</span><span class="sxs-lookup"><span data-stu-id="4d9f8-122">description</span></span> |
| ----------------------- | :----: | ----- | ----------- |
|     <span data-ttu-id="4d9f8-123">Einstellungen</span><span class="sxs-lookup"><span data-stu-id="4d9f8-123">Settings</span></span>            |   <span data-ttu-id="4d9f8-124">√</span><span class="sxs-lookup"><span data-stu-id="4d9f8-124">√</span></span>    |       |<span data-ttu-id="4d9f8-125">Die `configurationUrl` Seite wird in einem IFrame neu geladen, sodass der Benutzer die Registerkarte neu konfigurieren kann.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-125">The `configurationUrl` page is reloaded in an IFrame allowing the user to reconfigure the tab.</span></span>  |
|     <span data-ttu-id="4d9f8-126">Umbenennen</span><span class="sxs-lookup"><span data-stu-id="4d9f8-126">Rename</span></span>              |   <span data-ttu-id="4d9f8-127">√</span><span class="sxs-lookup"><span data-stu-id="4d9f8-127">√</span></span>    |   <span data-ttu-id="4d9f8-128">√</span><span class="sxs-lookup"><span data-stu-id="4d9f8-128">√</span></span>   | <span data-ttu-id="4d9f8-129">Der Benutzer kann den Tabnamen so ändern, wie er in der Registerkartenleiste angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-129">The user can change the tab name as it appears in the tab bar.</span></span>          |
|     <span data-ttu-id="4d9f8-130">Entfernen</span><span class="sxs-lookup"><span data-stu-id="4d9f8-130">Remove</span></span>              |   <span data-ttu-id="4d9f8-131">√</span><span class="sxs-lookup"><span data-stu-id="4d9f8-131">√</span></span>    |   <span data-ttu-id="4d9f8-132">√</span><span class="sxs-lookup"><span data-stu-id="4d9f8-132">√</span></span>   |  <span data-ttu-id="4d9f8-133">Wenn die Eigenschaft und der  `removeURL` Wert auf der **Konfigurationsseite** enthalten sind, wird die **Entfernungsseite** in einen IFrame geladen und dem Benutzer angezeigt.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-133">If the  `removeURL` property and value are included in the **configuration page**, the **removal page** is loaded into an IFrame and presented to the user.</span></span> <span data-ttu-id="4d9f8-134">Wenn eine Entfernungsseite nicht enthalten ist, wird dem Benutzer ein Dialogfeld bestätigen angezeigt.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-134">If a removal page is not included the user is presented with a confirm dialog box.</span></span>          |
|||||

## <a name="create-a-tab-removal-page-for-your-application"></a><span data-ttu-id="4d9f8-135">Erstellen einer Registerkarte zum Entfernen ihrer Anwendung</span><span class="sxs-lookup"><span data-stu-id="4d9f8-135">Create a tab removal page for your application</span></span>

<span data-ttu-id="4d9f8-136">Die optionale Entfernungsseite ist eine HTML-Seite, die Sie hosten und beim Entfernen der Registerkarte angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-136">The optional removal page is an HTML page that you host and is displayed when the tab is removed.</span></span> <span data-ttu-id="4d9f8-137">Die URL der Entfernungsseite wird von der `setSettings()` Methode auf der Konfigurationsseite festgelegt.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-137">The removal page URL is designated by the `setSettings()` method within your configuration page.</span></span> <span data-ttu-id="4d9f8-138">Wie bei allen Seiten in Ihrer App muss die Entfernungsseite [Teams Tabstoppanforderungen](../../../tabs/how-to/tab-requirements.md)entsprechen.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-138">As with all pages in your app, the removal page must comply with [Teams tab requirements](../../../tabs/how-to/tab-requirements.md).</span></span>

### <a name="register-a-remove-handler"></a><span data-ttu-id="4d9f8-139">Registrieren eines Remove-Handlers</span><span class="sxs-lookup"><span data-stu-id="4d9f8-139">Register a remove handler</span></span>

<span data-ttu-id="4d9f8-140">Optional können Sie in der Entfernerlogik den Ereignishandler aufrufen, `registerOnRemoveHandler((RemoveEvent) => {}` wenn der Benutzer eine vorhandene Registerkartenkonfiguration entfernt.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-140">Optionally, within your removal page logic, you can  invoke the `registerOnRemoveHandler((RemoveEvent) => {}` event handler when the user removes an existing tab configuration.</span></span> <span data-ttu-id="4d9f8-141">Die Methode nimmt die [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest&preserve-view=true) Schnittstelle auf und führt den Code im Handler aus, wenn ein Benutzer versucht, Inhalte zu entfernen.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-141">The  method takes in the [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest&preserve-view=true) interface and executes the code in the handler when a user attempts to remove content.</span></span> <span data-ttu-id="4d9f8-142">Es wird verwendet, um Bereinigungsvorgänge durchzuführen, z. B. das Entfernen der zugrunde liegenden Ressource, die den Tabstoppinhalt anmacht.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-142">It is used to perform cleanup operations such as removing the underlying resource powering the tab content.</span></span> <span data-ttu-id="4d9f8-143">Es kann jeweils nur ein Remove-Handler registriert werden.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-143">Only one remove handler can be registered at a time.</span></span>

<span data-ttu-id="4d9f8-144">Die `RemoveEvent` Schnittstelle beschreibt ein Objekt mit zwei Methoden:</span><span class="sxs-lookup"><span data-stu-id="4d9f8-144">The `RemoveEvent` interface describes an object with two methods:</span></span>

* <span data-ttu-id="4d9f8-145">Die `notifySuccess()` Funktion ist erforderlich.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-145">The `notifySuccess()` function is required.</span></span> <span data-ttu-id="4d9f8-146">Es zeigt an, dass das Entfernen der zugrunde liegenden Ressource erfolgreich war und ihr Inhalt entfernt werden kann.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-146">It indicates that the removal of the underlying resource succeeded and its content can be removed.</span></span>

* <span data-ttu-id="4d9f8-147">Die `notifyFailure(string)` Funktion ist optional.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-147">The `notifyFailure(string)` function is optional.</span></span> <span data-ttu-id="4d9f8-148">Es weist darauf hin, dass das Entfernen der zugrunde liegenden Ressource fehlgeschlagen ist und ihr Inhalt nicht entfernt werden kann.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-148">It indicates that removal of the underlying resource failed and its content cannot be removed.</span></span> <span data-ttu-id="4d9f8-149">Der optionale Zeichenfolgenparameter gibt einen Grund für den Fehler an.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-149">The optional string parameter specifies a reason for the failure.</span></span> <span data-ttu-id="4d9f8-150">Falls angegeben, wird diese Zeichenfolge dem Benutzer angezeigt. Andernfalls wird ein generischer Fehler angezeigt.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-150">If provided, this string is displayed to the user; otherwise a generic error is displayed.</span></span>

#### <a name="use-the-getsettings-function"></a><span data-ttu-id="4d9f8-151">Verwenden Sie die `getSettings()` Funktion</span><span class="sxs-lookup"><span data-stu-id="4d9f8-151">Use the `getSettings()` function</span></span>

<span data-ttu-id="4d9f8-152">Sie können `getSettings()` den zu entfernenden Tabstoppinhalt festlegen.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-152">You can use `getSettings()`to designate the tab content to be removed.</span></span> <span data-ttu-id="4d9f8-153">Die Funktion nimmt die ein `getSettings((Settings) =>{})` und stellt die gültigen [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest&preserve-view=true) Einstellungseigenschaftswerte bereit, die abgerufen werden können.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-153">The `getSettings((Settings) =>{})` function takes in the [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest&preserve-view=true) and provides the valid settings property values that can be retrieved.</span></span>

#### <a name="use-the-getcontext-function"></a><span data-ttu-id="4d9f8-154">Verwenden Sie die `getContext()` Funktion</span><span class="sxs-lookup"><span data-stu-id="4d9f8-154">Use the `getContext()` function</span></span>

<span data-ttu-id="4d9f8-155">Sie können `getContext()` verwenden, um den aktuellen Kontext abzurufen, in dem der Frame ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-155">You can use `getContext()` to retrieves the current context in which the frame is running.</span></span> <span data-ttu-id="4d9f8-156">Die Funktion nimmt die ein `getContext((Context) =>{})` [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest&preserve-view=true) und stellt gültige `Context` Eigenschaftswerte bereit, die Sie in der Seitenlogik zum Entfernen verwenden können, um den Inhalt zu bestimmen, der auf der Entfernungsseite angezeigt werden soll.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-156">The `getContext((Context) =>{})` function takes in the [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest&preserve-view=true) and provides valid `Context` property values that you can use in your removal page logic to determine the content to display in the removal page.</span></span>

#### <a name="include-authentication"></a><span data-ttu-id="4d9f8-157">Authentifizierung einschließen</span><span class="sxs-lookup"><span data-stu-id="4d9f8-157">Include authentication</span></span>

<span data-ttu-id="4d9f8-158">Möglicherweise benötigen Sie eine Authentifizierung, bevor Sie einem Benutzer das Löschen des Registerkarteninhalts gestatten.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-158">You might require authentication before allowing a user to delete the tab content.</span></span> <span data-ttu-id="4d9f8-159">Kontextinformationen können verwendet werden, um Authentifizierungsanforderungen und Autorisierungsseiten-URLs zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-159">Context information can be used to help construct authentication requests and authorization page URLs.</span></span> <span data-ttu-id="4d9f8-160">Weitere Informationen [finden Sie unter Microsoft Teams Authentifizierungsablauf für Registerkarten](~/tabs/how-to/authentication/auth-flow-tab.md).</span><span class="sxs-lookup"><span data-stu-id="4d9f8-160">See [Microsoft Teams authentication flow for tabs](~/tabs/how-to/authentication/auth-flow-tab.md).</span></span> <span data-ttu-id="4d9f8-161">Stellen Sie sicher, dass alle Domänen, die auf den Registerkarten verwendet werden, im Array aufgeführt `manifest.json` `validDomains` sind.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-161">Make sure that all domains used in your tab pages are listed in the `manifest.json` `validDomains` array.</span></span>

<span data-ttu-id="4d9f8-162">Unten ist ein Beispiel Tab-Entfernung Code-Block:</span><span class="sxs-lookup"><span data-stu-id="4d9f8-162">Below is a sample tab removal code block:</span></span>

```html
<body>
  <button onclick="onClick()">Delete this tab and all underlying data?</button>
  <script>
    microsoftTeams.initialize();
    microsoftTeams.settings.registerOnRemoveHandler((removeEvent) => {
      // Here you can designate the tab content to be removed and/or archived.
        microsoftTeams.settings.getSettings((settings) => {
        settings.contentUrl = "..."
        });
        removeEvent.notifySuccess();
    });

    const onClick() => {
        microsoftTeams.settings.setValidityState(true);
    }
  </script>
</body>

```

<span data-ttu-id="4d9f8-163">Wenn ein Benutzer aus dem Dropdown-Menü der Registerkarte **Entfernen** auswählt, lädt Teams die optionale `removeUrl` Seite (die auf der **Konfigurationsseite** angegeben ist) in einen IFrame.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-163">When a user selects **Remove** from the tab's drop-down menu, Teams will load the optional `removeUrl` page (designated in your **configuration page**) into an IFrame.</span></span> <span data-ttu-id="4d9f8-164">Hier wird dem Benutzer eine Schaltfläche angezeigt, die mit der Funktion geladen ist, die `onClick()` aufruft `microsoftTeams.settings.setValidityState(true)` und die Schaltfläche **Entfernen** am unteren Rand der Entfernungsseite IFrame aktiviert.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-164">Here, the user is presented with a button loaded with the `onClick()` function that calls `microsoftTeams.settings.setValidityState(true)` and enables the **Remove** button located near the bottom of the removal page IFrame.</span></span>

<span data-ttu-id="4d9f8-165">Nach der Ausführung des Remove-Handlers `removeEvent.notifySuccess()` oder benachrichtigt Teams des `removeEvent.notifyFailure()` Inhaltsentfernungsergebnisses.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-165">Following the execution of the remove handler, `removeEvent.notifySuccess()` or `removeEvent.notifyFailure()` notifies Teams of the content removal outcome.</span></span>

>[!NOTE]
> * <span data-ttu-id="4d9f8-166">Um sicherzustellen, dass die Kontrolle eines autorisierten Benutzers über eine Registerkarte nicht gehemmt wird, entfernt Teams die Registerkarte sowohl in Erfolgs- als auch in Fehlerfällen.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-166">To ensure that an authorized user's control over a tab is not inhibited, Teams will remove the tab in both success and failure cases.\</span></span>
> * <span data-ttu-id="4d9f8-167">Teams aktiviert die **Schaltfläche Entfernen** nach 5 Sekunden, auch wenn Ihre Registerkarte nicht aufgerufen `setValidityState()` hat.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-167">Teams enables the **Remove** button after 5 seconds, even if your tab hasn't called `setValidityState()`.\</span></span>
> * <span data-ttu-id="4d9f8-168">Wenn der Benutzer **Teams** entfernen auswählt, wird die Registerkarte nach 30 Sekunden entfernt, unabhängig davon, ob Ihre Aktionen abgeschlossen wurden.</span><span class="sxs-lookup"><span data-stu-id="4d9f8-168">When the user selects **Remove** Teams removes the tab after 30 seconds regardless of whether your actions have completed.</span></span>
