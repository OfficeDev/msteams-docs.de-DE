---
title: Erstellen einer Seite zum Entfernen von Registerkarten
author: surbhigupta
description: So erstellen Sie eine Seite zum Entfernen von Registerkarten
keywords: Teams-Registerkarten Gruppenkanal konfigurierbare Löschung entfernen
localization_priority: Normal
ms.topic: conceptual
ms.author: lajanuar
ms.openlocfilehash: 97f5dfdd8cd9e5e19ec26c345ac960a04a108ab3
ms.sourcegitcommit: 85a52119df6c4cb4536572e6d2e7407f0e5e8a23
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/29/2021
ms.locfileid: "53179713"
---
# <a name="create-a-removal-page"></a><span data-ttu-id="b4ee6-104">Erstellen einer Seite zum Entfernen</span><span class="sxs-lookup"><span data-stu-id="b4ee6-104">Create a removal page</span></span>

<span data-ttu-id="b4ee6-105">Sie können die Benutzererfahrung erweitern und verbessern, indem Sie Entfernungs- und Änderungsoptionen in Ihrer App unterstützen.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-105">You can extend and enhance the user experience by supporting removal and modification options in your app.</span></span> <span data-ttu-id="b4ee6-106">Teams ermöglicht Benutzern das Umbenennen oder Entfernen einer Kanal- oder Gruppenregisterkarte, und Sie können Benutzern erlauben, Ihre Registerkarte nach der Installation neu zu konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-106">Teams enables users to rename or remove a channel or group tab and you can permit users to reconfigure your tab after installation.</span></span> <span data-ttu-id="b4ee6-107">Darüber hinaus bietet die Registerkartenentfernung den Benutzern Optionen zum Löschen oder Archivieren von Inhalten nach dem Entfernen.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-107">Additionally, the tab removal experience provides the users with post-removal options to delete or archive content.</span></span>

## <a name="enable-your-tab-to-be-reconfigured-after-installation"></a><span data-ttu-id="b4ee6-108">Aktivieren der Neukonfiguration Ihrer Registerkarte nach der Installation</span><span class="sxs-lookup"><span data-stu-id="b4ee6-108">Enable your tab to be reconfigured after installation</span></span>

<span data-ttu-id="b4ee6-109">Ihr **manifest.jsdefiniert** die Features und Funktionen Ihrer Registerkarte.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-109">Your **manifest.json** defines your tab's features and capabilities.</span></span> <span data-ttu-id="b4ee6-110">Die `canUpdateConfiguration` Registerkarteninstanzeigenschaft verwendet einen booleschen Wert, der angibt, ob ein Benutzer die Registerkarte ändern oder neu konfigurieren kann, nachdem sie erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-110">The tab instance `canUpdateConfiguration` property takes a Boolean value that indicates whether a user can modify or reconfigure the tab after it is created.</span></span> <span data-ttu-id="b4ee6-111">Die folgende Tabelle enthält die Eigenschaftendetails:</span><span class="sxs-lookup"><span data-stu-id="b4ee6-111">The following table provides the property details:</span></span>

|<span data-ttu-id="b4ee6-112">Name</span><span class="sxs-lookup"><span data-stu-id="b4ee6-112">Name</span></span>| <span data-ttu-id="b4ee6-113">Typ</span><span class="sxs-lookup"><span data-stu-id="b4ee6-113">Type</span></span>| <span data-ttu-id="b4ee6-114">Maximale Größe</span><span class="sxs-lookup"><span data-stu-id="b4ee6-114">Maximum size</span></span> | <span data-ttu-id="b4ee6-115">Erforderlich</span><span class="sxs-lookup"><span data-stu-id="b4ee6-115">Required</span></span> | <span data-ttu-id="b4ee6-116">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="b4ee6-116">Description</span></span>|
|---|---|---|---|---|
|`canUpdateConfiguration`|<span data-ttu-id="b4ee6-117">Boolescher Wert</span><span class="sxs-lookup"><span data-stu-id="b4ee6-117">Boolean</span></span>|||<span data-ttu-id="b4ee6-118">Ein Wert, der angibt, ob eine Instanz der Konfiguration der Registerkarte vom Benutzer nach der Erstellung aktualisiert werden kann.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-118">A value indicating whether an instance of the tab's configuration can be updated by the user after creation.</span></span> <span data-ttu-id="b4ee6-119">Der Standardwert ist `true`.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-119">Default is `true`.</span></span> |

<span data-ttu-id="b4ee6-120">Wenn Ihre Registerkarte in einen Kanal- oder Gruppenchat hochgeladen wird, fügt Teams ein Dropdownmenü mit der rechten Maustaste für Ihre Registerkarte hinzu. Die verfügbaren Optionen werden durch die `canUpdateConfiguration` Einstellung bestimmt.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-120">When your tab is uploaded to a channel or group chat, Teams adds a right-click drop-down menu for your tab. The available options are determined by the `canUpdateConfiguration` setting.</span></span> <span data-ttu-id="b4ee6-121">Die folgende Tabelle enthält die Einstellungsdetails:</span><span class="sxs-lookup"><span data-stu-id="b4ee6-121">The following table provides the setting details:</span></span>

| `canUpdateConfiguration`| <span data-ttu-id="b4ee6-122">true</span><span class="sxs-lookup"><span data-stu-id="b4ee6-122">true</span></span>   | <span data-ttu-id="b4ee6-123">false</span><span class="sxs-lookup"><span data-stu-id="b4ee6-123">false</span></span> | <span data-ttu-id="b4ee6-124">description</span><span class="sxs-lookup"><span data-stu-id="b4ee6-124">description</span></span> |
| ----------------------- | :----: | ----- | ----------- |
|     <span data-ttu-id="b4ee6-125">Einstellungen</span><span class="sxs-lookup"><span data-stu-id="b4ee6-125">Settings</span></span>            |   <span data-ttu-id="b4ee6-126">√</span><span class="sxs-lookup"><span data-stu-id="b4ee6-126">√</span></span>    |       |<span data-ttu-id="b4ee6-127">Die `configurationUrl` Seite wird in einem IFrame neu geladen, sodass der Benutzer die Registerkarte neu konfigurieren kann.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-127">The `configurationUrl` page is reloaded in an IFrame allowing the user to reconfigure the tab.</span></span> |
|     <span data-ttu-id="b4ee6-128">Umbenennen</span><span class="sxs-lookup"><span data-stu-id="b4ee6-128">Rename</span></span>              |   <span data-ttu-id="b4ee6-129">√</span><span class="sxs-lookup"><span data-stu-id="b4ee6-129">√</span></span>    |   <span data-ttu-id="b4ee6-130">√</span><span class="sxs-lookup"><span data-stu-id="b4ee6-130">√</span></span>   | <span data-ttu-id="b4ee6-131">Der Benutzer kann den Namen der Registerkarte so ändern, wie er in der Registerkartenleiste angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-131">The user can change the tab name as it appears in the tab bar.</span></span>          |
|     <span data-ttu-id="b4ee6-132">Entfernen</span><span class="sxs-lookup"><span data-stu-id="b4ee6-132">Remove</span></span>              |   <span data-ttu-id="b4ee6-133">√</span><span class="sxs-lookup"><span data-stu-id="b4ee6-133">√</span></span>    |   <span data-ttu-id="b4ee6-134">√</span><span class="sxs-lookup"><span data-stu-id="b4ee6-134">√</span></span>   |  <span data-ttu-id="b4ee6-135">Wenn die  `removeURL` Eigenschaft und der Wert in der **Konfigurationsseite** enthalten sind, wird die Seite zum **Entfernen** in einen IFrame geladen und dem Benutzer angezeigt.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-135">If the  `removeURL` property and value are included in the **configuration page**, the **removal page** is loaded into an IFrame and presented to the user.</span></span> <span data-ttu-id="b4ee6-136">Wenn keine Seite zum Entfernen enthalten ist, wird dem Benutzer ein Bestätigungsdialogfeld angezeigt.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-136">If a removal page is not included, the user is presented with a confirm dialog box.</span></span>          |

## <a name="create-a-tab-removal-page-for-your-application"></a><span data-ttu-id="b4ee6-137">Erstellen einer Seite zum Entfernen von Registerkarten für Ihre Anwendung</span><span class="sxs-lookup"><span data-stu-id="b4ee6-137">Create a tab removal page for your application</span></span>

<span data-ttu-id="b4ee6-138">Die optionale Seite zum Entfernen ist eine HTML-Seite, die Sie hosten, und wird angezeigt, wenn die Registerkarte entfernt wird.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-138">The optional removal page is an HTML page that you host and is displayed when the tab is removed.</span></span> <span data-ttu-id="b4ee6-139">Die URL der Entfernungsseite wird von der `setSettings()` Methode innerhalb der Konfigurationsseite festgelegt.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-139">The removal page URL is designated by the `setSettings()` method within your configuration page.</span></span> <span data-ttu-id="b4ee6-140">Wie bei allen Seiten in Ihrer App muss die Entfernungsseite [Teams Registerkartenvoraussetzungen](../../../tabs/how-to/tab-requirements.md)entsprechen.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-140">As with all pages in your app, the removal page must comply with [Teams tab prerequisites](../../../tabs/how-to/tab-requirements.md).</span></span>

### <a name="register-a-remove-handler"></a><span data-ttu-id="b4ee6-141">Registrieren eines Remove-Handlers</span><span class="sxs-lookup"><span data-stu-id="b4ee6-141">Register a remove handler</span></span>

<span data-ttu-id="b4ee6-142">Optional können Sie innerhalb der Logik für die Entfernungsseite den Ereignishandler aufrufen, `registerOnRemoveHandler((RemoveEvent) => {}` wenn der Benutzer eine vorhandene Registerkartenkonfiguration entfernt.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-142">Optionally, within your removal page logic, you can  invoke the `registerOnRemoveHandler((RemoveEvent) => {}` event handler when the user removes an existing tab configuration.</span></span> <span data-ttu-id="b4ee6-143">Die Methode übernimmt die [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest&preserve-view=true) Schnittstelle und führt den Code im Handler aus, wenn ein Benutzer versucht, Inhalte zu entfernen.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-143">The method takes in the [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest&preserve-view=true) interface and executes the code in the handler when a user attempts to remove content.</span></span> <span data-ttu-id="b4ee6-144">Die Methode wird verwendet, um Bereinigungsvorgänge auszuführen, z. B. das Entfernen der zugrunde liegenden Ressource, die den Registerkarteninhalt ansteuert.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-144">The method is used to perform cleanup operations such as removing the underlying resource powering the tab content.</span></span> <span data-ttu-id="b4ee6-145">Gleichzeitig kann nur ein Remove-Handler registriert werden.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-145">At a time only one remove handler can be registered.</span></span>

<span data-ttu-id="b4ee6-146">Die `RemoveEvent` Schnittstelle beschreibt ein Objekt mit zwei Methoden:</span><span class="sxs-lookup"><span data-stu-id="b4ee6-146">The `RemoveEvent` interface describes an object with two methods:</span></span>

* <span data-ttu-id="b4ee6-147">Die `notifySuccess()` Funktion ist erforderlich.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-147">The `notifySuccess()` function is required.</span></span> <span data-ttu-id="b4ee6-148">Es gibt an, dass das Entfernen der zugrunde liegenden Ressource erfolgreich war und der Inhalt entfernt werden kann.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-148">It indicates that the removal of the underlying resource succeeded and its content can be removed.</span></span>

* <span data-ttu-id="b4ee6-149">Die `notifyFailure(string)` Funktion ist optional.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-149">The `notifyFailure(string)` function is optional.</span></span> <span data-ttu-id="b4ee6-150">Es gibt an, dass das Entfernen der zugrunde liegenden Ressource fehlgeschlagen ist und der Inhalt nicht entfernt werden kann.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-150">It indicates that removal of the underlying resource failed and its content cannot be removed.</span></span> <span data-ttu-id="b4ee6-151">Der optionale Zeichenfolgenparameter gibt einen Grund für den Fehler an.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-151">The optional string parameter specifies a reason for the failure.</span></span> <span data-ttu-id="b4ee6-152">Wenn angegeben, wird diese Zeichenfolge dem Benutzer angezeigt. andernfalls wird ein allgemeiner Fehler angezeigt.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-152">If provided, this string is displayed to the user; else a generic error is displayed.</span></span>

#### <a name="use-the-getsettings-function"></a><span data-ttu-id="b4ee6-153">Verwenden der `getSettings()` Funktion</span><span class="sxs-lookup"><span data-stu-id="b4ee6-153">Use the `getSettings()` function</span></span>

<span data-ttu-id="b4ee6-154">Sie können `getSettings()` den zu entfernenden Registerkarteninhalt zuweisen.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-154">You can use `getSettings()`to assign the tab content to be removed.</span></span> <span data-ttu-id="b4ee6-155">Die `getSettings((Settings) =>{})` Funktion übernimmt die gültigen Werte der Einstellungseigenschaft und stellt sie [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest&preserve-view=true) bereit, die abgerufen werden können.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-155">The `getSettings((Settings) =>{})` function takes in the [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest&preserve-view=true) and provides the valid settings property values that can be retrieved.</span></span>

#### <a name="use-the-getcontext-function"></a><span data-ttu-id="b4ee6-156">Verwenden der `getContext()` Funktion</span><span class="sxs-lookup"><span data-stu-id="b4ee6-156">Use the `getContext()` function</span></span>

<span data-ttu-id="b4ee6-157">Sie können den `getContext()` aktuellen Kontext abrufen, in dem der Frame ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-157">You can use `getContext()` to get the current context in which the frame is running.</span></span> <span data-ttu-id="b4ee6-158">Die `getContext((Context) =>{})` Funktion übernimmt die [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest&preserve-view=true) .</span><span class="sxs-lookup"><span data-stu-id="b4ee6-158">The `getContext((Context) =>{})` function takes in the [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest&preserve-view=true).</span></span> <span data-ttu-id="b4ee6-159">Die Funktion stellt gültige `Context` Eigenschaftswerte bereit, die Sie in der Logik für die Entfernungsseite verwenden können, um den Inhalt zu bestimmen, der auf der Entfernungsseite angezeigt werden soll.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-159">The function provides valid `Context` property values that you can use in your removal page logic to determine the content to display in the removal page.</span></span>

#### <a name="include-authentication"></a><span data-ttu-id="b4ee6-160">Einschließen der Authentifizierung</span><span class="sxs-lookup"><span data-stu-id="b4ee6-160">Include authentication</span></span>

<span data-ttu-id="b4ee6-161">Eine Authentifizierung ist erforderlich, bevor ein Benutzer den Registerkarteninhalt löschen kann.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-161">Authentication is required before allowing a user to delete the tab content.</span></span> <span data-ttu-id="b4ee6-162">Kontextinformationen können verwendet werden, um Authentifizierungsanforderungen und Autorisierungsseiten-URLs zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-162">Context information can be used to help construct authentication requests and authorization page URLs.</span></span> <span data-ttu-id="b4ee6-163">Registerkarten finden Sie [unter Microsoft Teams Authentifizierungsfluss.](~/tabs/how-to/authentication/auth-flow-tab.md)</span><span class="sxs-lookup"><span data-stu-id="b4ee6-163">See [Microsoft Teams authentication flow for tabs](~/tabs/how-to/authentication/auth-flow-tab.md).</span></span> <span data-ttu-id="b4ee6-164">Stellen Sie sicher, dass alle Domänen, die auf Ihren Registerkartenseiten verwendet werden, im Array aufgeführt `manifest.json` `validDomains` sind.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-164">Make sure that all domains used in your tab pages are listed in the `manifest.json` `validDomains` array.</span></span>

<span data-ttu-id="b4ee6-165">Es folgt ein Beispielcodeblock zum Entfernen von Registerkarten:</span><span class="sxs-lookup"><span data-stu-id="b4ee6-165">The following is a sample tab removal code block:</span></span>

```html
<body>
  <button onclick="onClick()">Delete this tab and all underlying data?</button>
  <script>
    microsoftTeams.initialize();
    microsoftTeams.settings.registerOnRemoveHandler((removeEvent) => {
      // Here you can designate the tab content to be removed and/or archived.
        microsoftTeams.settings.getSettings((settings) => {
        settings.contentUrl = "..."
        });
        removeEvent.notifySuccess();
    });

    const onClick() => {
        microsoftTeams.settings.setValidityState(true);
    }
  </script>
</body>

```

<span data-ttu-id="b4ee6-166">Wenn ein Benutzer im Dropdownmenü der Registerkarte **"Entfernen"** auswählt, lädt Teams die optionale Seite, die `removeUrl` auf der **Konfigurationsseite** zugewiesen ist, in einen IFrame.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-166">When a user selects **Remove** from the tab's drop-down menu, Teams loads the optional `removeUrl` page assigned in your **configuration page**, into an IFrame.</span></span> <span data-ttu-id="b4ee6-167">Dem Benutzer wird eine Schaltfläche angezeigt, die mit der Funktion geladen `onClick()` ist, `microsoftTeams.settings.setValidityState(true)` die die Schaltfläche **"Entfernen"** am unteren Rand der IFrame-Entfernungsseite aufruft und aktiviert.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-167">The user is shown a button loaded with the `onClick()` function that calls `microsoftTeams.settings.setValidityState(true)` and enables the **Remove** button shown at the bottom of the removal page IFrame.</span></span>

<span data-ttu-id="b4ee6-168">Nachdem der Remove-Handler ausgeführt `removeEvent.notifySuccess()` wurde, oder `removeEvent.notifyFailure()` benachrichtigt Teams über das Ergebnis der Inhaltsentfernung.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-168">After the remove handler is executed, `removeEvent.notifySuccess()` or `removeEvent.notifyFailure()` notifies Teams of the content removal outcome.</span></span>

>[!NOTE]
> * <span data-ttu-id="b4ee6-169">Um sicherzustellen, dass die Kontrolle eines autorisierten Benutzers über eine Registerkarte nicht gehemmt wird, entfernt Teams die Registerkarte in Erfolgs- und Fehlerfällen.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-169">To ensure that an authorized user's control over a tab is not inhibited, Teams removes the tab in both success and failure cases.</span></span>
> * <span data-ttu-id="b4ee6-170">Teams aktiviert die Schaltfläche **"Entfernen"** nach fünf Sekunden, auch wenn die Registerkarte nicht aufgerufen `setValidityState()` wurde.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-170">Teams enables the **Remove** button after five seconds, even if your tab has not called `setValidityState()`.</span></span>
> * <span data-ttu-id="b4ee6-171">Wenn der Benutzer **"Entfernen"** auswählt, entfernt Teams die Registerkarte nach 30 Sekunden, unabhängig davon, ob die Aktionen abgeschlossen wurden oder nicht.</span><span class="sxs-lookup"><span data-stu-id="b4ee6-171">When the user selects **Remove**, Teams removes the tab after 30 seconds regardless of whether the actions have been completed or not.</span></span>

## <a name="see-also"></a><span data-ttu-id="b4ee6-172">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="b4ee6-172">See also</span></span>

* [<span data-ttu-id="b4ee6-173">registerkarten Teams</span><span class="sxs-lookup"><span data-stu-id="b4ee6-173">Teams tabs</span></span>](~/tabs/what-are-tabs.md)
* [<span data-ttu-id="b4ee6-174">Erstellen einer persönlichen Registerkarte</span><span class="sxs-lookup"><span data-stu-id="b4ee6-174">Create a personal tab</span></span>](~/tabs/how-to/create-personal-tab.md)
* [<span data-ttu-id="b4ee6-175">Erstellen einer Kanal- oder Gruppenregisterkarte</span><span class="sxs-lookup"><span data-stu-id="b4ee6-175">Create a channel or group tab</span></span>](~/tabs/how-to/create-channel-group-tab.md)
* [<span data-ttu-id="b4ee6-176">Erstellen einer Konfigurationsseite</span><span class="sxs-lookup"><span data-stu-id="b4ee6-176">Create a configuration page</span></span>](~/tabs/how-to/create-tab-pages/configuration-page.md)

## <a name="next-step"></a><span data-ttu-id="b4ee6-177">Nächster Schritt</span><span class="sxs-lookup"><span data-stu-id="b4ee6-177">Next step</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="b4ee6-178">Registerkarten auf mobilen Geräten</span><span class="sxs-lookup"><span data-stu-id="b4ee6-178">Tabs on mobile</span></span>](~/tabs/design/tabs-mobile.md)