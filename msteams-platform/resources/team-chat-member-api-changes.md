---
title: Bot-API-Änderungen für Team- und Chatmitglieder
author: ojasvichoudhary
description: Beschreibt bevorstehende und in Bearbeitung ausgeführte Änderungen an den Bot-APIs, die zum Abrufen von Mitgliedern von Teams und Chats verwendet werden.
keywords: Bot-Framework-Apis-Teammitgliederliste
ms.topic: reference
ms.author: ojchoudh
ms.openlocfilehash: d55cbcdfea5e374c151c3eec82c52ac7f434c153
ms.sourcegitcommit: 49d1ecda14042bf3f368b14c1971618fe979b914
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/23/2021
ms.locfileid: "51034691"
---
# <a name="changes-to-teams-bot-apis-for-fetching-team-and-chat-members"></a><span data-ttu-id="bf98f-104">Änderungen an Teams-Bot-APIs zum Abrufen von Team- und Chatmitgliedern</span><span class="sxs-lookup"><span data-stu-id="bf98f-104">Changes to Teams bot APIs for fetching team and chat members</span></span>

>[!NOTE]
> <span data-ttu-id="bf98f-105">Wir haben mit dem Veraltetkeitsprozess für und `TeamsInfo.getMembers` `TeamsInfo.GetMembersAsync` APIs begonnen.</span><span class="sxs-lookup"><span data-stu-id="bf98f-105">We've started with the deprecation process for `TeamsInfo.getMembers` and `TeamsInfo.GetMembersAsync` APIs.</span></span> <span data-ttu-id="bf98f-106">Anfangs werden sie auf 5 Anforderungen pro Minute stark gedrosselt und geben maximal 10.000 Mitglieder pro Team zurück.</span><span class="sxs-lookup"><span data-stu-id="bf98f-106">Initially, they will be heavily throttled to 5 requests per minute and return a maximum of 10K members per team.</span></span> <span data-ttu-id="bf98f-107">Dies führt dazu, dass der vollständige Dienstplan nicht zurückgegeben wird, wenn die Teamgröße zunimmt.</span><span class="sxs-lookup"><span data-stu-id="bf98f-107">This will result in the full roster not being returned as team size increases.</span></span> 
> 
> <span data-ttu-id="bf98f-108">**Sie müssen auf Version 4.10** oder höher des Bot Framework SDK aktualisieren und zu den paginierten API-Endpunkten oder der API mit einem `TeamsInfo.GetMemberAsync` einzelnen Benutzer wechseln.</span><span class="sxs-lookup"><span data-stu-id="bf98f-108">**You must update to version 4.10 or higher of the Bot Framework SDK** and switch to the paginated API endpoints, or the `TeamsInfo.GetMemberAsync` single user API.</span></span> <span data-ttu-id="bf98f-109">Dies gilt auch für Ihren Bot, auch wenn Sie diese APIs nicht direkt verwenden, da ältere SDKs diese APIs während [membersAdded-Ereignissen](../bots/how-to/conversations/subscribe-to-conversation-events.md#team-members-added) aufrufen.</span><span class="sxs-lookup"><span data-stu-id="bf98f-109">This also applies to your bot even if you're not directly using these APIs, as older SDKs call these APIs during [membersAdded](../bots/how-to/conversations/subscribe-to-conversation-events.md#team-members-added) events.</span></span> <span data-ttu-id="bf98f-110">Informationen zum Anzeigen der Liste anstehender Änderungen finden Sie unter [API-Änderungen](team-chat-member-api-changes.md#api-changes).</span><span class="sxs-lookup"><span data-stu-id="bf98f-110">To view the list of upcoming changes, see [API changes](team-chat-member-api-changes.md#api-changes).</span></span> 

<span data-ttu-id="bf98f-111">Derzeit verwenden Botentwickler, die Informationen für ein oder mehrere Mitglieder eines Chats oder Teams abrufen möchten, die Microsoft Teams-Bot-APIs `TeamsInfo.GetMembersAsync` (für C#) oder `TeamsInfo.getMembers` (für TypeScript/Node.js)-APIs [(hier dokumentiert).](../bots/how-to/get-teams-context.md#fetching-the-roster-or-user-profile)</span><span class="sxs-lookup"><span data-stu-id="bf98f-111">Currently, bot developers who want to retrieve information for one or more members of a chat or team use the Microsoft Teams bot APIs `TeamsInfo.GetMembersAsync` (for C#) or `TeamsInfo.getMembers` (for TypeScript/Node.js) APIs [(documented here)](../bots/how-to/get-teams-context.md#fetching-the-roster-or-user-profile).</span></span> <span data-ttu-id="bf98f-112">Diese APIs haben heute mehrere Nachteile:</span><span class="sxs-lookup"><span data-stu-id="bf98f-112">These APIs have several shortcomings today:</span></span>

* <span data-ttu-id="bf98f-113">**Bei großen Teams ist die Leistung schlecht, und Timeouts sind wahrscheinlicher.**</span><span class="sxs-lookup"><span data-stu-id="bf98f-113">**For large teams, performance is poor and timeouts are more likely.**</span></span> <span data-ttu-id="bf98f-114">Die maximale Teamgröße ist seit der Released von Microsoft Teams Anfang 2017 erheblich angezogen.</span><span class="sxs-lookup"><span data-stu-id="bf98f-114">The maximum team size has grown considerably since Microsoft Teams was released in early 2017.</span></span> <span data-ttu-id="bf98f-115">Da die gesamte Mitgliederliste zurückgegeben wird, dauert es lange, bis der API-Aufruf für große Teams zurückgegeben wird, und es ist nicht ungewöhnlich, dass für den Aufruf ein Zeit-Out durchgeführt wird, und Sie müssen es erneut `GetMembersAsync` / `getMembers` versuchen.</span><span class="sxs-lookup"><span data-stu-id="bf98f-115">Since `GetMembersAsync`/`getMembers` returns the entire member list, it takes a long time for the API call to return for large teams, and it’s not uncommon for the call to time out and you have to try again.</span></span>
* <span data-ttu-id="bf98f-116">**Das Abrufen von Profildetails für einen einzelnen Benutzer ist umständlich.**</span><span class="sxs-lookup"><span data-stu-id="bf98f-116">**Getting profile details for a single user is cumbersome.**</span></span> <span data-ttu-id="bf98f-117">Um die Profilinformationen für einen einzelnen Benutzer abzurufen, müssen Sie die gesamte Mitgliederliste abrufen und dann nach der gesuchten suchen.</span><span class="sxs-lookup"><span data-stu-id="bf98f-117">To get the profile information for a single user, you have to retrieve the entire member list and then search for the one you want.</span></span> <span data-ttu-id="bf98f-118">True, es gibt eine Hilfsfunktion im Bot Framework SDK, um es einfacher zu machen, aber unter den Abdeckungen ist es nicht effizient.</span><span class="sxs-lookup"><span data-stu-id="bf98f-118">True, there’s a helper function in the Bot Framework SDK to make it simpler, but under the covers it’s not efficient.</span></span>

<span data-ttu-id="bf98f-119">Mit der Einführung organisationsweiter Teams wurde uns klar, dass es an der Zeit war, diese APIs besser an Office 365-Datenschutzsteuerelementen auszurichten: Bots, die in großen Teams verwendet werden, können grundlegende Profilinformationen abrufen, die der `User.ReadBasic.All` Microsoft Graph-Berechtigung ähneln.</span><span class="sxs-lookup"><span data-stu-id="bf98f-119">Separately, with the introduction of org-wide teams, we realized it was time to better align these APIs with Office 365 privacy controls: bots used in large teams are able to retrieve basic profile information, which is similar to the `User.ReadBasic.All` Microsoft Graph permission.</span></span> <span data-ttu-id="bf98f-120">Mandantenadministratoren haben eine große Kontrolle darüber, welche Apps und Bots in ihrem Mandanten verwendet werden können, aber diese Einstellungen unterscheiden sich von denen für Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="bf98f-120">Tenant administrators have a great deal of control over which apps and bots can be used in their tenant, but these settings are different than the ones governing Microsoft Graph.</span></span>

<span data-ttu-id="bf98f-121">Hier sehen Sie eine Beispiel-JSON-Darstellung der heute von diesen APIs zurückgegebenen.</span><span class="sxs-lookup"><span data-stu-id="bf98f-121">Here’s a sample JSON representation of what’s returned by these APIs today.</span></span> <span data-ttu-id="bf98f-122">Ich verweise auf einige der folgenden Felder.</span><span class="sxs-lookup"><span data-stu-id="bf98f-122">I’ll refer to some of the fields below.</span></span>

```json
[{
    "id": "29:1GcS4EyB_oSI8A88XmWBN7NJFyMqe3QGnJdgLfFGkJnVelzRGos0bPbpsfJjcbAD22bmKc4GMbrY2g4JDrrA8vM06X1-cHHle4zOE6U4ttcc",
    "name": "Anon1 (Guest)",
    "tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47",
    "userRole": "anonymous"
}, {
    "id": "29:1bSnHZ7Js2STWrgk6ScEErLk1Lp2zQuD5H2qQ960rtvstKp8tKLl-3r8b6DoW0QxZimuTxk_kupZ1DBMpvIQQUAZL-PNj0EORDvRZXy8kvWk",
    "objectId": "76b0b09f-d410-48fd-993e-84da521a597b",
    "givenName": "John",
    "surname": "Patterson",
    "email": "johnp@fabrikam.com",
    "userPrincipalName": "johnp@fabrikam.com",
    "tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47",
    "userRole": "user"
}, {
    "id": "29:1URzNQM1x1PNMr1D7L5_lFe6qF6gEfAbkdG8_BUxOW2mTKryQqEZtBTqDt10-MghkzjYDuUj4KG6nvg5lFAyjOLiGJ4jzhb99WrnI7XKriCs",
    "objectId": "6b7b3b2a-2c4b-4175-8582-41c9e685c1b5",
    "givenName": "Rick",
    "surname": "Stevens",
    "email": "Rick.Stevens@fabrikam.com",
    "userPrincipalName": "rstevens@fabrikam.com",
    "tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47",
    "userRole": "user"
}]
```

## <a name="api-changes"></a><span data-ttu-id="bf98f-123">API-Änderungen</span><span class="sxs-lookup"><span data-stu-id="bf98f-123">API Changes</span></span>
<span data-ttu-id="bf98f-124">Hier sind die anstehenden API-Änderungen:</span><span class="sxs-lookup"><span data-stu-id="bf98f-124">Here are the upcoming API changes:</span></span>

* <span data-ttu-id="bf98f-125">Wir haben eine neue API zum [`TeamsInfo.GetPagedMembersAsync`](../bots/how-to/get-teams-context.md#fetching-the-roster-or-user-profile) Abrufen von Profilinformationen für Mitglieder eines Chats/Teams erstellt.</span><span class="sxs-lookup"><span data-stu-id="bf98f-125">We've created a new API [`TeamsInfo.GetPagedMembersAsync`](../bots/how-to/get-teams-context.md#fetching-the-roster-or-user-profile) for retrieving profile information for members of a chat/team.</span></span> <span data-ttu-id="bf98f-126">Diese API ist jetzt mit dem Bot Framework 4.10 SDK verfügbar.</span><span class="sxs-lookup"><span data-stu-id="bf98f-126">This API is now available with the Bot Framework 4.10 SDK.</span></span> <span data-ttu-id="bf98f-127">Für die Entwicklung in allen anderen Versionen verwenden Sie die [`GetConversationPagedMembers`](/dotnet/api/microsoft.bot.connector.conversationsextensions.getconversationpagedmembersasync?view=botbuilder-dotnet-stable&preserve-view=true) Methode.</span><span class="sxs-lookup"><span data-stu-id="bf98f-127">For development in all other versions use the [`GetConversationPagedMembers`](/dotnet/api/microsoft.bot.connector.conversationsextensions.getconversationpagedmembersasync?view=botbuilder-dotnet-stable&preserve-view=true) method.</span></span> 
  > [!NOTE]
  > <span data-ttu-id="bf98f-128">In v3 oder v4 besteht die beste Aktion im Upgrade auf die neueste Punktversion.</span><span class="sxs-lookup"><span data-stu-id="bf98f-128">In either v3 or v4, the best action is to upgrade to the latest point release.</span></span> 
* <span data-ttu-id="bf98f-129">Wir haben eine neue API zum Abrufen der [`TeamsInfo.GetMemberAsync`](../bots/how-to/get-teams-context.md#get-single-member-details) Profilinformationen für einen einzelnen Benutzer erstellt.</span><span class="sxs-lookup"><span data-stu-id="bf98f-129">We've created a new API [`TeamsInfo.GetMemberAsync`](../bots/how-to/get-teams-context.md#get-single-member-details) for retrieving the profile information for a single user.</span></span> <span data-ttu-id="bf98f-130">Es verwendet die ID des Teams/Chats und einen [UPN](https://docs.microsoft.com/windows/win32/ad/naming-properties#userprincipalname) ( , siehe `userPrincipalName` *oben*), Azure Active Directory-Objekt-ID ( , siehe oben ) oder die `objectId` Teams-Benutzer-ID ( , siehe oben ) als Parameter und gibt die Profilinformationen für diesen Benutzer `id` zurück. </span><span class="sxs-lookup"><span data-stu-id="bf98f-130">It takes the ID of the team/chat and a [UPN](https://docs.microsoft.com/windows/win32/ad/naming-properties#userprincipalname) (`userPrincipalName`, *see above*), Azure Active Directory Object ID (`objectId`, *see above*), or the Teams user ID (`id`, *see above*) as parameters and returns the profile information for that user.</span></span> 
  > [!NOTE]
  > <span data-ttu-id="bf98f-131">Wir ändern uns so, dass sie dem entsprechen, was im Objekt einer `objectId` `aadObjectId` Bot `Activity` Framework-Nachricht aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="bf98f-131">We're changing `objectId` to `aadObjectId` to match what it's called in the `Activity` object of a Bot Framework message.</span></span> <span data-ttu-id="bf98f-132">Die neue API ist mit Version 4.10 des Bot Framework SDK verfügbar.</span><span class="sxs-lookup"><span data-stu-id="bf98f-132">The new API is available with version 4.10 of the Bot Framework SDK.</span></span> <span data-ttu-id="bf98f-133">Es wird bald auch in der Teams SDK-Erweiterung Bot Framework 3.x verfügbar sein. Mittlerweile können Sie den [REST-Endpunkt](../bots/how-to/get-teams-context.md?get-single-member-details) verwenden.</span><span class="sxs-lookup"><span data-stu-id="bf98f-133">It will soon be available in the Teams SDK extension Bot Framework 3.x as well; meanwhile you can use the [REST](../bots/how-to/get-teams-context.md?get-single-member-details) endpoint.</span></span>
* <span data-ttu-id="bf98f-134">`TeamsInfo.GetMembersAsync` (C#) und (TypeScript/Node.js) sind formal veraltet und funktionieren Ende `TeamsInfo.getMembers` 2021 nicht mehr.</span><span class="sxs-lookup"><span data-stu-id="bf98f-134">`TeamsInfo.GetMembersAsync` (C#) and `TeamsInfo.getMembers` (TypeScript/Node.js) is formally deprecated and will stop working in late 2021.</span></span> <span data-ttu-id="bf98f-135">Aktualisieren Sie Ihre Bots so, dass sie die seitenseitigen APIs verwenden.</span><span class="sxs-lookup"><span data-stu-id="bf98f-135">Please update your bots to use the paged APIs.</span></span> <span data-ttu-id="bf98f-136">(Dies gilt auch für die [zugrunde liegende REST-API, die diese APIs verwenden.)](../bots/how-to/get-teams-context.md)</span><span class="sxs-lookup"><span data-stu-id="bf98f-136">(This also applies to the [underlying REST API these APIs use](../bots/how-to/get-teams-context.md).)</span></span>
* <span data-ttu-id="bf98f-137">Bis Ende 2021 können Bots die Eigenschaften oder für Mitglieder eines Chats/Teams nicht proaktiv abrufen und müssen Microsoft Graph zum Abrufen `userPrincipalName` `email` verwenden.</span><span class="sxs-lookup"><span data-stu-id="bf98f-137">By late 2021, bots will not be able to proactively retrieve the `userPrincipalName` or `email` properties for members of a chat/team and will need to use Microsoft Graph to retrieve them.</span></span> <span data-ttu-id="bf98f-138">Insbesondere werden eigenschaften nicht von der neuen API zurückgegeben, die `userPrincipalName` `email` Ende `GetConversationPagedMembers` 2021 beginnt.</span><span class="sxs-lookup"><span data-stu-id="bf98f-138">Specifically, `userPrincipalName` and `email` properties won't be returned from the new `GetConversationPagedMembers` API starting in late 2021.</span></span> <span data-ttu-id="bf98f-139">Bots müssen Microsoft Graph mit einem Zugriffstoken verwenden, um diese Informationen abzurufen.</span><span class="sxs-lookup"><span data-stu-id="bf98f-139">Bots will have to use Microsoft Graph with an access token to retrieve this information.</span></span> <span data-ttu-id="bf98f-140">Dies ist natürlich eine wesentliche Änderung: Wir müssen es Bots erleichtern, ein Zugriffstoken zu erhalten, und wir müssen den Zustimmungsprozess für Endbenutzer optimieren und vereinfachen.</span><span class="sxs-lookup"><span data-stu-id="bf98f-140">This is obviously a major change: We must make it easier for bots to get an access token, and we must streamline and simplify the end-user consent process.</span></span>

## <a name="feedback-and-more-information"></a><span data-ttu-id="bf98f-141">Feedback und weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="bf98f-141">Feedback and More Information</span></span>
<span data-ttu-id="bf98f-142">Wir verwenden diese Seite, um aktuelle Informationen zu diesen Änderungen zur Verfügung zu haben.</span><span class="sxs-lookup"><span data-stu-id="bf98f-142">We'll use this page for providing up to date information on these changes.</span></span> <span data-ttu-id="bf98f-143">Wenn Sie Fragen haben, verwenden Sie den Abschnitt "Feedback senden > auf dieser Seite" im **Abschnitt Feedback** unten.</span><span class="sxs-lookup"><span data-stu-id="bf98f-143">If you have questions, use the "Send feedback > on this page" in the **Feedback** section below.</span></span> 
