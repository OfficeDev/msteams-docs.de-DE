---
title: Erstellen einer Seite zum Entfernen von Registerkarten
author: laujan
description: So erstellen Sie eine Seite zum Entfernen von Registerkarten
keywords: Teams-Registerkarten-Gruppenkanal konfigurierbare Löschung entfernen
ms.topic: conceptual
ms.author: lajanuar
ms.openlocfilehash: 49e2df47095999e9f9eea76ea341a44215bfacb3
ms.sourcegitcommit: 4539479289b43812eaae07a1c0f878bed815d2d2
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/12/2021
ms.locfileid: "49797883"
---
# <a name="modify-or-remove-a-channel-group-tab"></a><span data-ttu-id="72d23-104">Ändern oder Entfernen einer Kanalgruppenregisterkarte</span><span class="sxs-lookup"><span data-stu-id="72d23-104">Modify or remove a channel group tab</span></span>

<span data-ttu-id="72d23-105">Sie können die Benutzererfahrung erweitern und verbessern, indem Sie Entfernungs- und Änderungsoptionen in Ihrer App unterstützen.</span><span class="sxs-lookup"><span data-stu-id="72d23-105">You can extend and enhance the user experience by supporting removal and modification options in your app.</span></span> <span data-ttu-id="72d23-106">Teams ermöglicht Benutzern das Umbenennen oder Entfernen einer Kanal-/Gruppenregisterkarte, und Sie können Benutzern erlauben, ihre Registerkarte nach der Installation neu zu konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="72d23-106">Teams enables users to rename or remove a channel/group tab and you can permit users to reconfigure your tab after installation.</span></span> <span data-ttu-id="72d23-107">Darüber hinaus können Sie beim Entfernen von Registerkarten festlegen, was mit dem Inhalt geschieht, wenn die Registerkarte entfernt wird, oder benutzern Optionen nach dem Entfernen zur Verfügung stellen, z. B. löschen oder archivieren.</span><span class="sxs-lookup"><span data-stu-id="72d23-107">Additionally, your tab removal experience can include designating what happens to the content when your tab is removed or giving users post-removal options such as deleting or archiving the content.</span></span>

## <a name="enable-your-tab-to-be-reconfigured-after-installation"></a><span data-ttu-id="72d23-108">Aktivieren der Neukonfiguration der Registerkarte nach der Installation</span><span class="sxs-lookup"><span data-stu-id="72d23-108">Enable your tab to be reconfigured after installation</span></span>

<span data-ttu-id="72d23-109">Ihr **manifest.jsdefiniert** die Features und Funktionen Ihrer Registerkarte.</span><span class="sxs-lookup"><span data-stu-id="72d23-109">Your **manifest.json** defines your tab's features and capabilities.</span></span> <span data-ttu-id="72d23-110">Die Eigenschaft der Registerkarteninstanz verwendet einen booleschen Wert, der angibt, ob ein Benutzer die Registerkarte ändern oder neu konfigurieren kann, nachdem `canUpdateConfiguration` sie erstellt wurde:</span><span class="sxs-lookup"><span data-stu-id="72d23-110">The tab instance `canUpdateConfiguration` property takes a Boolean value that indicates whether a user can modify or reconfigure the tab after it is created:</span></span>

|<span data-ttu-id="72d23-111">Name</span><span class="sxs-lookup"><span data-stu-id="72d23-111">Name</span></span>| <span data-ttu-id="72d23-112">Typ</span><span class="sxs-lookup"><span data-stu-id="72d23-112">Type</span></span>| <span data-ttu-id="72d23-113">Maximale Größe</span><span class="sxs-lookup"><span data-stu-id="72d23-113">Maximum size</span></span> | <span data-ttu-id="72d23-114">Erforderlich</span><span class="sxs-lookup"><span data-stu-id="72d23-114">Required</span></span> | <span data-ttu-id="72d23-115">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="72d23-115">Description</span></span>|
|---|---|---|---|---|
|`canUpdateConfiguration`|<span data-ttu-id="72d23-116">Boolean</span><span class="sxs-lookup"><span data-stu-id="72d23-116">Boolean</span></span>|||<span data-ttu-id="72d23-117">Ein Wert, der angibt, ob eine Instanz der Konfiguration der Registerkarte vom Benutzer nach der Erstellung aktualisiert werden kann.</span><span class="sxs-lookup"><span data-stu-id="72d23-117">A value indicating whether an instance of the tab's configuration can be updated by the user after creation.</span></span> <span data-ttu-id="72d23-118">Standard: `true`</span><span class="sxs-lookup"><span data-stu-id="72d23-118">Default: `true`</span></span>|

<span data-ttu-id="72d23-119">Wenn Ihre Registerkarte in einen Kanal- oder Gruppenchat hochgeladen wird, fügt Teams ein Dropdownmenü mit der rechten Maustaste für Ihre Registerkarte hinzu. Die verfügbaren Optionen werden durch die Einstellung `canUpdateConfiguration` bestimmt:</span><span class="sxs-lookup"><span data-stu-id="72d23-119">When your tab is uploaded to a channel or group chat, Teams will add a right-click drop-down menu for your tab. The available options are determined by the `canUpdateConfiguration` setting:</span></span>

| `canUpdateConfiguration`| <span data-ttu-id="72d23-120">true</span><span class="sxs-lookup"><span data-stu-id="72d23-120">true</span></span>   | <span data-ttu-id="72d23-121">False</span><span class="sxs-lookup"><span data-stu-id="72d23-121">false</span></span> | <span data-ttu-id="72d23-122">description</span><span class="sxs-lookup"><span data-stu-id="72d23-122">description</span></span> |
| ----------------------- | :----: | ----- | ----------- |
|     <span data-ttu-id="72d23-123">Einstellungen</span><span class="sxs-lookup"><span data-stu-id="72d23-123">Settings</span></span>            |   <span data-ttu-id="72d23-124">√</span><span class="sxs-lookup"><span data-stu-id="72d23-124">√</span></span>    |       |<span data-ttu-id="72d23-125">Die Seite wird in einem IFrame neu geladen, sodass der Benutzer die `configurationUrl` Registerkarte neu konfigurieren kann.</span><span class="sxs-lookup"><span data-stu-id="72d23-125">The `configurationUrl` page is reloaded in an IFrame allowing the user to reconfigure the tab.</span></span>  |
|     <span data-ttu-id="72d23-126">Umbenennen</span><span class="sxs-lookup"><span data-stu-id="72d23-126">Rename</span></span>              |   <span data-ttu-id="72d23-127">√</span><span class="sxs-lookup"><span data-stu-id="72d23-127">√</span></span>    |   <span data-ttu-id="72d23-128">√</span><span class="sxs-lookup"><span data-stu-id="72d23-128">√</span></span>   | <span data-ttu-id="72d23-129">Der Benutzer kann den Namen der Registerkarte ändern, wie er in der Registerkartenleiste angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="72d23-129">The user can change the tab name as it appears in the tab bar.</span></span>          |
|     <span data-ttu-id="72d23-130">Entfernen</span><span class="sxs-lookup"><span data-stu-id="72d23-130">Remove</span></span>              |   <span data-ttu-id="72d23-131">√</span><span class="sxs-lookup"><span data-stu-id="72d23-131">√</span></span>    |   <span data-ttu-id="72d23-132">√</span><span class="sxs-lookup"><span data-stu-id="72d23-132">√</span></span>   |  <span data-ttu-id="72d23-133">Wenn die Eigenschaft und der Wert in der Konfigurationsseite enthalten sind, wird die Seite zum Entfernen in einen IFrame geladen und `removeURL` dem Benutzer angezeigt.  </span><span class="sxs-lookup"><span data-stu-id="72d23-133">If the  `removeURL` property and value are included in the **configuration page**, the **removal page** is loaded into an IFrame and presented to the user.</span></span> <span data-ttu-id="72d23-134">Wenn keine Seite zum Entfernen enthalten ist, wird dem Benutzer ein Bestätigungsdialogfeld angezeigt.</span><span class="sxs-lookup"><span data-stu-id="72d23-134">If a removal page is not included the user is presented with a confirm dialog box.</span></span>          |
|||||

## <a name="create-a-tab-removal-page-for-your-application"></a><span data-ttu-id="72d23-135">Erstellen einer Seite zum Entfernen von Registerkarten für Ihre Anwendung</span><span class="sxs-lookup"><span data-stu-id="72d23-135">Create a tab removal page for your application</span></span>

<span data-ttu-id="72d23-136">Die optionale Seite zum Entfernen ist eine HTML-Seite, die Sie hosten und die angezeigt wird, wenn die Registerkarte entfernt wird.</span><span class="sxs-lookup"><span data-stu-id="72d23-136">The optional removal page is an HTML page that you host and is displayed when the tab is removed.</span></span> <span data-ttu-id="72d23-137">Die URL der Entfernungsseite wird durch die `setSettings()` Methode auf der Konfigurationsseite festgelegt.</span><span class="sxs-lookup"><span data-stu-id="72d23-137">The removal page URL is designated by the `setSettings()` method within your configuration page.</span></span> <span data-ttu-id="72d23-138">Wie bei allen Seiten in Ihrer App muss die Seite zum Entfernen den [Registerkartenanforderungen](../../../tabs/how-to/tab-requirements.md)für Teams entsprechen.</span><span class="sxs-lookup"><span data-stu-id="72d23-138">As with all pages in your app, the removal page must comply with [Teams tab requirements](../../../tabs/how-to/tab-requirements.md).</span></span>

### <a name="register-a-remove-handler"></a><span data-ttu-id="72d23-139">Registrieren eines Removehandlers</span><span class="sxs-lookup"><span data-stu-id="72d23-139">Register a remove handler</span></span>

<span data-ttu-id="72d23-140">Optional können Sie innerhalb der Logik für die Entfernungsseite den Ereignishandler aufrufen, wenn der Benutzer `registerOnRemoveHandler((RemoveEvent) => {}` eine vorhandene Registerkartenkonfiguration entfernt.</span><span class="sxs-lookup"><span data-stu-id="72d23-140">Optionally, within your removal page logic, you can  invoke the `registerOnRemoveHandler((RemoveEvent) => {}` event handler when the user removes an existing tab configuration.</span></span> <span data-ttu-id="72d23-141">Die Methode übernimmt die Schnittstelle und führt den Code im Handler aus, wenn ein Benutzer [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest&preserve-view=true) versucht, Inhalte zu entfernen.</span><span class="sxs-lookup"><span data-stu-id="72d23-141">The  method takes in the [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest&preserve-view=true) interface and executes the code in the handler when a user attempts to remove content.</span></span> <span data-ttu-id="72d23-142">Es wird zum Ausführen von Bereinigungsvorgängen verwendet, z. B. zum Entfernen der zugrunde liegenden Ressource, die den Registerkarteninhalt an die Macht macht.</span><span class="sxs-lookup"><span data-stu-id="72d23-142">It is used to perform cleanup operations such as removing the underlying resource powering the tab content.</span></span> <span data-ttu-id="72d23-143">Es kann immer nur ein Removehandler registriert werden.</span><span class="sxs-lookup"><span data-stu-id="72d23-143">Only one remove handler can be registered at a time.</span></span>

<span data-ttu-id="72d23-144">Die `RemoveEvent` Schnittstelle beschreibt ein Objekt mit zwei Methoden:</span><span class="sxs-lookup"><span data-stu-id="72d23-144">The `RemoveEvent` interface describes an object with two methods:</span></span>

* <span data-ttu-id="72d23-145">Die `notifySuccess()` Funktion ist erforderlich.</span><span class="sxs-lookup"><span data-stu-id="72d23-145">The `notifySuccess()` function is required.</span></span> <span data-ttu-id="72d23-146">Es gibt an, dass das Entfernen der zugrunde liegenden Ressource erfolgreich war und der inhalt entfernt werden kann.</span><span class="sxs-lookup"><span data-stu-id="72d23-146">It indicates that the removal of the underlying resource succeeded and its content can be removed.</span></span>

* <span data-ttu-id="72d23-147">Die `notifyFailure(string)` Funktion ist optional.</span><span class="sxs-lookup"><span data-stu-id="72d23-147">The `notifyFailure(string)` function is optional.</span></span> <span data-ttu-id="72d23-148">Es weist darauf hin, dass beim Entfernen der zugrunde liegenden Ressource ein Fehler aufting, und der Inhalt kann nicht entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="72d23-148">It indicates that removal of the underlying resource failed and its content cannot be removed.</span></span> <span data-ttu-id="72d23-149">Der optionale Zeichenfolgenparameter gibt einen Grund für den Fehler an.</span><span class="sxs-lookup"><span data-stu-id="72d23-149">The optional string parameter specifies a reason for the failure.</span></span> <span data-ttu-id="72d23-150">Wenn angegeben, wird diese Zeichenfolge dem Benutzer angezeigt. andernfalls wird ein allgemeiner Fehler angezeigt.</span><span class="sxs-lookup"><span data-stu-id="72d23-150">If provided, this string is displayed to the user; otherwise a generic error is displayed.</span></span>

#### <a name="use-the-getsettings-function"></a><span data-ttu-id="72d23-151">Verwenden der `getSettings()` Funktion</span><span class="sxs-lookup"><span data-stu-id="72d23-151">Use the `getSettings()` function</span></span>

<span data-ttu-id="72d23-152">Sie können den `getSettings()` zu entfernende Registerkarteninhalt festlegen.</span><span class="sxs-lookup"><span data-stu-id="72d23-152">You can use `getSettings()`to designate the tab content to be removed.</span></span> <span data-ttu-id="72d23-153">Die `getSettings((Settings) =>{})` Funktion übernimmt die [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest&preserve-view=true) gültigen Einstellungseigenschaftswerte, die abgerufen werden können.</span><span class="sxs-lookup"><span data-stu-id="72d23-153">The `getSettings((Settings) =>{})` function takes in the [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest&preserve-view=true) and provides the valid settings property values that can be retrieved.</span></span>

#### <a name="use-the-getcontext-function"></a><span data-ttu-id="72d23-154">Verwenden der `getContext()` Funktion</span><span class="sxs-lookup"><span data-stu-id="72d23-154">Use the `getContext()` function</span></span>

<span data-ttu-id="72d23-155">Sie können den `getContext()` aktuellen Kontext abrufen, in dem der Frame ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="72d23-155">You can use `getContext()` to retrieves the current context in which the frame is running.</span></span> <span data-ttu-id="72d23-156">Die Funktion übernimmt die gültigen Eigenschaftswerte, die Sie in Der Entfernungsseitenlogik verwenden können, um den Inhalt zu bestimmen, der auf der Seite zum Entfernen `getContext((Context) =>{})` [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest&preserve-view=true) angezeigt werden `Context` soll.</span><span class="sxs-lookup"><span data-stu-id="72d23-156">The `getContext((Context) =>{})` function takes in the [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest&preserve-view=true) and provides valid `Context` property values that you can use in your removal page logic to determine the content to display in the removal page.</span></span>

#### <a name="include-authentication"></a><span data-ttu-id="72d23-157">Authentifizierung mit ein- und ein-</span><span class="sxs-lookup"><span data-stu-id="72d23-157">Include authentication</span></span>

<span data-ttu-id="72d23-158">Möglicherweise benötigen Sie eine Authentifizierung, bevor Sie einem Benutzer das Löschen des Registerkarteninhalts erlauben.</span><span class="sxs-lookup"><span data-stu-id="72d23-158">You might require authentication before allowing a user to delete the tab content.</span></span> <span data-ttu-id="72d23-159">Kontextinformationen können zum Erstellen von URLs für Authentifizierungsanforderungen und Autorisierungsseiten verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="72d23-159">Context information can be used to help construct authentication requests and authorization page URLs.</span></span> <span data-ttu-id="72d23-160">Weitere [Informationen finden Sie unter Microsoft Teams-Authentifizierungsfluss für Registerkarten.](~/tabs/how-to/authentication/auth-flow-tab.md)</span><span class="sxs-lookup"><span data-stu-id="72d23-160">See [Microsoft Teams authentication flow for tabs](~/tabs/how-to/authentication/auth-flow-tab.md).</span></span> <span data-ttu-id="72d23-161">Stellen Sie sicher, dass alle auf Ihren Registerkartenseiten verwendeten Domänen im Array aufgeführt `manifest.json` `validDomains` sind.</span><span class="sxs-lookup"><span data-stu-id="72d23-161">Make sure that all domains used in your tab pages are listed in the `manifest.json` `validDomains` array.</span></span>

<span data-ttu-id="72d23-162">Nachfolgend finden Sie einen Beispielcodeblock zum Entfernen von Registerkarten:</span><span class="sxs-lookup"><span data-stu-id="72d23-162">Below is a sample tab removal code block:</span></span>

```html
<body>
  <button onclick="onClick()">Delete this tab and all underlying data?</button>
  <script>
    microsoftTeams.initialize();
    microsoftTeams.settings.registerOnRemoveHandler((removeEvent) => {
      // Here you can designate the tab content to be removed and/or archived.
        microsoftTeams.settings.getSettings((settings) => {
        settings.contentUrl = "..."
        });
        removeEvent.notifySuccess();
    });

    const onClick() => {
        microsoftTeams.settings.setValidityState(true);
    }
  </script>
</body>

```

<span data-ttu-id="72d23-163">Wenn ein Benutzer  aus dem Dropdownmenü der Registerkarte "Entfernen" auswählt, wird die optionale Seite (auf Der Konfigurationsseite festgelegt) von Teams in einen `removeUrl` IFrame geladen. </span><span class="sxs-lookup"><span data-stu-id="72d23-163">When a user selects **Remove** from the tab's drop-down menu, Teams will load the optional `removeUrl` page (designated in your **configuration page**) into an IFrame.</span></span> <span data-ttu-id="72d23-164">Hier wird dem Benutzer eine Schaltfläche angezeigt, die mit der Funktion geladen ist, die die Schaltfläche "Entfernen" aufruft und aktiviert, die sich am unteren Rand des IFrames zum Entfernen `onClick()` `microsoftTeams.settings.setValidityState(true)` befindet. </span><span class="sxs-lookup"><span data-stu-id="72d23-164">Here, the user is presented with a button loaded with the `onClick()` function that calls `microsoftTeams.settings.setValidityState(true)` and enables the **Remove** button located near the bottom of the removal page IFrame.</span></span>

<span data-ttu-id="72d23-165">Nach der Ausführung des Removehandlers oder benachrichtigen Sie Teams über das Ergebnis `removeEvent.notifySuccess()` `removeEvent.notifyFailure()` des Entfernens von Inhalten.</span><span class="sxs-lookup"><span data-stu-id="72d23-165">Following the execution of the remove handler, `removeEvent.notifySuccess()` or `removeEvent.notifyFailure()` notifies Teams of the content removal outcome.</span></span>

>[!NOTE]
><span data-ttu-id="72d23-166">Um sicherzustellen, dass die Kontrolle eines autorisierten Benutzers über eine Registerkarte nicht behindert wird, entfernt Teams die Registerkarte sowohl in Erfolgs- als auch in Fehlerfällen.</span><span class="sxs-lookup"><span data-stu-id="72d23-166">To ensure that an authorized user's control over a tab is not inhibited, Teams will remove the tab in both success and failure cases.</span></span>\
><span data-ttu-id="72d23-167">Teams aktiviert die **Schaltfläche "Entfernen"** nach 5 Sekunden, auch wenn Ihre Registerkarte ".\ " nicht aufgerufen `setValidityState()` hat.</span><span class="sxs-lookup"><span data-stu-id="72d23-167">Teams enables the **Remove** button after 5 seconds, even if your tab hasn't called `setValidityState()`.\</span></span>
><span data-ttu-id="72d23-168">Wenn der Benutzer **"Teams** entfernen" auswählt, wird die Registerkarte nach 30 Sekunden entfernt, unabhängig davon, ob Ihre Aktionen abgeschlossen wurden.</span><span class="sxs-lookup"><span data-stu-id="72d23-168">When the user selects **Remove** Teams removes the tab after 30 seconds regardless of whether your actions have completed.</span></span>
