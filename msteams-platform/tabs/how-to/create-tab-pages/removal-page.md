---
title: Erstellen einer Registerkarten-Entfernungs Seite
author: laujan
description: Erstellen einer Registerkarten-Entfernungs Seite
keywords: Teams-Registerkartengruppe Kanal konfigurierbar entfernen löschen
ms.topic: conceptual
ms.author: ''
ms.openlocfilehash: 576a3bc88d8776a193b48868d37df204c3112fd8
ms.sourcegitcommit: 4329a94918263c85d6c65ff401f571556b80307b
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 02/01/2020
ms.locfileid: "41674085"
---
# <a name="modify-or-remove-a-channel-group-tab"></a><span data-ttu-id="6616a-104">Ändern oder Entfernen einer Kanalgruppen Registerkarte</span><span class="sxs-lookup"><span data-stu-id="6616a-104">Modify or remove a channel group tab</span></span>

<span data-ttu-id="6616a-105">Sie können die Benutzerfreundlichkeit erweitern und verbessern, indem Sie Entfernungs-und Änderungsoptionen in Ihrer APP unterstützen.</span><span class="sxs-lookup"><span data-stu-id="6616a-105">You can extend and enhance the user experience by supporting removal and modification options in your app.</span></span> <span data-ttu-id="6616a-106">Microsoft Teams ermöglicht Benutzern das Umbenennen oder Entfernen einer Kanal/Gruppen-Registerkarte, und Sie können Benutzern das erneute Konfigurieren ihrer Registerkarte nach der Installation gestatten.</span><span class="sxs-lookup"><span data-stu-id="6616a-106">Teams enables users to rename or remove a channel/group tab and you can permit users to reconfigure your tab after installation.</span></span> <span data-ttu-id="6616a-107">Darüber hinaus können Sie mit der Registerkarten Entfernung festlegen, was mit dem Inhalt geschieht, wenn die Registerkarte entfernt wird, oder Benutzern nach dem Entfernen Optionen wie löschen oder Archivieren des Inhalts zuweisen.</span><span class="sxs-lookup"><span data-stu-id="6616a-107">Additionally, your tab removal experience can include designating what happens to the content when your tab is removed or giving users post-removal options such as deleting or archiving the content.</span></span>

## <a name="enable-your-tab-to-be-reconfigured-after-installation"></a><span data-ttu-id="6616a-108">Aktivieren der erneuten Konfiguration der Registerkarte nach der Installation</span><span class="sxs-lookup"><span data-stu-id="6616a-108">Enable your tab to be reconfigured after installation</span></span>

<span data-ttu-id="6616a-109">Ihre **Manifest. JSON** definiert die Funktionen und Funktionen Ihrer Registerkarte.</span><span class="sxs-lookup"><span data-stu-id="6616a-109">Your **manifest.json** defines your tab's features and capabilities.</span></span> <span data-ttu-id="6616a-110">Die Eigenschaft der `canUpdateConfiguration` Tab-Instanz akzeptiert einen booleschen Wert, der angibt, ob ein Benutzer die Registerkarte nach der Erstellung ändern oder neu konfigurieren kann:</span><span class="sxs-lookup"><span data-stu-id="6616a-110">The tab instance `canUpdateConfiguration` property takes a Boolean value that indicates whether a user can modify or reconfigure the tab after it is created:</span></span>

|<span data-ttu-id="6616a-111">Name</span><span class="sxs-lookup"><span data-stu-id="6616a-111">Name</span></span>| <span data-ttu-id="6616a-112">Typ</span><span class="sxs-lookup"><span data-stu-id="6616a-112">Type</span></span>| <span data-ttu-id="6616a-113">Maximale Größe</span><span class="sxs-lookup"><span data-stu-id="6616a-113">Maximum size</span></span> | <span data-ttu-id="6616a-114">Erforderlich</span><span class="sxs-lookup"><span data-stu-id="6616a-114">Required</span></span> | <span data-ttu-id="6616a-115">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="6616a-115">Description</span></span>|
|---|---|---|---|---|
|`canUpdateConfiguration`|<span data-ttu-id="6616a-116">Boolean</span><span class="sxs-lookup"><span data-stu-id="6616a-116">Boolean</span></span>|||<span data-ttu-id="6616a-117">Ein Wert, der angibt, ob eine Instanz der Konfiguration der Registerkarte nach der Erstellung vom Benutzer aktualisiert werden kann.</span><span class="sxs-lookup"><span data-stu-id="6616a-117">A value indicating whether an instance of the tab's configuration can be updated by the user after creation.</span></span> <span data-ttu-id="6616a-118">Standard`true`</span><span class="sxs-lookup"><span data-stu-id="6616a-118">Default: `true`</span></span>|

<span data-ttu-id="6616a-119">Wenn Ihre Registerkarte in einen Kanal-oder Gruppenchat hochgeladen wird, fügt Microsoft Teams ein Rechtsklick-Dropdownmenü für die Registerkarte hinzu. Die verfügbaren Optionen werden durch `canUpdateConfiguration` die Einstellung bestimmt:</span><span class="sxs-lookup"><span data-stu-id="6616a-119">When your tab is uploaded to a channel or group chat, Teams will add a right-click drop-down menu for your tab. The available options are determined by the `canUpdateConfiguration` setting:</span></span>

| `canUpdateConfiguration`| <span data-ttu-id="6616a-120">true</span><span class="sxs-lookup"><span data-stu-id="6616a-120">true</span></span>   | <span data-ttu-id="6616a-121">false</span><span class="sxs-lookup"><span data-stu-id="6616a-121">false</span></span> | <span data-ttu-id="6616a-122">description</span><span class="sxs-lookup"><span data-stu-id="6616a-122">description</span></span> |
| ----------------------- | :----: | ----- | ----------- |
|     <span data-ttu-id="6616a-123">Einstellungen</span><span class="sxs-lookup"><span data-stu-id="6616a-123">Settings</span></span>            |   <span data-ttu-id="6616a-124">√</span><span class="sxs-lookup"><span data-stu-id="6616a-124">√</span></span>    |       |<span data-ttu-id="6616a-125">Die `configurationUrl` Seite wird in einem IFRAME neu geladen, sodass der Benutzer die Registerkarte neu konfigurieren kann.</span><span class="sxs-lookup"><span data-stu-id="6616a-125">The `configurationUrl` page is reloaded in an IFrame allowing the user to reconfigure the tab.</span></span>  |
|     <span data-ttu-id="6616a-126">Umbenennen</span><span class="sxs-lookup"><span data-stu-id="6616a-126">Rename</span></span>              |   <span data-ttu-id="6616a-127">√</span><span class="sxs-lookup"><span data-stu-id="6616a-127">√</span></span>    |   <span data-ttu-id="6616a-128">√</span><span class="sxs-lookup"><span data-stu-id="6616a-128">√</span></span>   | <span data-ttu-id="6616a-129">Der Benutzer kann den Registerkartennamen so ändern, wie er in der Registerkartenleiste angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="6616a-129">The user can change the tab name as it appears in the tab bar.</span></span>          |
|     <span data-ttu-id="6616a-130">Entfernen</span><span class="sxs-lookup"><span data-stu-id="6616a-130">Remove</span></span>              |   <span data-ttu-id="6616a-131">√</span><span class="sxs-lookup"><span data-stu-id="6616a-131">√</span></span>    |   <span data-ttu-id="6616a-132">√</span><span class="sxs-lookup"><span data-stu-id="6616a-132">√</span></span>   |  <span data-ttu-id="6616a-133">Wenn die `removeURL` Eigenschaft und der Wert auf der **Konfigurationsseite**enthalten sind, wird die **Entfernungs Seite** in einen IFRAME geladen und dem Benutzer zur Verfügung gestellt.</span><span class="sxs-lookup"><span data-stu-id="6616a-133">If the  `removeURL` property and value are included in the **configuration page**, the **removal page** is loaded into an IFrame and presented to the user.</span></span> <span data-ttu-id="6616a-134">Wenn keine Entfernungs Seite enthalten ist, wird dem Benutzer ein Bestätigungsdialogfeld angezeigt.</span><span class="sxs-lookup"><span data-stu-id="6616a-134">If a removal page is not included the user is presented with a confirm dialog box.</span></span>          |
|||||

## <a name="create-a-tab-removal-page-for-your-application"></a><span data-ttu-id="6616a-135">Erstellen einer Registerkarten-Entfernungs Seite für Ihre Anwendung</span><span class="sxs-lookup"><span data-stu-id="6616a-135">Create a tab removal page for your application</span></span>

<span data-ttu-id="6616a-136">Die optionale Entfernungs Seite ist eine HTML-Seite, die Sie hosten und angezeigt wird, wenn die Registerkarte entfernt wird.</span><span class="sxs-lookup"><span data-stu-id="6616a-136">The optional removal page is an HTML page that you host and is displayed when the tab is removed.</span></span> <span data-ttu-id="6616a-137">Die URL der Entfernungs Seite wird von `setSettings()` der-Methode auf Ihrer Konfigurationsseite festgelegt.</span><span class="sxs-lookup"><span data-stu-id="6616a-137">The removal page URL is designated by the `setSettings()` method within your configuration page.</span></span> <span data-ttu-id="6616a-138">Wie bei allen Seiten in Ihrer APP muss die Entfernungs Seite den [Registerkarten Anforderungen für Teams](~/tabs/how-to/add-tab.md)entsprechen.</span><span class="sxs-lookup"><span data-stu-id="6616a-138">As with all pages in your app, the removal page must comply with [Teams tab requirements](~/tabs/how-to/add-tab.md).</span></span>

### <a name="register-a-remove-handler"></a><span data-ttu-id="6616a-139">Registrieren eines Remove-Handlers</span><span class="sxs-lookup"><span data-stu-id="6616a-139">Register a remove handler</span></span>

<span data-ttu-id="6616a-140">Optional können Sie in der Logik ihrer Entfernungs Seite den `registerOnRemoveHandler((RemoveEvent) => {}` Ereignishandler aufrufen, wenn der Benutzer eine vorhandene Registerkartenkonfiguration entfernt.</span><span class="sxs-lookup"><span data-stu-id="6616a-140">Optionally, within your removal page logic, you can  invoke the `registerOnRemoveHandler((RemoveEvent) => {}` event handler when the user removes an existing tab configuration.</span></span> <span data-ttu-id="6616a-141">Die-Methode nimmt die [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest) Schnittstelle an und führt den Code im Handler aus, wenn ein Benutzer versucht, Inhalte zu entfernen.</span><span class="sxs-lookup"><span data-stu-id="6616a-141">The  method takes in the [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest) interface and executes the code in the handler when a user attempts to remove content.</span></span> <span data-ttu-id="6616a-142">Es wird verwendet, um Bereinigungsvorgänge wie das Entfernen der zugrunde liegenden Ressource, die die Registerkarteninhalte macht, auszuführen.</span><span class="sxs-lookup"><span data-stu-id="6616a-142">It is used to perform cleanup operations such as removing the underlying resource powering the tab content.</span></span> <span data-ttu-id="6616a-143">Nur ein Remove-Handler kann gleichzeitig registriert werden.</span><span class="sxs-lookup"><span data-stu-id="6616a-143">Only one remove handler can be registered at a time.</span></span>

<span data-ttu-id="6616a-144">Die `RemoveEvent` Schnittstelle beschreibt ein Objekt mit zwei Methoden:</span><span class="sxs-lookup"><span data-stu-id="6616a-144">The `RemoveEvent` interface describes an object with two methods:</span></span>

* <span data-ttu-id="6616a-145">Die `notifySuccess()` Funktion ist erforderlich.</span><span class="sxs-lookup"><span data-stu-id="6616a-145">The `notifySuccess()` function is required.</span></span> <span data-ttu-id="6616a-146">Er gibt an, dass das Entfernen der zugrunde liegenden Ressource erfolgreich war und dass der Inhalt entfernt werden kann.</span><span class="sxs-lookup"><span data-stu-id="6616a-146">It indicates that the removal of the underlying resource succeeded and its content can be removed.</span></span>

* <span data-ttu-id="6616a-147">Die `notifyFailure(string)` Funktion ist optional.</span><span class="sxs-lookup"><span data-stu-id="6616a-147">The `notifyFailure(string)` function is optional.</span></span> <span data-ttu-id="6616a-148">Er gibt an, dass das Entfernen der zugrunde liegenden Ressource fehlgeschlagen ist und dass der Inhalt nicht entfernt werden kann.</span><span class="sxs-lookup"><span data-stu-id="6616a-148">It indicates that removal of the underlying resource failed and its content cannot be removed.</span></span> <span data-ttu-id="6616a-149">Der optionale String-Parameter gibt einen Grund für den Fehler an.</span><span class="sxs-lookup"><span data-stu-id="6616a-149">The optional string parameter specifies a reason for the failure.</span></span> <span data-ttu-id="6616a-150">Wenn angegeben, wird diese Zeichenfolge dem Benutzer angezeigt; Andernfalls wird ein generischer Fehler angezeigt.</span><span class="sxs-lookup"><span data-stu-id="6616a-150">If provided, this string is displayed to the user; otherwise a generic error is displayed.</span></span>

#### <a name="use-the-getsettings-function"></a><span data-ttu-id="6616a-151">Verwenden Sie `getSettings()` die Funktion</span><span class="sxs-lookup"><span data-stu-id="6616a-151">Use the `getSettings()` function</span></span>

<span data-ttu-id="6616a-152">Sie können zum `getSettings()`Festlegen des zu entfernenden Registerkarteninhalts verwenden.</span><span class="sxs-lookup"><span data-stu-id="6616a-152">You can use `getSettings()`to designate the tab content to be removed.</span></span> <span data-ttu-id="6616a-153">Die `getSettings((Settings) =>{})` -Funktion übernimmt die [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest) und stellt die gültigen Einstellungen-Eigenschaftswerte bereit, die abgerufen werden können.</span><span class="sxs-lookup"><span data-stu-id="6616a-153">The `getSettings((Settings) =>{})` function takes in the [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest) and provides the valid settings property values that can be retrieved.</span></span>

#### <a name="use-the-getcontext-function"></a><span data-ttu-id="6616a-154">Verwenden Sie `getContext()` die Funktion</span><span class="sxs-lookup"><span data-stu-id="6616a-154">Use the `getContext()` function</span></span>

<span data-ttu-id="6616a-155">Sie können zum `getContext()` Abrufen des aktuellen Kontexts verwenden, in dem der Frame gestartet wird.</span><span class="sxs-lookup"><span data-stu-id="6616a-155">You can use `getContext()` to retrieves the current context in which the frame is running.</span></span> <span data-ttu-id="6616a-156">Die `getContext((Context) =>{})` -Funktion übernimmt die [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest) und stellt gültige `Context` Eigenschaftswerte bereit, die Sie in ihrer Entfernungs Seitenlogik verwenden können, um den Inhalt zu bestimmen, der auf der Entfernungs Seite angezeigt werden soll.</span><span class="sxs-lookup"><span data-stu-id="6616a-156">The `getContext((Context) =>{})` function takes in the [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest) and provides valid `Context` property values that you can use in your removal page logic to determine the content to display in the removal page.</span></span>

#### <a name="include-authentication"></a><span data-ttu-id="6616a-157">Einschließen der Authentifizierung</span><span class="sxs-lookup"><span data-stu-id="6616a-157">Include authentication</span></span>

<span data-ttu-id="6616a-158">Möglicherweise müssen Sie eine Authentifizierung benötigen, bevor Sie einem Benutzer das Löschen der Registerkarteninhalte ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="6616a-158">You might require authentication before allowing a user to delete the tab content.</span></span> <span data-ttu-id="6616a-159">Kontextinformationen können verwendet werden, um die Erstellung von Authentifizierungsanforderungen und Autorisierungs Seiten-URLs zu erleichtern.</span><span class="sxs-lookup"><span data-stu-id="6616a-159">Context information can be used to help construct authentication requests and authorization page URLs.</span></span> <span data-ttu-id="6616a-160">Weitere Informationen finden Sie unter [Microsoft Teams-Authentifizierungs Fluss für Registerkarten](~/tabs/how-to/authentication/auth-flow-tab.md).</span><span class="sxs-lookup"><span data-stu-id="6616a-160">See [Microsoft Teams authentication flow for tabs](~/tabs/how-to/authentication/auth-flow-tab.md).</span></span> <span data-ttu-id="6616a-161">Stellen Sie sicher, dass alle auf den Registerkartenseiten verwendeten Domänen im `manifest.json` `validDomains` Array aufgelistet sind.</span><span class="sxs-lookup"><span data-stu-id="6616a-161">Make sure that all domains used in your tab pages are listed in the `manifest.json` `validDomains` array.</span></span>

<span data-ttu-id="6616a-162">Unten finden Sie einen Codebaustein zum Entfernen von Beispiel Registerkarten:</span><span class="sxs-lookup"><span data-stu-id="6616a-162">Below is a sample tab removal code block:</span></span>

```html
<body>
  <button onclick="onClick()">Delete this tab and all underlying data?</button>
  <script>
    microsoftTeams.initialize();
    microsoftTeams.settings.registerOnRemoveHandler((removeEvent) => {
      // Here you can designate the tab content to be removed and/or archived.
        microsoftTeams.settings.getSettings((settings) => {
        settings.contentUrl = "..."
        });
        removeEvent.notifySuccess();
    });

    const onClick() => {
        microsoftTeams.settings.setValidityState(true);
    }
  </script>
</body>

```

<span data-ttu-id="6616a-163">Wenn ein Benutzer aus dem Dropdownmenü der Registerkarte **Entfernen** auswählt, lädt Microsoft Teams die optionale `removeUrl` Seite (in Ihrer **Konfigurationsseite**festgelegt) in einen iframe.</span><span class="sxs-lookup"><span data-stu-id="6616a-163">When a user selects **Remove** from the tab's drop-down menu, Teams will load the optional `removeUrl` page (designated in your **configuration page**) into an IFrame.</span></span> <span data-ttu-id="6616a-164">Hier wird dem Benutzer eine Schaltfläche mit der `onClick()` Funktion zur Verfügung gestellt, `microsoftTeams.settings.setValidityState(true)` die die Schaltfläche **Entfernen** im unteren Bereich der Entfernungs Seite IFRAME aufruft und aktiviert.</span><span class="sxs-lookup"><span data-stu-id="6616a-164">Here, the user is presented with a button loaded with the `onClick()` function that calls `microsoftTeams.settings.setValidityState(true)` and enables the **Remove** button located near the bottom of the removal page IFrame.</span></span>

<span data-ttu-id="6616a-165">Nach der Ausführung des Remove- `removeEvent.notifySuccess()` Handlers oder `removeEvent.notifyFailure()` benachrichtigt Teams über das Ergebnis der Inhalts Entfernung.</span><span class="sxs-lookup"><span data-stu-id="6616a-165">Following the execution of the remove handler, `removeEvent.notifySuccess()` or `removeEvent.notifyFailure()` notifies Teams of the content removal outcome.</span></span>

>[!NOTE]
><span data-ttu-id="6616a-166">Um sicherzustellen, dass die Steuerung eines autorisierten Benutzers über eine Registerkarte nicht gehemmt wird, wird die Registerkarte in Microsoft Teams sowohl in Success als auch in Fehlerfällen entfernt. </span><span class="sxs-lookup"><span data-stu-id="6616a-166">To ensure that an authorized user's control over a tab is not inhibited, Teams will remove the tab in both success and failure cases.</span></span>\
><span data-ttu-id="6616a-167">Teams aktiviert die Schaltfläche **Entfernen** nach 5 Sekunden, auch wenn die Registerkarte `setValidityState()`nicht aufgerufen wird. </span><span class="sxs-lookup"><span data-stu-id="6616a-167">Teams enables the **Remove** button after 5 seconds, even if your tab hasn't called `setValidityState()`.</span></span>\
><span data-ttu-id="6616a-168">Wenn der Benutzer **Remove** Teams auswählt, wird die Registerkarte nach 30 Sekunden entfernt, unabhängig davon, ob Ihre Aktionen abgeschlossen wurden.</span><span class="sxs-lookup"><span data-stu-id="6616a-168">When the user selects **Remove** Teams removes the tab after 30 seconds regardless of whether your actions have completed.</span></span>
