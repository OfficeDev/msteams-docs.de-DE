---
title: Bot-API-Änderungen für Team- und Chatmitglieder
author: ojasvichoudhary
description: Beschreibt bevorstehende und laufende Änderungen an den Bot-APIs, die zum Abrufen von Mitgliedern von Teams und Chats verwendet werden.
keywords: Listenliste für Bot-Framework-APIs-Teammitglieder
localization_priority: Normal
ms.topic: reference
ms.author: ojchoudh
ms.openlocfilehash: 9c6444967d330d27a415ac596a3858c05c49236e
ms.sourcegitcommit: b1f9162a0bbcd276064ae9e4f1e8bccc06cb7035
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 07/07/2021
ms.locfileid: "53328065"
---
# <a name="teams-bot-api-changes-to-fetch-team-or-chat-members"></a><span data-ttu-id="4d39c-104">Teams Bot-API-Änderungen zum Abrufen von Team- oder Chatmitgliedern</span><span class="sxs-lookup"><span data-stu-id="4d39c-104">Teams bot API changes to fetch team or chat members</span></span>

>[!NOTE]
> <span data-ttu-id="4d39c-105">Der Veraltete Prozess für `TeamsInfo.getMembers` und `TeamsInfo.GetMembersAsync` APIs wurde gestartet.</span><span class="sxs-lookup"><span data-stu-id="4d39c-105">The deprecation process for `TeamsInfo.getMembers` and `TeamsInfo.GetMembersAsync` APIs have started.</span></span> <span data-ttu-id="4d39c-106">Anfangs werden sie stark auf fünf Anforderungen pro Minute gedrosselt und geben maximal 10.000 Mitglieder pro Team zurück.</span><span class="sxs-lookup"><span data-stu-id="4d39c-106">Initially, they are heavily throttled to five requests per minute and return a maximum of 10K members per team.</span></span> <span data-ttu-id="4d39c-107">Dies führt dazu, dass die vollständige Liste nicht zurückgegeben wird, wenn die Teamgröße zunimmt.</span><span class="sxs-lookup"><span data-stu-id="4d39c-107">This results in the full roster not being returned as team size increases.</span></span>
> <span data-ttu-id="4d39c-108">Sie müssen auf Version 4.10 oder höher des Bot Framework SDK aktualisieren und zu den paginierten API-Endpunkten oder der `TeamsInfo.GetMemberAsync` API für einzelne Benutzer wechseln.</span><span class="sxs-lookup"><span data-stu-id="4d39c-108">You must update to version 4.10 or higher of the Bot Framework SDK and switch to the paginated API endpoints, or the `TeamsInfo.GetMemberAsync` single user API.</span></span> <span data-ttu-id="4d39c-109">Dies gilt auch für Ihren Bot, auch wenn Sie diese APIs nicht direkt verwenden, da ältere SDKs diese APIs während [MembersAdded-Ereignissen](../bots/how-to/conversations/subscribe-to-conversation-events.md#team-members-added) aufrufen.</span><span class="sxs-lookup"><span data-stu-id="4d39c-109">This also applies to your bot even if you are not directly using these APIs, as older SDKs call these APIs during [membersAdded](../bots/how-to/conversations/subscribe-to-conversation-events.md#team-members-added) events.</span></span> <span data-ttu-id="4d39c-110">Informationen zum Anzeigen der Liste bevorstehender Änderungen finden Sie unter [API-Änderungen.](team-chat-member-api-changes.md#api-changes)</span><span class="sxs-lookup"><span data-stu-id="4d39c-110">To view the list of upcoming changes, see [API changes](team-chat-member-api-changes.md#api-changes).</span></span>

<span data-ttu-id="4d39c-111">Wenn Sie informationen zu einem oder mehreren Mitgliedern eines Chats oder Teams abrufen möchten, können Sie derzeit die [Microsoft Teams-Bot-APIs](/microsoftteams/platform/bots/how-to/get-teams-context?tabs=dotnet#fetch-the-roster-or-user-profile) `TeamsInfo.GetMembersAsync` für C# oder für `TeamsInfo.getMembers` TypeScript- oder Node.js-APIs verwenden.</span><span class="sxs-lookup"><span data-stu-id="4d39c-111">Currently, if you want to retrieve information for one or more members of a chat or team, you can use the [Microsoft Teams bot APIs](/microsoftteams/platform/bots/how-to/get-teams-context?tabs=dotnet#fetch-the-roster-or-user-profile) `TeamsInfo.GetMembersAsync` for C# or `TeamsInfo.getMembers` for TypeScript or Node.js APIs.</span></span> <span data-ttu-id="4d39c-112">Weitere Informationen finden Sie unter [Abrufen von Dienstplänen oder Benutzerprofilen.](../bots/how-to/get-teams-context.md#fetch-the-roster-or-user-profile)</span><span class="sxs-lookup"><span data-stu-id="4d39c-112">For more information, see [fetch roster or user profile](../bots/how-to/get-teams-context.md#fetch-the-roster-or-user-profile).</span></span>

<span data-ttu-id="4d39c-113">Diese APIs weisen die folgenden Nachteile auf:</span><span class="sxs-lookup"><span data-stu-id="4d39c-113">These APIs have the following shortcomings:</span></span>

* <span data-ttu-id="4d39c-114">Bei großen Teams ist die Leistung schlecht, und Timeouts sind wahrscheinlicher: Die maximale Teamgröße ist seit der Veröffentlichung Teams Anfang 2017 erheblich gestiegen.</span><span class="sxs-lookup"><span data-stu-id="4d39c-114">For large teams, performance is poor and timeouts are more likely: The maximum team size has grown considerably since Teams was released in early 2017.</span></span> <span data-ttu-id="4d39c-115">As `GetMembersAsync` or returns the entire member `getMembers` list, it takes a long time for the API call to return for large teams, and it is common for the call to time out and you have to try again.</span><span class="sxs-lookup"><span data-stu-id="4d39c-115">As `GetMembersAsync` or `getMembers` returns the entire member list, it takes a long time for the API call to return for large teams, and it is common for the call to time out and you have to try again.</span></span>
* <span data-ttu-id="4d39c-116">Das Abrufen von Profildetails für einen einzelnen Benutzer ist schwierig: Um die Profilinformationen für einen einzelnen Benutzer abzurufen, müssen Sie die gesamte Mitgliederliste abrufen und dann nach der gewünschten Liste suchen.</span><span class="sxs-lookup"><span data-stu-id="4d39c-116">Getting profile details for a single user is difficult: To get the profile information for a single user, you have to retrieve the entire member list and then search for the one you want.</span></span> <span data-ttu-id="4d39c-117">Es gibt eine Hilfsfunktion im Bot Framework SDK, um sie zu vereinfachen, ist aber nicht effizient.</span><span class="sxs-lookup"><span data-stu-id="4d39c-117">There is a helper function in the Bot Framework SDK to make it simpler, but it is not efficient.</span></span>

<span data-ttu-id="4d39c-118">Mit der Einführung organisationsweiter Teams ist es erforderlich, diese APIs besser an Office 365 Datenschutzkontrollen auszurichten.</span><span class="sxs-lookup"><span data-stu-id="4d39c-118">With the introduction of organization wide teams, there is a requirement to better align these APIs with Office 365 privacy controls.</span></span> <span data-ttu-id="4d39c-119">Bots, die in großen Teams verwendet werden, können grundlegende Profilinformationen wie die `User.ReadBasic.All` Microsoft Graph-Berechtigung abrufen.</span><span class="sxs-lookup"><span data-stu-id="4d39c-119">Bots used in large teams are able to retrieve basic profile information similar to the `User.ReadBasic.All` Microsoft Graph permission.</span></span> <span data-ttu-id="4d39c-120">Mandantenadministratoren haben eine große Kontrolle darüber, welche Apps und Bots in ihrem Mandanten verwendet werden können, aber diese Einstellungen unterscheiden sich von Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="4d39c-120">Tenant administrators have a great deal of control over which apps and bots can be used in their tenant, but these settings are different from Microsoft Graph.</span></span>

<span data-ttu-id="4d39c-121">Der folgende Code stellt eine JSON-Beispieldarstellung der von Teams Bot-APIs zurückgegebenen Elemente bereit:</span><span class="sxs-lookup"><span data-stu-id="4d39c-121">The following code provides a sample JSON representation of what is returned by Teams bot APIs:</span></span>

```json
[{
    "id": "29:1GcS4EyB_oSI8A88XmWBN7NJFyMqe3QGnJdgLfFGkJnVelzRGos0bPbpsfJjcbAD22bmKc4GMbrY2g4JDrrA8vM06X1-cHHle4zOE6U4ttcc",
    "name": "Anon1 (Guest)",
    "tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47",
    "userRole": "anonymous"
}, {
    "id": "29:1bSnHZ7Js2STWrgk6ScEErLk1Lp2zQuD5H2qQ960rtvstKp8tKLl-3r8b6DoW0QxZimuTxk_kupZ1DBMpvIQQUAZL-PNj0EORDvRZXy8kvWk",
    "objectId": "76b0b09f-d410-48fd-993e-84da521a597b",
    "givenName": "John",
    "surname": "Patterson",
    "email": "johnp@fabrikam.com",
    "userPrincipalName": "johnp@fabrikam.com",
    "tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47",
    "userRole": "user"
}, {
    "id": "29:1URzNQM1x1PNMr1D7L5_lFe6qF6gEfAbkdG8_BUxOW2mTKryQqEZtBTqDt10-MghkzjYDuUj4KG6nvg5lFAyjOLiGJ4jzhb99WrnI7XKriCs",
    "objectId": "6b7b3b2a-2c4b-4175-8582-41c9e685c1b5",
    "givenName": "Rick",
    "surname": "Stevens",
    "email": "Rick.Stevens@fabrikam.com",
    "userPrincipalName": "rstevens@fabrikam.com",
    "tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47",
    "userRole": "user"
}]
```

## <a name="api-changes"></a><span data-ttu-id="4d39c-122">API-Änderungen</span><span class="sxs-lookup"><span data-stu-id="4d39c-122">API Changes</span></span>

<span data-ttu-id="4d39c-123">Nachfolgend sind die bevorstehenden API-Änderungen aufgeführt:</span><span class="sxs-lookup"><span data-stu-id="4d39c-123">Following are the upcoming API changes:</span></span>

* <span data-ttu-id="4d39c-124">Es wird eine neue API [`TeamsInfo.GetPagedMembersAsync`](/microsoftteams/platform/bots/how-to/get-teams-context?tabs=dotnet#fetch-the-roster-or-user-profile) zum Abrufen von Profilinformationen für Mitglieder eines Chats oder Teams erstellt.</span><span class="sxs-lookup"><span data-stu-id="4d39c-124">A new API is created [`TeamsInfo.GetPagedMembersAsync`](/microsoftteams/platform/bots/how-to/get-teams-context?tabs=dotnet#fetch-the-roster-or-user-profile) for retrieving profile information for members of a chat or team.</span></span> <span data-ttu-id="4d39c-125">Diese API ist jetzt mit bot Framework Version 4.8 oder höher SDK verfügbar.</span><span class="sxs-lookup"><span data-stu-id="4d39c-125">This API is now available with the Bot Framework version 4.8 or later SDK.</span></span> <span data-ttu-id="4d39c-126">Verwenden Sie für die Entwicklung in allen anderen Versionen die [`GetConversationPagedMembers`](/dotnet/api/microsoft.bot.connector.conversationsextensions.getconversationpagedmembersasync?view=botbuilder-dotnet-stable&preserve-view=true) Methode.</span><span class="sxs-lookup"><span data-stu-id="4d39c-126">For development in all other versions, use the [`GetConversationPagedMembers`](/dotnet/api/microsoft.bot.connector.conversationsextensions.getconversationpagedmembersasync?view=botbuilder-dotnet-stable&preserve-view=true) method.</span></span>

    > [!NOTE]
    > <span data-ttu-id="4d39c-127">In v3 oder v4 besteht die beste Aktion darin, auf die neueste Punktversion zu aktualisieren, die 3.30.2 oder 4.8 oder höher ist.</span><span class="sxs-lookup"><span data-stu-id="4d39c-127">In either v3 or v4, the best action is to upgrade to the latest point release that is 3.30.2 or 4.8 or later respectively.</span></span>

* <span data-ttu-id="4d39c-128">Es wird eine neue API [`TeamsInfo.GetMemberAsync`](/microsoftteams/platform/bots/how-to/get-teams-context?tabs=dotnet#get-single-member-details) zum Abrufen der Profilinformationen für einen einzelnen Benutzer erstellt.</span><span class="sxs-lookup"><span data-stu-id="4d39c-128">A new API is created [`TeamsInfo.GetMemberAsync`](/microsoftteams/platform/bots/how-to/get-teams-context?tabs=dotnet#get-single-member-details) for retrieving the profile information for a single user.</span></span> <span data-ttu-id="4d39c-129">Sie verwendet die ID des Teams oder Chats und einen [UPN](/windows/win32/ad/naming-properties#userprincipalname) `userPrincipalName` , Azure Active Directory Objekt-ID, `objectId` oder die Teams Benutzer-ID `id` als Parameter und gibt die Profilinformationen für diesen Benutzer zurück.</span><span class="sxs-lookup"><span data-stu-id="4d39c-129">It takes the ID of the team or chat and a [UPN](/windows/win32/ad/naming-properties#userprincipalname) that is `userPrincipalName`, Azure Active Directory Object ID `objectId`, or the Teams user ID `id` as parameters and returns the profile information for that user.</span></span>

    > [!NOTE]
    > <span data-ttu-id="4d39c-130">`objectId` wird so geändert, dass es `aadObjectId` mit dem übereinstimmt, was im Objekt einer `Activity` Bot Framework-Nachricht aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="4d39c-130">`objectId` is changed to `aadObjectId` to match what is called in the `Activity` object of a Bot Framework message.</span></span> <span data-ttu-id="4d39c-131">Die neue API ist mit Version 4.8 oder höher des Bot Framework SDK verfügbar.</span><span class="sxs-lookup"><span data-stu-id="4d39c-131">The new API is available with version 4.8 or later of the Bot Framework SDK.</span></span> <span data-ttu-id="4d39c-132">Es ist auch in der Teams SDK-Erweiterung Bot Framework 3.x verfügbar.</span><span class="sxs-lookup"><span data-stu-id="4d39c-132">It is also available in the Teams SDK extension Bot Framework 3.x.</span></span> <span data-ttu-id="4d39c-133">In der Zwischenzeit können Sie den [REST-Endpunkt](/microsoftteams/platform/bots/how-to/get-teams-context?tabs=json#get-single-member-details) verwenden.</span><span class="sxs-lookup"><span data-stu-id="4d39c-133">Meanwhile, you can use the [REST](/microsoftteams/platform/bots/how-to/get-teams-context?tabs=json#get-single-member-details) endpoint.</span></span>

* <span data-ttu-id="4d39c-134">`TeamsInfo.GetMembersAsync` in C# und `TeamsInfo.getMembers` in TypeScript oder Node.js ist formell veraltet.</span><span class="sxs-lookup"><span data-stu-id="4d39c-134">`TeamsInfo.GetMembersAsync` in C# and `TeamsInfo.getMembers` in TypeScript or Node.js is formally deprecated.</span></span> <span data-ttu-id="4d39c-135">Sobald die neue API verfügbar ist, müssen Sie Ihre Bots aktualisieren, um sie zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="4d39c-135">Once the new API is available, you must update your bots to use it.</span></span> <span data-ttu-id="4d39c-136">Dies gilt auch für die [zugrunde liegende REST-API, die diese APIs verwenden.](/microsoftteams/platform/bots/how-to/get-teams-context?tabs=json#tabpanel_CeZOj-G++Q_json)</span><span class="sxs-lookup"><span data-stu-id="4d39c-136">This also applies to the [underlying REST API that these APIs use](/microsoftteams/platform/bots/how-to/get-teams-context?tabs=json#tabpanel_CeZOj-G++Q_json).</span></span>
* <span data-ttu-id="4d39c-137">Ende 2022 können Bots die Oder Eigenschaften für Mitglieder eines Chats oder Teams nicht proaktiv `userPrincipalName` `email` abrufen.</span><span class="sxs-lookup"><span data-stu-id="4d39c-137">By late 2022, bots cannot proactively retrieve the `userPrincipalName` or `email` properties for members of a chat or team.</span></span> <span data-ttu-id="4d39c-138">Bots müssen Graph verwenden, um sie abzurufen.</span><span class="sxs-lookup"><span data-stu-id="4d39c-138">Bots must use Graph to retrieve them.</span></span> <span data-ttu-id="4d39c-139">Die `userPrincipalName` eigenschaften werden ab Ende `email` 2022 nicht von der neuen `GetConversationPagedMembers` API zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="4d39c-139">The `userPrincipalName` and `email` properties are not returned from the new `GetConversationPagedMembers` API starting in late 2022.</span></span> <span data-ttu-id="4d39c-140">Bots müssen Graph mit einem Zugriffstoken verwenden, um Informationen abzurufen.</span><span class="sxs-lookup"><span data-stu-id="4d39c-140">Bots have to use Graph with an access token to retrieve information.</span></span> <span data-ttu-id="4d39c-141">Bots müssen das Abrufen eines Zugriffstokens vereinfachen und den Zustimmungsprozess für Endbenutzer optimieren und vereinfachen.</span><span class="sxs-lookup"><span data-stu-id="4d39c-141">It must be made easier for bots to get an access token and streamline and simplify the end-user consent process.</span></span>
