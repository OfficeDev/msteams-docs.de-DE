---
title: Authentifizierungsfluss für Registerkarten
description: Beschreibt den Authentifizierungsfluss in Registerkarten
ms.topic: conceptual
localization_priority: Normal
keywords: Registerkarten für den Authentifizierungsfluss von Teams
ms.openlocfilehash: 012e38b0fa689527999237ccc07b7352fc00ae71
ms.sourcegitcommit: 825abed2f8784d2bab7407ba7a4455ae17bbd28f
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/26/2021
ms.locfileid: "52020394"
---
# <a name="microsoft-teams-authentication-flow-for-tabs"></a><span data-ttu-id="dc23f-104">Microsoft Teams Authentifizierungsfluss für Registerkarten</span><span class="sxs-lookup"><span data-stu-id="dc23f-104">Microsoft Teams authentication flow for tabs</span></span>

> [!NOTE]
> <span data-ttu-id="dc23f-105">Damit die Authentifizierung für Ihre Registerkarte auf mobilen Clients funktioniert, müssen Sie sicherstellen, dass Sie mindestens 1.4.1-Version des Microsoft Teams JavaScript SDK verwenden.</span><span class="sxs-lookup"><span data-stu-id="dc23f-105">For authentication to work for your tab on mobile clients, you must ensure you are using at least 1.4.1 version of the Microsoft Teams JavaScript SDK.</span></span>
> <span data-ttu-id="dc23f-106">Teams SDK startet ein separates Fenster für den Authentifizierungsfluss.</span><span class="sxs-lookup"><span data-stu-id="dc23f-106">Teams SDK launches separate window for authentication flow.</span></span> <span data-ttu-id="dc23f-107">Legen Sie `SameSite` das Attribut auf **Lax .**</span><span class="sxs-lookup"><span data-stu-id="dc23f-107">Set the `SameSite` attribute to **Lax**.</span></span> <span data-ttu-id="dc23f-108">Teams Desktopclient oder ältere Versionen von Chrome oder Safari unterstützen `SameSite` =None nicht.</span><span class="sxs-lookup"><span data-stu-id="dc23f-108">Teams desktop client or older versions of Chrome or Safari do not support `SameSite`=None.</span></span>

<span data-ttu-id="dc23f-109">OAuth 2.0 ist ein offener Standard für Authentifizierung und Autorisierung, der von Azure Active Directory (AAD) und vielen anderen Identitätsanbietern verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="dc23f-109">OAuth 2.0 is an open standard for authentication and authorization used by Azure Active Directory (AAD) and many other identity providers.</span></span> <span data-ttu-id="dc23f-110">Ein grundlegendes Verständnis von OAuth 2.0 ist eine Voraussetzung für die Arbeit mit der Authentifizierung in Teams.</span><span class="sxs-lookup"><span data-stu-id="dc23f-110">A basic understanding of OAuth 2.0 is a prerequisite for working with authentication in Teams.</span></span> <span data-ttu-id="dc23f-111">Weitere Informationen finden Sie unter [OAuth 2 simplified](https://aaronparecki.com/oauth-2-simplified/) that is easier to follow than the [formal specification](https://oauth.net/2/).</span><span class="sxs-lookup"><span data-stu-id="dc23f-111">For more information, see [OAuth 2 simplified](https://aaronparecki.com/oauth-2-simplified/) that is easier to follow than the [formal specification](https://oauth.net/2/).</span></span> <span data-ttu-id="dc23f-112">Der Authentifizierungsfluss für Registerkarten und Bots ist unterschiedlich, da Registerkarten Websites ähneln, sodass sie OAuth 2.0 direkt verwenden können.</span><span class="sxs-lookup"><span data-stu-id="dc23f-112">Authentication flow for tabs and bots are different because tabs are similar to websites so they can use OAuth 2.0 directly.</span></span> <span data-ttu-id="dc23f-113">Bots tun einiges anders, aber die Kernkonzepte sind identisch.</span><span class="sxs-lookup"><span data-stu-id="dc23f-113">Bots do a few things differently, but the core concepts are identical.</span></span>

<span data-ttu-id="dc23f-114">Ein Beispiel für den Authentifizierungsfluss für Registerkarten und Bots mit Node und dem [impliziten OAuth 2.0-Erteilungstyp](https://oauth.net/2/grant-types/implicit/)finden Sie unter [Initiieren](~/tabs/how-to/authentication/auth-tab-aad.md#initiate-authentication-flow)des Authentifizierungsflusses für Registerkarten .</span><span class="sxs-lookup"><span data-stu-id="dc23f-114">For an example of authentication flow for tabs and bots using Node and the [OAuth 2.0 implicit grant type](https://oauth.net/2/grant-types/implicit/), see [initiate authentication flow for tabs](~/tabs/how-to/authentication/auth-tab-aad.md#initiate-authentication-flow).</span></span>

> [!NOTE]
> <span data-ttu-id="dc23f-115">Bevor Sie dem **Benutzer eine Anmeldeschaltfläche** anzeigen und die API als Reaktion auf die Auswahl der Schaltfläche aufrufen, müssen Sie warten, bis die `microsoftTeams.authentication.authenticate` SDK-Initialisierung abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="dc23f-115">Before showing a **Login** button to the user and calling the `microsoftTeams.authentication.authenticate` API in response to selecting the button, you must wait for the SDK initialization to complete.</span></span> <span data-ttu-id="dc23f-116">Sie können einen Rückruf an die API übergeben, die nach `microsoftTeams.initialize` Abschluss der Initialisierung aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="dc23f-116">You can pass a callback to the `microsoftTeams.initialize` API that is called when initialization completes.</span></span>

![Diagramm der Registerkartenauthentifizierungssequenz](~/assets/images/authentication/tab_auth_sequence_diagram.png)

1. <span data-ttu-id="dc23f-118">Der Benutzer interagiert mit dem Inhalt auf der Registerkartenkonfiguration oder Inhaltsseite, in der Regel mit der Schaltfläche Anmelden **oder** **Anmelden.**</span><span class="sxs-lookup"><span data-stu-id="dc23f-118">The user interacts with the content on the tab configuration or content page, commonly a **Sign in** or **Log in** button.</span></span>
2. <span data-ttu-id="dc23f-119">Die Registerkarte erstellt die URL für die Startseite der Authentifizierung.</span><span class="sxs-lookup"><span data-stu-id="dc23f-119">The tab constructs the URL for its auth start page.</span></span> <span data-ttu-id="dc23f-120">Optional werden Informationen von URL-Platzhaltern oder Aufrufen Teams Client SDK-Methode verwendet, um die Authentifizierung für den `microsoftTeams.getContext()` Benutzer zu optimieren.</span><span class="sxs-lookup"><span data-stu-id="dc23f-120">Optionally, it uses information from URL placeholders or calls `microsoftTeams.getContext()` Teams client SDK method to streamline the authentication experience for the user.</span></span> <span data-ttu-id="dc23f-121">Wenn der Parameter beispielsweise bei der Authentifizierung mit AAD auf die E-Mail-Adresse des Benutzers festgelegt ist, muss sich der Benutzer nicht anmelden, wenn er dies kürzlich `login_hint` getan hat.</span><span class="sxs-lookup"><span data-stu-id="dc23f-121">For example, when authenticating with AAD, if the `login_hint` parameter is set to the user's email address, the user does not have to sign in if they have done so recently.</span></span> <span data-ttu-id="dc23f-122">Dies liegt daran, dass AAD die zwischengespeicherten Anmeldeinformationen des Benutzers verwendet.</span><span class="sxs-lookup"><span data-stu-id="dc23f-122">This is because AAD uses the user's cached credentials.</span></span> <span data-ttu-id="dc23f-123">Das Popupfenster wird kurz angezeigt und dann nicht mehr angezeigt.</span><span class="sxs-lookup"><span data-stu-id="dc23f-123">The pop-up window is shown briefly and then disappears.</span></span>
3. <span data-ttu-id="dc23f-124">Auf der Registerkarte wird dann die `microsoftTeams.authentication.authenticate()`-Methode aufgerufen und die `successCallback`- und die `failureCallback`-Funktion registriert.</span><span class="sxs-lookup"><span data-stu-id="dc23f-124">The tab then calls the `microsoftTeams.authentication.authenticate()` method and registers the `successCallback` and `failureCallback` functions.</span></span>
4. <span data-ttu-id="dc23f-125">Teams öffnet die Startseite in einem iframe in einem Popupfenster.</span><span class="sxs-lookup"><span data-stu-id="dc23f-125">Teams opens the start page in an iframe in a pop-up window.</span></span> <span data-ttu-id="dc23f-126">Die Startseite generiert zufällige Daten, speichert sie für die zukünftige Überprüfung und leitet sie an den Endpunkt des Identitätsanbieters um, z. B. `state` `/authorize` für Azure `https://login.microsoftonline.com/<tenant ID>/oauth2/authorize` AD.</span><span class="sxs-lookup"><span data-stu-id="dc23f-126">The start page generates random `state` data, saves it for future validation, and redirects to the identity provider's `/authorize` endpoint, such as `https://login.microsoftonline.com/<tenant ID>/oauth2/authorize` for Azure AD.</span></span> <span data-ttu-id="dc23f-127">Ersetzen `<tenant id>` Sie durch Ihre eigene Mandanten-ID, die context.tid ist.</span><span class="sxs-lookup"><span data-stu-id="dc23f-127">Replace `<tenant id>` with your own tenant id that is context.tid.</span></span>
<span data-ttu-id="dc23f-128">Ähnlich wie bei anderen Anwendungsauthentifizierungsflüssen in Teams muss sich die Startseite in einer Domäne befinden, die sich in der Liste befindet, und in derselben Domäne wie die Umleitungsseite für die `validDomains` Post-Anmeldung.</span><span class="sxs-lookup"><span data-stu-id="dc23f-128">Similar to other application auth flows in Teams, the start page must be on a domain that is in its `validDomains` list, and on the same domain as the post sign in redirect page.</span></span>

    > [!NOTE]
    > <span data-ttu-id="dc23f-129">Der implizite OAuth 2.0-Grant-Fluss ruft einen Parameter in der Authentifizierungsanforderung auf, der eindeutige Sitzungsdaten enthält, um einen standortübergreifenden Anforderungsfälschungsangriff `state` [zu verhindern.](https://en.wikipedia.org/wiki/Cross-site_request_forgery)</span><span class="sxs-lookup"><span data-stu-id="dc23f-129">The OAuth 2.0 implicit grant flow calls for a `state` parameter in the authentication request, which contains unique session data to prevent a [cross-site request forgery attack](https://en.wikipedia.org/wiki/Cross-site_request_forgery).</span></span> <span data-ttu-id="dc23f-130">In den Beispielen wird eine zufällig generierte GUID für die Daten `state` verwendet.</span><span class="sxs-lookup"><span data-stu-id="dc23f-130">The examples use a randomly-generated GUID for the `state` data.</span></span>

5. <span data-ttu-id="dc23f-131">Auf der Website des Anbieters meldet sich der Benutzer an und gewährt Zugriff auf die Registerkarte.</span><span class="sxs-lookup"><span data-stu-id="dc23f-131">On the provider's site, the user signs in and grants access to the tab.</span></span>
6. <span data-ttu-id="dc23f-132">Der Anbieter führt den Benutzer mit einem Zugriffstoken zur OAuth 2.0-Umleitungsseite der Registerkarte.</span><span class="sxs-lookup"><span data-stu-id="dc23f-132">The provider takes the user to the tab's OAuth 2.0 redirect page with an access token.</span></span>
7. <span data-ttu-id="dc23f-133">Die Registerkarte überprüft, ob der zurückgegebene Wert dem entspricht, was zuvor gespeichert wurde, und ruft auf, wodurch wiederum die in Schritt 3 registrierte `state` `microsoftTeams.authentication.notifySuccess()` Funktion `successCallback` aufruft.</span><span class="sxs-lookup"><span data-stu-id="dc23f-133">The tab checks that the returned `state` value matches what was saved earlier, and calls `microsoftTeams.authentication.notifySuccess()`, which in turn calls the `successCallback` function registered in step 3.</span></span>
8. <span data-ttu-id="dc23f-134">Teams wird das Popupfenster geschlossen.</span><span class="sxs-lookup"><span data-stu-id="dc23f-134">Teams closes the pop-up window.</span></span>
9. <span data-ttu-id="dc23f-135">Auf der Registerkarte wird entweder die Konfigurationsbenutzeroberfläche angezeigt, der Inhalt der Registerkarten wird aktualisiert oder neu geladen, je nachdem, wo der Benutzer angefangen hat.</span><span class="sxs-lookup"><span data-stu-id="dc23f-135">The tab either displays configuration UI, refreshes, or reloads the tabs content, depending on where the user started from.</span></span>

## <a name="treat-tab-context-as-hints"></a><span data-ttu-id="dc23f-136">Behandeln des Registerkartenkontexts als Hinweise</span><span class="sxs-lookup"><span data-stu-id="dc23f-136">Treat tab context as hints</span></span>

<span data-ttu-id="dc23f-137">Obwohl der Registerkartenkontext hilfreiche Informationen zum Benutzer enthält, verwenden Sie diese Informationen nicht, um den Benutzer zu authentifizieren.</span><span class="sxs-lookup"><span data-stu-id="dc23f-137">Although the tab context provides helpful information regarding the user, do not use this information to authenticate the user.</span></span> <span data-ttu-id="dc23f-138">Authentifizieren Sie den Benutzer auch dann, wenn Sie die Informationen als URL-Parameter zu Ihrer Registerkarteninhalts-URL oder durch Aufrufen der Funktion `microsoftTeams.getContext()` im Microsoft Teams-Client-SDK erhalten.</span><span class="sxs-lookup"><span data-stu-id="dc23f-138">Do authenticate the user even if you get the information as URL parameters to your tab content URL or by calling the `microsoftTeams.getContext()` function in the Microsoft Teams client SDK.</span></span> <span data-ttu-id="dc23f-139">Ein böswilliger Akteur kann ihre Registerkarteninhalts-URL mit eigenen Parametern aufrufen.</span><span class="sxs-lookup"><span data-stu-id="dc23f-139">A malicious actor can invoke your tab content URL with its own parameters.</span></span> <span data-ttu-id="dc23f-140">Der Akteur kann auch eine Webseite aufrufen, die die Identität Microsoft Teams, um die Registerkarteninhalts-URL in einem iframe zu laden und eigene Daten an die Funktion `getContext()` zurückzukehren.</span><span class="sxs-lookup"><span data-stu-id="dc23f-140">The actor can also invoke a web page impersonating Microsoft Teams to load your tab content URL in an iframe and return its own data to the `getContext()` function.</span></span> <span data-ttu-id="dc23f-141">Sie müssen die identitätsbezogenen Informationen im Registerkartenkontext einfach als Hinweise behandeln und vor der Verwendung überprüfen.</span><span class="sxs-lookup"><span data-stu-id="dc23f-141">You must treat the identity-related information in the tab context simply as hints and validate them before use.</span></span> <span data-ttu-id="dc23f-142">Verweisen Sie auf die Notizen im [Navigieren zur Autorisierungsseite von Ihrer Popupseite](~/tabs/how-to/authentication/auth-tab-aad.md#navigate-to-the-authorization-page-from-your-popup-page).</span><span class="sxs-lookup"><span data-stu-id="dc23f-142">Refer to the notes in [navigate to the authorization page from your pop-up page](~/tabs/how-to/authentication/auth-tab-aad.md#navigate-to-the-authorization-page-from-your-popup-page).</span></span>

## <a name="code-sample"></a><span data-ttu-id="dc23f-143">Codebeispiel</span><span class="sxs-lookup"><span data-stu-id="dc23f-143">Code sample</span></span>

<span data-ttu-id="dc23f-144">Beispielcode, der den Tabauthentifizierungsprozess zeigt.</span><span class="sxs-lookup"><span data-stu-id="dc23f-144">Sample code showing the tab authentication process.</span></span>

| <span data-ttu-id="dc23f-145">**Beispielname**</span><span class="sxs-lookup"><span data-stu-id="dc23f-145">**Sample name**</span></span> | <span data-ttu-id="dc23f-146">**Beschreibung**</span><span class="sxs-lookup"><span data-stu-id="dc23f-146">**Description**</span></span> | <span data-ttu-id="dc23f-147">**C#**</span><span class="sxs-lookup"><span data-stu-id="dc23f-147">**C#**</span></span> | <span data-ttu-id="dc23f-148">**Node.js**</span><span class="sxs-lookup"><span data-stu-id="dc23f-148">**Node.js**</span></span> |
|-----------------|-----------------|-------------|------------|
| <span data-ttu-id="dc23f-149">Teams der Registerkartenauthentifizierung</span><span class="sxs-lookup"><span data-stu-id="dc23f-149">Teams tab authentication</span></span> | <span data-ttu-id="dc23f-150">Authentifizierungsprozess für Registerkarten mit AAD.</span><span class="sxs-lookup"><span data-stu-id="dc23f-150">Authentication process for tabs using AAD.</span></span> | [<span data-ttu-id="dc23f-151">View</span><span class="sxs-lookup"><span data-stu-id="dc23f-151">View</span></span>](https://github.com/OfficeDev/Microsoft-Teams-Samples/tree/main/samples/app-complete-sample/csharp) | [<span data-ttu-id="dc23f-152">View</span><span class="sxs-lookup"><span data-stu-id="dc23f-152">View</span></span>](https://github.com/OfficeDev/Microsoft-Teams-Samples/tree/main/samples/app-complete-sample/nodejs) |

## <a name="more-details"></a><span data-ttu-id="dc23f-153">Weitere Details</span><span class="sxs-lookup"><span data-stu-id="dc23f-153">More details</span></span>

<span data-ttu-id="dc23f-154">Eine detaillierte Implementierung für die Registerkartenauthentifizierung mit AAD finden Sie unter:</span><span class="sxs-lookup"><span data-stu-id="dc23f-154">For a detailed implementation for tab authentication using AAD, see:</span></span>

* [<span data-ttu-id="dc23f-155">Authentifizieren eines Benutzers auf einer Teams Registerkarte</span><span class="sxs-lookup"><span data-stu-id="dc23f-155">Authenticate a user in a Teams tab</span></span>](~/tabs/how-to/authentication/auth-tab-AAD.md)
* [<span data-ttu-id="dc23f-156">Automatische Authentifizierung</span><span class="sxs-lookup"><span data-stu-id="dc23f-156">Silent authentication</span></span>](~/tabs/how-to/authentication/auth-silent-AAD.md)
