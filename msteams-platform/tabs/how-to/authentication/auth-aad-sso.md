---
title: Einmaliges Anmelden
description: Beschreibt einmaliges Anmelden (Single Sign-on, SSO)
keywords: Teams-Authentifizierung SSO-Aad
ms.openlocfilehash: 1857651aecd902f04bd57f5b4e2fb0fda88eb348
ms.sourcegitcommit: 4329a94918263c85d6c65ff401f571556b80307b
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 02/01/2020
ms.locfileid: "41674092"
---
# <a name="single-sign-on"></a><span data-ttu-id="1c308-104">Einmaliges Anmelden</span><span class="sxs-lookup"><span data-stu-id="1c308-104">Single Sign-On</span></span>

> [!NOTE]
> <span data-ttu-id="1c308-105">Die API für einmaliges Anmelden wird derzeit nur in der _Entwicklervorschau_ unterstützt.</span><span class="sxs-lookup"><span data-stu-id="1c308-105">The "single sign-on" API is currently supported in _Developer Preview_ only.</span></span>

<span data-ttu-id="1c308-106">Benutzer melden sich bei Microsoft Teams mit Ihrem Schulkonto (Office 365) an, und Sie können dies mithilfe von Single Sign-on (SSO) nutzen, um den Benutzer auf Ihrer Microsoft Teams-Registerkarte zu autorisieren. Das heißt, wenn ein Benutzer einwilligt, die APP auf dem Desktop zu verwenden, muss er sich nicht erneut auf dem Handy anmelden und wird automatisch angemeldet.</span><span class="sxs-lookup"><span data-stu-id="1c308-106">Users sign-in to Microsoft Teams using their work or school (Office 365) account and you can take advantage of this by using single sign-on (SSO) to authorize the user to your Microsoft Teams tab. That means if a user consents to use your app on desktop, they won’t have to consent again on mobile and will be automatically logged in.</span></span> 

## <a name="how-sso-works-at-runtime"></a><span data-ttu-id="1c308-107">Funktionsweise von SSO zur Laufzeit</span><span class="sxs-lookup"><span data-stu-id="1c308-107">How SSO works at runtime</span></span>

<span data-ttu-id="1c308-108">Das folgende Diagramm zeigt die Funktionsweise des SSO-Prozesses:</span><span class="sxs-lookup"><span data-stu-id="1c308-108">The following diagram shows how the SSO process works:</span></span>

<img src="~/assets/images/tabs/tabs-sso-diagram.png" alt="Tab single sign-on SSO diagram" width="75%"/>

1. <span data-ttu-id="1c308-109">In der Registerkarte ruft JavaScript getAuthToken () auf.</span><span class="sxs-lookup"><span data-stu-id="1c308-109">In the tab, JavaScript calls getAuthToken().</span></span> <span data-ttu-id="1c308-110">Dadurch wird die Teams-Anwendung aufgefordert, ein Authentifizierungstoken für die Registerkarten Anwendung abzurufen.</span><span class="sxs-lookup"><span data-stu-id="1c308-110">This tells the Teams application to obtain an authentication token to the tab application.</span></span>
2. <span data-ttu-id="1c308-111">Wenn der aktuelle Benutzer die Tab-Anwendung zum ersten Mal verwendet hat, wird er zur Zustimmung aufgefordert (falls eine Zustimmung erforderlich ist) oder aufgefordert, die Step-up-Authentifizierung zu behandeln (beispielsweise die zweistufige Authentifizierung).</span><span class="sxs-lookup"><span data-stu-id="1c308-111">If this is the first time the current user has used your tab application, they will be prompted to consent (if consent is required) or asked to handle step-up authentication (such as two-factor authentication).</span></span>
3. <span data-ttu-id="1c308-112">Die Microsoft Teams-Anwendung fordert das Registerkarten-Anwendungs Token vom Azure AD v 1.0-Endpunkt für den aktuellen Benutzer an.</span><span class="sxs-lookup"><span data-stu-id="1c308-112">The Microsoft Teams application requests the tab application token from the Azure AD v1.0 endpoint for the current user.</span></span>
4. <span data-ttu-id="1c308-113">Azure AD sendet das Registerkarten-Anwendungs Token an die Teams-Anwendung.</span><span class="sxs-lookup"><span data-stu-id="1c308-113">Azure AD sends the tab application token to the Teams application.</span></span>
5. <span data-ttu-id="1c308-114">Die Microsoft Teams-Anwendung sendet das Registerkarten-Anwendungs Token als Teil des result-Objekts, das vom Aufruf von getAuthToken () zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="1c308-114">The Microsoft Teams application sends the tab application token to the tab as part of the result object returned by the getAuthToken() call.</span></span>
6. <span data-ttu-id="1c308-115">JavaScript in der Registerkarten Anwendung kann das Token analysieren und die benötigten Informationen extrahieren, beispielsweise die e-Mail-Adresse des Benutzers.</span><span class="sxs-lookup"><span data-stu-id="1c308-115">JavaScript in the tab application can parse the token and extract the information it needs, such as the user's email address.</span></span>
    * <span data-ttu-id="1c308-116">Hinweis: dieses Token gilt nur für Zustimmung zu einer begrenzten Gruppe von APIs auf Benutzerebene (ex: e-Mail, Profil usw.) und nicht für weitere Diagrammbereiche (beispielsweise "Mail. Read").</span><span class="sxs-lookup"><span data-stu-id="1c308-116">Note: this token is only valid for consenting to a limited set of user-level APIs (ex: email, profile, etc)  and not for further Graph scopes (such as Mail.Read).</span></span> <span data-ttu-id="1c308-117">In unserem Abschnitt am Ende dieses Dokuments finden Sie Empfohlene Problemumgehungen, wenn Sie zusätzliche Diagrammbereiche benötigen.</span><span class="sxs-lookup"><span data-stu-id="1c308-117">See our section at the end of this document for suggested workarounds if you require additional Graph scopes.</span></span>

## <a name="develop-an-sso-microsoft-teams-tab"></a><span data-ttu-id="1c308-118">Entwickeln einer SSO-Microsoft Teams-Registerkarte</span><span class="sxs-lookup"><span data-stu-id="1c308-118">Develop an SSO Microsoft Teams tab</span></span>

<span data-ttu-id="1c308-119">In diesem Abschnitt werden die Aufgaben im Zusammenhang mit dem Erstellen einer Microsoft Teams-Registerkarte beschrieben, die SSO verwendet.</span><span class="sxs-lookup"><span data-stu-id="1c308-119">This section describes the tasks involved in creating an Microsoft Teams tab that use SSO.</span></span> <span data-ttu-id="1c308-120">Diese Aufgaben werden hier auf eine von Sprache und Framework unabhängige Weise beschrieben.</span><span class="sxs-lookup"><span data-stu-id="1c308-120">These tasks are described here in a language- and framework-agnostic way.</span></span>

### <a name="1-create-your-aad-application-in-azure"></a><span data-ttu-id="1c308-121">1. Erstellen der Aad-Anwendung in Azure</span><span class="sxs-lookup"><span data-stu-id="1c308-121">1. Create your AAD application in Azure</span></span>

<span data-ttu-id="1c308-122">Registrieren Sie Ihre Anwendung im Registrierungs Portal für den Azure AD v 1.0-Endpunkt.</span><span class="sxs-lookup"><span data-stu-id="1c308-122">Register you application at the registration portal for the Azure AD v1.0 endpoint.</span></span> <span data-ttu-id="1c308-123">Dieser Prozess dauert fünf bis zehn Minuten und umfasst die folgenden Aufgaben:</span><span class="sxs-lookup"><span data-stu-id="1c308-123">This is a 5–10 minute process that includes the following tasks:</span></span>

* <span data-ttu-id="1c308-124">Aad-Anwendungs-ID wird abgerufen</span><span class="sxs-lookup"><span data-stu-id="1c308-124">Getting your AAD application ID</span></span>
* <span data-ttu-id="1c308-125">Geben Sie die Berechtigungen an, die Ihre Anwendung für den Aad-Endpunkt (und optional für Microsoft Graph) benötigt.</span><span class="sxs-lookup"><span data-stu-id="1c308-125">Specify the permissions that your application needs for the AAD endpoint (and optionally to Microsoft Graph).</span></span> 
* <span data-ttu-id="1c308-126">Gewähren Sie der Microsoft Teams-Desktop-,-Webanwendung und der mobilen Anwendung eine Vertrauensstellung für Ihre Anwendung.</span><span class="sxs-lookup"><span data-stu-id="1c308-126">Grant the Microsoft Teams desktop, web and mobile application to trust to your application</span></span>
* <span data-ttu-id="1c308-127">Vorautorisieren der Microsoft Teams-Anwendung für Ihre APP mit dem Standardbereichs Namen `access_as_user`von.</span><span class="sxs-lookup"><span data-stu-id="1c308-127">Preauthorize the Microsoft Teams application to your app with the default scope name of `access_as_user`.</span></span>

> [!NOTE]
> <span data-ttu-id="1c308-128">Es gibt einige wichtige Einschränkungen, die Sie beachten sollten:</span><span class="sxs-lookup"><span data-stu-id="1c308-128">There are some important restrictions you should be aware of:</span></span>
>
> * <span data-ttu-id="1c308-129">Wir unterstützen nur Graph-API-Berechtigungen auf Benutzerebene (IE: e-Mail, Profil, offline_access, OpenID.</span><span class="sxs-lookup"><span data-stu-id="1c308-129">We only support user-level Graph API permissions (ie: email, profile, offline_access, openid.</span></span> <span data-ttu-id="1c308-130">Wenn Sie Zugriff auf andere Diagrammbereiche benötigen, lesen Sie unsere empfohlene Problemumgehung am Ende dieser Dokumentation.</span><span class="sxs-lookup"><span data-stu-id="1c308-130">If you need access to other Graph scopes, read our recommended workaround at the end of this documentation.</span></span>
> * <span data-ttu-id="1c308-131">Es ist wichtig, dass der Domänenname Ihrer Anwendung bei ihrer Azure AD Anwendung registriert wird.</span><span class="sxs-lookup"><span data-stu-id="1c308-131">It's important that your application's domain name be registered with your Azure AD application.</span></span> <span data-ttu-id="1c308-132">Dabei muss es sich um den Domänennamen handeln, auf dem die Anwendung ausgeführt wird, wenn ein Authentifizierungstoken in Microsoft Teams angefordert wird, und auch, wenn die Resource-Eigenschaft in Ihrem Teams-Manifest angegeben wird (weitere Details im nächsten Abschnitt).</span><span class="sxs-lookup"><span data-stu-id="1c308-132">This must be the same domain name that your application runs on when requesting an authentication token in Teams and also when specifying the resource property in your Teams manifest (more details in the next section).</span></span>
> * <span data-ttu-id="1c308-133">Wir unterstützen derzeit nicht mehrere Domänen pro app.</span><span class="sxs-lookup"><span data-stu-id="1c308-133">We do not currently support multiple domains per app</span></span>
> * <span data-ttu-id="1c308-134">Wir unterstützen auch keine Anwendungen, die die `azurewebsites.net` Domäne verwenden, da diese Domäne zu häufig ist und möglicherweise ein Sicherheitsrisiko darstellt.</span><span class="sxs-lookup"><span data-stu-id="1c308-134">We also do not support applications that use the `azurewebsites.net` domain since this domain is too common and may be a security risk</span></span>

#### <a name="steps"></a><span data-ttu-id="1c308-135">Schritte</span><span class="sxs-lookup"><span data-stu-id="1c308-135">Steps</span></span>

1. <span data-ttu-id="1c308-136">Registrieren einer neuen Anwendung im [Azure Active Directory – App-Registrierungs](https://go.microsoft.com/fwlink/?linkid=2083908) Portal</span><span class="sxs-lookup"><span data-stu-id="1c308-136">Register a new application in the [Azure Active Directory – App Registration](https://go.microsoft.com/fwlink/?linkid=2083908) portal</span></span>
2. <span data-ttu-id="1c308-137">Wählen Sie "neue Registrierung" aus.</span><span class="sxs-lookup"><span data-stu-id="1c308-137">Select “New Registration”.</span></span> <span data-ttu-id="1c308-138">Legen Sie auf der Seite Anwendung registrieren die folgenden Werte fest:</span><span class="sxs-lookup"><span data-stu-id="1c308-138">On the register an application page, set the values as follows:</span></span>
    * <span data-ttu-id="1c308-139">**Name** auf Ihren APP-Namen festlegen</span><span class="sxs-lookup"><span data-stu-id="1c308-139">Set **name** to your app name</span></span>
    * <span data-ttu-id="1c308-140">Festlegen **unterstützter Kontotypen** auf **Konten in einem Organisations Verzeichnis und persönlichen Microsoft-Konten**</span><span class="sxs-lookup"><span data-stu-id="1c308-140">Set **supported account types** to **Accounts in any organizational directory and personal Microsoft accounts**</span></span>
    * <span data-ttu-id="1c308-141">Lassen Sie die **Umleitungs-URI** leer.</span><span class="sxs-lookup"><span data-stu-id="1c308-141">Leave **Redirect URI** empty</span></span>
    * <span data-ttu-id="1c308-142">Wählen Sie **registrieren** aus.</span><span class="sxs-lookup"><span data-stu-id="1c308-142">Choose **Register**</span></span>
3. <span data-ttu-id="1c308-143">Kopieren und speichern Sie auf der Übersichtsseite die **Anwendungs-ID (Client)**.</span><span class="sxs-lookup"><span data-stu-id="1c308-143">On the overview page, copy and save the **Application (client) ID**.</span></span> <span data-ttu-id="1c308-144">Sie benötigen Sie später beim Aktualisieren des Teams-Anwendungsmanifests.</span><span class="sxs-lookup"><span data-stu-id="1c308-144">You’ll need it later when updating your Teams application manifest.</span></span>
4. <span data-ttu-id="1c308-145">Wählen Sie unter **Verwalten** die Option **Eine API verfügbar machen** aus.</span><span class="sxs-lookup"><span data-stu-id="1c308-145">Select **Expose an API** under **Manage**.</span></span> <span data-ttu-id="1c308-146">Wählen Sie den Link **festlegen** aus, um den Anwendungs-ID-URI `api://{AppID}`in Form von zu generieren.</span><span class="sxs-lookup"><span data-stu-id="1c308-146">Select the **Set** link to generate the Application ID URI in the form of `api://{AppID}`.</span></span> <span data-ttu-id="1c308-147">Fügen Sie den vollqualifizierten Domänennamen zwischen den doppelten Schrägstrichen und der GUID (mit einem Schrägstrich "/" am Ende hinzugefügt) ein.</span><span class="sxs-lookup"><span data-stu-id="1c308-147">Insert your fully qualified domain name (with a forward slash "/" appended to the end) between the double forward slashes and the GUID.</span></span> <span data-ttu-id="1c308-148">Die gesamte ID sollte folgende Form haben:`api://fully-qualified-domain-name.com/{AppID}`</span><span class="sxs-lookup"><span data-stu-id="1c308-148">The entire ID should have the form of: `api://fully-qualified-domain-name.com/{AppID}`</span></span>
    * <span data-ttu-id="1c308-149">Ex: `api://subdomain.example.com:6789/c6c1f32b-5e55-4997-881a-753cc1d563b7`.</span><span class="sxs-lookup"><span data-stu-id="1c308-149">ex: `api://subdomain.example.com:6789/c6c1f32b-5e55-4997-881a-753cc1d563b7`.</span></span>

> [!NOTE]
> <span data-ttu-id="1c308-150">Wenn eine Fehlermeldung angezeigt wird, die besagt, dass die Domäne bereits beansprucht wird, Sie jedoch der Eigentümer sind, folgen Sie dem Verfahren unter [Schnellstart: Hinzufügen eines benutzerdefinierten Domänennamens zu Azure Active Directory](/azure/active-directory/fundamentals/add-custom-domain), um sie zu registrieren. Wiederholen Sie dann den Vorgang.</span><span class="sxs-lookup"><span data-stu-id="1c308-150">If you get an error saying that the domain is already owned but you own it, follow the procedure at [Quickstart: Add a custom domain name to Azure Active Directory](/azure/active-directory/fundamentals/add-custom-domain) to register it, and then repeat this step.</span></span> <span data-ttu-id="1c308-151">(Dieser Fehler kann auch auftreten, wenn Sie nicht mit den Anmeldeinformationen eines Administrators im Office 365 Mandanten angemeldet sind).</span><span class="sxs-lookup"><span data-stu-id="1c308-151">(This error can also occur if you are not signed in with credentials of an admin in the Office 365 tenancy).</span></span>

5. <span data-ttu-id="1c308-152">Wählen Sie die Schaltfläche**Bereich hinzufügen** aus.</span><span class="sxs-lookup"><span data-stu-id="1c308-152">Select the **Add a scope** button.</span></span> <span data-ttu-id="1c308-153">Geben Sie im Bereich, der geöffnet wird, `access_as_user` für**Bereichsname** ein.</span><span class="sxs-lookup"><span data-stu-id="1c308-153">In the panel that opens, enter `access_as_user` as the **Scope name**.</span></span>
6. <span data-ttu-id="1c308-154">Festlegen, wer einwilligen kann? an Administratoren und Benutzer</span><span class="sxs-lookup"><span data-stu-id="1c308-154">Set Who can consent? to Admins and users</span></span>
7. <span data-ttu-id="1c308-155">Füllen Sie die Felder für die Konfiguration der Administrator-und Benutzer Zustimmungs Ansagen mit Werten aus `access_as_user` , die für den Bereich geeignet sind.</span><span class="sxs-lookup"><span data-stu-id="1c308-155">Fill in the fields for configuring the admin and user consent prompts with values that are appropriate for the `access_as_user` scope.</span></span> <span data-ttu-id="1c308-156">Vorschläge:</span><span class="sxs-lookup"><span data-stu-id="1c308-156">Suggestions:</span></span>
    * <span data-ttu-id="1c308-157">**Titel der Administrator Zustimmung:** Teams können auf das Profil des Benutzers zugreifen</span><span class="sxs-lookup"><span data-stu-id="1c308-157">**Admin consent title:** Teams can access the user’s profile</span></span>
    * <span data-ttu-id="1c308-158">**Administrator-Zustimmungs Beschreibung**: ermöglicht Teams das Aufrufen der webapin der App als aktueller Benutzer.</span><span class="sxs-lookup"><span data-stu-id="1c308-158">**Admin consent description**: Allows Teams to call the app’s web APIs as the current user.</span></span>
    * <span data-ttu-id="1c308-159">**Benutzer Zustimmungs Titel**: Teams können auf Ihr Benutzerprofil zugreifen und in Ihrem Namen Anfragen stellen</span><span class="sxs-lookup"><span data-stu-id="1c308-159">**User consent title**: Teams can access your user profile and make requests on your behalf</span></span>
    * <span data-ttu-id="1c308-160">**Beschreibung der Benutzer Zustimmung:** Aktivieren von Teams zum Aufrufen der APIs dieser APP mit den gleichen Rechten</span><span class="sxs-lookup"><span data-stu-id="1c308-160">**User consent description:** Enable Teams to call this app’s APIs with the same rights that you have</span></span>
8. <span data-ttu-id="1c308-161">Sicherstellen, dass der **Status** auf " **aktiviert** " festgelegt ist</span><span class="sxs-lookup"><span data-stu-id="1c308-161">Ensure that **State** is set to **Enabled**</span></span>
9. <span data-ttu-id="1c308-162">**Bereich "hinzufügen** " auswählen</span><span class="sxs-lookup"><span data-stu-id="1c308-162">Select **Add scope**</span></span>
    * <span data-ttu-id="1c308-163">Hinweis: der Domänenteil des **Bereichsnamens** , der direkt unterhalb des Textfelds angezeigt wird, sollte automatisch mit dem im vorherigen Schritt festgelegten **Anwendungs-ID** -URI übereinstimmen, wobei `/access_as_user` der Wert am Ende angefügt ist. Zum Beispiel:</span><span class="sxs-lookup"><span data-stu-id="1c308-163">Note: The domain part of the **Scope name** displayed just below the text field should automatically match the **Application ID** URI set in the previous step, with `/access_as_user` appended to the end; for example:</span></span> 
        * `api://subdomain.example.com:6789/c6c1f32b-5e55-4997-881a-753cc1d563b7/access_as_user`
10. <span data-ttu-id="1c308-164">Im Abschnitt **autorisierte Clientanwendungen** identifizieren Sie die Anwendungen, die Sie für die Webanwendung Ihrer APP autorisieren möchten.</span><span class="sxs-lookup"><span data-stu-id="1c308-164">In the **Authorized client applications** section, you identify the applications that you want to authorize to your app’s web application.</span></span> <span data-ttu-id="1c308-165">Jeder der folgenden IDs muss eingegeben werden:</span><span class="sxs-lookup"><span data-stu-id="1c308-165">Each of the following IDs needs to be entered:</span></span>
    * <span data-ttu-id="1c308-166">`1fec8e78-bce4-4aaf-ab1b-5451cc387264`(Mobile Teams/Desktopanwendung)</span><span class="sxs-lookup"><span data-stu-id="1c308-166">`1fec8e78-bce4-4aaf-ab1b-5451cc387264` (Teams mobile/desktop application)</span></span>
    * <span data-ttu-id="1c308-167">`5e3ce6c0-2b1f-4285-8d4b-75ee78787346`(Microsoft Teams-Webanwendung)</span><span class="sxs-lookup"><span data-stu-id="1c308-167">`5e3ce6c0-2b1f-4285-8d4b-75ee78787346` (Teams web application)</span></span>
11. <span data-ttu-id="1c308-168">Navigieren Sie zu **API-Berechtigungen**, und stellen Sie sicher, dass Sie die folgenden Berechtigungen hinzufügen:</span><span class="sxs-lookup"><span data-stu-id="1c308-168">Navigate to **API Permissions**, and make sure to add the follow permissions:</span></span>
    * <span data-ttu-id="1c308-169">User. Read (standardmäßig aktiviert)</span><span class="sxs-lookup"><span data-stu-id="1c308-169">User.Read (enabled by default)</span></span>
    * <span data-ttu-id="1c308-170">email</span><span class="sxs-lookup"><span data-stu-id="1c308-170">email</span></span>
    * <span data-ttu-id="1c308-171">offline_access</span><span class="sxs-lookup"><span data-stu-id="1c308-171">offline_access</span></span>
    * <span data-ttu-id="1c308-172">openid</span><span class="sxs-lookup"><span data-stu-id="1c308-172">openid</span></span>
    * <span data-ttu-id="1c308-173">profile</span><span class="sxs-lookup"><span data-stu-id="1c308-173">profile</span></span>

### <a name="2-update-your-microsoft-teams-application-manifest"></a><span data-ttu-id="1c308-174">2. Aktualisieren des Microsoft Teams-Anwendungsmanifests</span><span class="sxs-lookup"><span data-stu-id="1c308-174">2. Update your Microsoft Teams application manifest</span></span>

<span data-ttu-id="1c308-175">Fügen Sie Ihrem Microsoft Teams-Manifest neue Eigenschaften hinzu:</span><span class="sxs-lookup"><span data-stu-id="1c308-175">Add new properties to your Microsoft Teams manifest:</span></span>

* <span data-ttu-id="1c308-176">**WebApplicationInfo**: Das übergeordnete Element der folgenden Elemente.</span><span class="sxs-lookup"><span data-stu-id="1c308-176">**WebApplicationInfo** - The parent of the following elements.</span></span>
* <span data-ttu-id="1c308-177">**ID** – die Client-ID der Anwendung.</span><span class="sxs-lookup"><span data-stu-id="1c308-177">**Id** - The client ID of the application.</span></span> <span data-ttu-id="1c308-178">Hierbei handelt es sich um eine Anwendungs-ID, die Sie im Rahmen der Registrierung der Anwendung mit Azure AD 1,0-Endpunkt erhalten.</span><span class="sxs-lookup"><span data-stu-id="1c308-178">This is an application ID that you obtain as part of registering the application with Azure AD 1.0 endpoint.</span></span>
* <span data-ttu-id="1c308-179">**Resource** – die Domäne und Unterdomäne Ihrer Anwendung.</span><span class="sxs-lookup"><span data-stu-id="1c308-179">**Resource** - The domain and subdomain of your application.</span></span> <span data-ttu-id="1c308-180">Hierbei handelt es sich um den gleichen URI `api://` (einschließlich des Protokolls), den Sie bei der Registrierung der app in Aad verwendet haben.</span><span class="sxs-lookup"><span data-stu-id="1c308-180">This is the same URI (including the `api://` protocol) that you used when registering the app in AAD.</span></span> <span data-ttu-id="1c308-181">Der Domänenteil dieses URIs sollte der Domäne entsprechen, einschließlich aller Unterdomänen, die in den URLs im Abschnitt Ihres Teams-Anwendungsmanifests verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="1c308-181">The domain part of this URI should match the domain, including any subdomains, used in the URLs in the section of your Teams application manifest.</span></span>

```json
"webApplicationInfo": {
  "id": "<application_GUID here>",
  "resource": "<web_API resource here>"
}
```

<span data-ttu-id="1c308-182">Hinweise:</span><span class="sxs-lookup"><span data-stu-id="1c308-182">Notes:</span></span>

* <span data-ttu-id="1c308-183">Die Ressource für eine Aad-APP ist in der Regel nur der Stamm der Website-URL und der Anwendungs- `api://subdomain.example.com/6789/c6c1f32b-5e55-4997-881a-753cc1d563b7`ID (beispielsweise).</span><span class="sxs-lookup"><span data-stu-id="1c308-183">The resource for an AAD app will usually just be the root of its site URL and the appID (e.g. `api://subdomain.example.com/6789/c6c1f32b-5e55-4997-881a-753cc1d563b7`).</span></span> <span data-ttu-id="1c308-184">Dieser Wert wird auch verwendet, um sicherzustellen, dass Ihre Anforderung aus derselben Domäne stammt.</span><span class="sxs-lookup"><span data-stu-id="1c308-184">We also use this value to ensure your request is coming from the same domain.</span></span> <span data-ttu-id="1c308-185">Vergewissern Sie sich daher, `contentURL` dass für Ihre Registerkarte die gleichen Domänen wie für Ihre Ressourceneigenschaft verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="1c308-185">Therefor make sure that your `contentURL` for your tab uses the same domains as your resource property.</span></span>
* <span data-ttu-id="1c308-186">Sie müssen manifestVersion Version 1,5 oder höher verwenden, damit diese Felder verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="1c308-186">You need to be using manifest version 1.5 or higher for these fields to be used.</span></span>
* <span data-ttu-id="1c308-187">Bereiche werden im Manifest nicht unterstützt und sollten stattdessen im Abschnitt API-Berechtigungen im Azure-Portal angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="1c308-187">Scopes aren’t supported in the manifest and instead should be specified in the API Permissions section in the Azure portal</span></span>

### <a name="3-get-an-authentication-token-from-your-client-side-code"></a><span data-ttu-id="1c308-188">3. Abrufen eines Authentifizierungstokens von Ihrem clientseitigen Code</span><span class="sxs-lookup"><span data-stu-id="1c308-188">3. Get an authentication token from your client-side code</span></span>

<span data-ttu-id="1c308-189">Hier sehen Sie, wie die Authentifizierungs-API aussieht:</span><span class="sxs-lookup"><span data-stu-id="1c308-189">Here's what the authentication API looks like:</span></span>

```javascript
var authTokenRequest = {
  successCallback: function(result) { console.log("Success: " + result); },
  failureCallback: function(error) { console.log("Failure: " + error); },
};
microsoftTeams.authentication.getAuthToken(authTokenRequest);
```

<span data-ttu-id="1c308-190">Wenn Sie anrufen `getAuthToken` und zusätzliche Benutzer Zustimmung erforderlich ist (für Berechtigungen auf Benutzerebene), wird dem Benutzer ein Dialogfeld angezeigt, in dem Sie ermutigt werden, zusätzliche Zustimmung zu gewähren.</span><span class="sxs-lookup"><span data-stu-id="1c308-190">When you call `getAuthToken` - and additional user consent is required (for user-level permissions) - we will show a dialog to the user encouraging them to grant additional consent.</span></span> 

<img src="~/assets/images/tabs/tabs-sso-prompt.png" alt="Tab single sign-on SSO dialog prompt" width="75%"/>

## <a name="demo-code"></a><span data-ttu-id="1c308-191">Demo Code</span><span class="sxs-lookup"><span data-stu-id="1c308-191">Demo code</span></span>

<span data-ttu-id="1c308-192">Jetzt können Sie unsere Test Anwendungs [Aufgabe Meow](https://github.com/ydogandjiev/taskmeow) besuchen und das SSO-Manifest und das `teams.auth.service.js` Auschecken `sso.auth.service.js` der und-Datei verwenden, um zu sehen, wie der Authentifizierungs Workflow behandelt wird.</span><span class="sxs-lookup"><span data-stu-id="1c308-192">For now you can visit our test application [Task Meow](https://github.com/ydogandjiev/taskmeow) and use the SSO manifest and checkout the `teams.auth.service.js` and `sso.auth.service.js` file to see how we handle the authentication workflow.</span></span>

## <a name="known-limitations"></a><span data-ttu-id="1c308-193">Bekannte Einschränkungen</span><span class="sxs-lookup"><span data-stu-id="1c308-193">Known Limitations</span></span>

### <a name="apps-that-require-additional-graph-scopes"></a><span data-ttu-id="1c308-194">Apps, die zusätzliche Diagrammbereiche erfordern</span><span class="sxs-lookup"><span data-stu-id="1c308-194">Apps that require additional Graph Scopes</span></span>

<span data-ttu-id="1c308-195">Unsere aktuelle Implementierung für SSO erteilt nur Zustimmung für Berechtigungen auf Benutzerebene (e-Mail, Profil, offline_access, OpenID), jedoch nicht für andere APIs (wie "Mail. Read").</span><span class="sxs-lookup"><span data-stu-id="1c308-195">Our current implementation for SSO only grants consent for user-level permissions (email, profile, offline_access, openid) but not for other APIs (such as Mail.Read).</span></span> <span data-ttu-id="1c308-196">Wenn Ihre APP weitere Diagrammbereiche benötigt, gibt es einige Problemumgehungen, um dies zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="1c308-196">If your app needs further Graph scopes, there are some workarounds to enable this.</span></span>

#### <a name="tenant-admin-consent"></a><span data-ttu-id="1c308-197">Zustimmung des Mandanten Administrators</span><span class="sxs-lookup"><span data-stu-id="1c308-197">Tenant Admin Consent</span></span>

<span data-ttu-id="1c308-198">Der einfachste Ansatz wäre, einen mandantenadministrator zur Vorabgenehmigung im Namen der Organisation zu verschaffen.</span><span class="sxs-lookup"><span data-stu-id="1c308-198">The simplest approach would be to get a tenant admin to pre-consent on behalf of the organization.</span></span> <span data-ttu-id="1c308-199">Dies bedeutet, dass Benutzer diesen Bereichen nicht zustimmen müssen und Sie dann frei sein können, die tokenserver-Seite mithilfe des Aad [im Auftrag von Flow](/azure/active-directory/develop/v1-oauth2-on-behalf-of-flow)auszutauschen.</span><span class="sxs-lookup"><span data-stu-id="1c308-199">This means users won’t have to consent to these scopes and you can then be free to exchange the token server side using AAD’s [on-behalf-of flow](/azure/active-directory/develop/v1-oauth2-on-behalf-of-flow).</span></span> <span data-ttu-id="1c308-200">Diese Problemumgehung ist für interne Branchenanwendungen akzeptabel, aber möglicherweise nicht ausreichend für ISVs, die sich möglicherweise nicht auf die Genehmigung des Mandanten Administrators verlassen können.</span><span class="sxs-lookup"><span data-stu-id="1c308-200">This workaround is acceptable for internal line-of-business applications but may not be enough for ISVs who may not be able to rely on tenant admin approval.</span></span>

<span data-ttu-id="1c308-201">Eine einfache Möglichkeit, im Namen einer Organisation (als mandantenadministrator) einzuwilligen, ist das Besuchen von:</span><span class="sxs-lookup"><span data-stu-id="1c308-201">A simple way of consenting on behalf of an organization (as a tenant admin) is to visit:</span></span>

* `https://login.microsoftonline.com/common/adminconsent?client_id=<AAD_App_ID>`

#### <a name="asking-for-additional-consent-using-the-auth-api"></a><span data-ttu-id="1c308-202">Bitten um zusätzliche Zustimmung mithilfe der Authentifizierungs-API</span><span class="sxs-lookup"><span data-stu-id="1c308-202">Asking for additional consent using the Auth API</span></span>

<span data-ttu-id="1c308-203">Ein weiterer Ansatz für das Hinzufügen zusätzlicher Diagrammbereiche wäre die Präsentation eines Zustimmungs Dialogs mithilfe unseres vorhandenen [webbasierten Aad-Authentifizierungs Ansatzes](~/tabs/how-to/authentication/auth-tab-aad.md#navigate-to-the-authorization-page-from-your-popup-page) , der das Auftauchen eines Aad-Zustimmungs Dialogs beinhaltet.</span><span class="sxs-lookup"><span data-stu-id="1c308-203">Another approach for getting additional Graph scopes would be to present a consent dialog using our existing [web-based AAD authentication approach](~/tabs/how-to/authentication/auth-tab-aad.md#navigate-to-the-authorization-page-from-your-popup-page) which involves popping up an AAD consent dialog.</span></span> <span data-ttu-id="1c308-204">Es gibt einige bemerkenswerte Ergänzungen:</span><span class="sxs-lookup"><span data-stu-id="1c308-204">There are some notable additions:</span></span>

1. <span data-ttu-id="1c308-205">Das mit getAuthToken abgerufene Token muss serverseitig mithilfe [von AADs im Auftrag von Flow](/azure/active-directory/develop/v1-oauth2-on-behalf-of-flow) ausgetauscht werden, um Zugriff auf diese zusätzlichen Graph-APIs zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="1c308-205">The token retrieved using getAuthToken would need to be exchanged server side using AADs [on-behalf-of flow](/azure/active-directory/develop/v1-oauth2-on-behalf-of-flow) to get access to those additional Graph APIs.</span></span>
    * <span data-ttu-id="1c308-206">Stellen Sie sicher, dass Sie den V2-Graph-Endpunkt für diesen Exchange verwenden.</span><span class="sxs-lookup"><span data-stu-id="1c308-206">Be sure to use the v2 Graph endpoint for this exchange</span></span>
2. <span data-ttu-id="1c308-207">Wenn der Exchange-Fehler auftritt, gibt Aad eine ungültige Grant-Ausnahme zurück.</span><span class="sxs-lookup"><span data-stu-id="1c308-207">If the exchange fails, AAD will return an invalid grant exception.</span></span> <span data-ttu-id="1c308-208">Normalerweise gibt es eine von zwei Fehler `ConsentRequired` Meldungen: oder`InteractionRequired`</span><span class="sxs-lookup"><span data-stu-id="1c308-208">There are usually one of two error messages: `ConsentRequired` or `InteractionRequired`</span></span>
3. <span data-ttu-id="1c308-209">Wenn der Exchange-Fehler auftritt, müssen Sie um zusätzliche Zustimmung bitten.</span><span class="sxs-lookup"><span data-stu-id="1c308-209">When the exchange fails, then you need to ask for additional consent.</span></span> <span data-ttu-id="1c308-210">Es wird empfohlen, einige Benutzeroberflächen anzuzeigen, in denen der Benutzer aufgefordert wird, zusätzliche Zustimmung zu erteilen.</span><span class="sxs-lookup"><span data-stu-id="1c308-210">We recommend showing some UI asking the user to grant additional consent.</span></span> <span data-ttu-id="1c308-211">Diese Benutzeroberfläche sollte eine Schaltfläche enthalten, die ein Aad-Zustimmungsdialogfeld mithilfe unserer [Aad-Authentifizierungs-API](~/concepts/authentication/auth-silent-aad.md)auslöst.</span><span class="sxs-lookup"><span data-stu-id="1c308-211">This UI should include a button that triggers an AAD consent dialog using our [AAD authentication API](~/concepts/authentication/auth-silent-aad.md).</span></span>
4. <span data-ttu-id="1c308-212">Wenn Sie eine zusätzliche Zustimmung von Aad anfordern, müssen Sie den `prompt=consent` [Abfrage-String-Parameter](~/tabs/how-to/authentication/auth-silent-aad.md#get-the-user-context) in Aad einschließen, da andernfalls Aad keine weiteren Bereiche abgefragt wird.</span><span class="sxs-lookup"><span data-stu-id="1c308-212">When asking for additional consent from AAD, you need to include `prompt=consent` in your [query-string-parameter](~/tabs/how-to/authentication/auth-silent-aad.md#get-the-user-context) to AAD otherwise AAD will not ask for the additional scopes.</span></span>
    * <span data-ttu-id="1c308-213">Statt:`?scope={scopes}`</span><span class="sxs-lookup"><span data-stu-id="1c308-213">Instead of: `?scope={scopes}`</span></span>
    * <span data-ttu-id="1c308-214">Verwenden Sie Folgendes:`?prompt=consent&scope={scopes}`</span><span class="sxs-lookup"><span data-stu-id="1c308-214">Use this: `?prompt=consent&scope={scopes}`</span></span>
    * <span data-ttu-id="1c308-215">Stellen Sie sicher `{scopes}` , dass alle Bereiche eingeschlossen sind, für die Sie den Benutzer auffordern (z. b.: Mail. Read oder User. Read).</span><span class="sxs-lookup"><span data-stu-id="1c308-215">Be sure that `{scopes}` includes all the scopes you are prompting the user for (ex: Mail.Read or User.Read).</span></span>
5. <span data-ttu-id="1c308-216">Nachdem der Benutzer zusätzliche Berechtigungen erteilt hat, wiederholen Sie den Vorgang im Auftrag von Flow, um Zugriff auf diese zusätzlichen APIs zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="1c308-216">Once the user has granted additional permission, retry the on-behalf-of-flow to get access to these additional APIs.</span></span>

### <a name="non-aad-authentication"></a><span data-ttu-id="1c308-217">Nicht-Aad-Authentifizierung</span><span class="sxs-lookup"><span data-stu-id="1c308-217">Non-AAD Authentication</span></span>

<span data-ttu-id="1c308-218">Die oben beschriebene Authentifizierungslösung funktioniert nur für apps und Dienste, die Azure AD als Identitätsanbieter unterstützen.</span><span class="sxs-lookup"><span data-stu-id="1c308-218">The above-described authentication solution only works for apps and services that support Azure AD as an identity provider.</span></span> <span data-ttu-id="1c308-219">Apps, die mit nicht-Aad basierten Diensten authentifiziert werden möchten, müssen weiterhin den Popup basierten [Webauthentifizierungs Fluss](~/concepts/authentication.md)verwenden.</span><span class="sxs-lookup"><span data-stu-id="1c308-219">Apps that want to authenticate using non-AAD based services need to continue using the popup-based [web authentication flow](~/concepts/authentication.md).</span></span>
