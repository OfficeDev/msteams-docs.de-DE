---
title: Unterstützung für einmaliges Anmelden für Registerkarten
description: Beschreibt einmaliges Anmelden (Single Sign-On, SSO)
ms.topic: how-to
keywords: Teams authentication SSO AAD single sign-on api
ms.openlocfilehash: 9392c3c01a7fa6dffc673cd01f57d0eab1720efe
ms.sourcegitcommit: 976e870cc925f61b76c3830ec04ba6e4bdfde32f
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/27/2021
ms.locfileid: "50014124"
---
# <a name="single-sign-on-sso-support-for-tabs"></a><span data-ttu-id="7b3e9-104">Unterstützung für einmaliges Anmelden (Single Sign-On, SSO) für Registerkarten</span><span class="sxs-lookup"><span data-stu-id="7b3e9-104">Single sign-on (SSO) support for tabs</span></span>

<span data-ttu-id="7b3e9-105">Benutzer melden sich über ihre Geschäfts-, Schul- oder Microsoft-Konten (Office 365, Outlook usw.) bei Microsoft Teams an.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-105">Users sign in to Microsoft Teams via their work, school, or Microsoft accounts (Office 365, Outlook, etc).</span></span> <span data-ttu-id="7b3e9-106">Sie können dies nutzen, indem Sie einer einmaligen Anmeldung erlauben, Ihre Microsoft Teams-Registerkarte (oder Ihr Aufgabenmodul) auf Desktop- oder mobilen Clients zu autorisieren.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-106">You can take advantage of this by allowing a single sign-on to authorize your Microsoft Teams tab (or task module) on desktop or mobile clients.</span></span> <span data-ttu-id="7b3e9-107">Wenn ein Benutzer also der Verwendung Ihrer App zuwilligt, muss er nicht erneut auf einem anderen Gerät zustimmen– er wird automatisch angemeldet.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-107">Thus, if a user consents to use your app, they won’t have to consent again on another device — they will be signed in automatically.</span></span> <span data-ttu-id="7b3e9-108">Darüber hinaus wird ihr Zugriffstoken vorab vorkonfetcht, um die Leistung und Ladezeiten zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-108">In addition, we prefetch your access token to improve performance and load times.</span></span>

>[!NOTE]
> <span data-ttu-id="7b3e9-109">**Mobile Clientversionen von Teams, die SSO unterstützen**</span><span class="sxs-lookup"><span data-stu-id="7b3e9-109">**Teams mobile client versions supporting SSO**</span></span>  
>
> <span data-ttu-id="7b3e9-110">✔Teams für Android (1416/1.0.0.2020073101 und höher)</span><span class="sxs-lookup"><span data-stu-id="7b3e9-110">✔Teams for Android (1416/1.0.0.2020073101 and later)</span></span>
>
> <span data-ttu-id="7b3e9-111">✔Teams für iOS (_Version_: 2.0.18 und höher)</span><span class="sxs-lookup"><span data-stu-id="7b3e9-111">✔Teams for iOS (_Version_: 2.0.18 and later)</span></span>  
>
> <span data-ttu-id="7b3e9-112">Um teams optimal zu nutzen, verwenden Sie bitte die neueste Version von iOS und Android.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-112">For the best experience with Teams, please use the latest version of iOS and Android.</span></span>

>[!NOTE]
> <span data-ttu-id="7b3e9-113">**Schnellstart**</span><span class="sxs-lookup"><span data-stu-id="7b3e9-113">**Quickstart**</span></span>  
>
> <span data-ttu-id="7b3e9-114">Der einfachste Weg für die ersten Schritte mit dem Registerkarten-SSO ist das Microsoft Teams Toolkit for Visual Studio Code.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-114">The simplest path to getting started with tab SSO is with the Microsoft Teams Toolkit for Visual Studio Code.</span></span> [<span data-ttu-id="7b3e9-115">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="7b3e9-115">Learn more</span></span>](../../../toolkit/visual-studio-code-tab-sso.md)


## <a name="how-sso-works-at-runtime"></a><span data-ttu-id="7b3e9-116">Funktionsweise von SSO zur Laufzeit</span><span class="sxs-lookup"><span data-stu-id="7b3e9-116">How SSO works at runtime</span></span>

<span data-ttu-id="7b3e9-117">Das folgende Diagramm zeigt die Funktionsweise des SSO-Prozesses:</span><span class="sxs-lookup"><span data-stu-id="7b3e9-117">The following diagram shows how the SSO process works:</span></span>

<!-- markdownlint-disable MD033 -->
<img src="~/assets/images/tabs/tabs-sso-diagram.png" alt="Tab single sign-on SSO diagram" width="75%"/>

1. <span data-ttu-id="7b3e9-118">Auf der Registerkarte wird ein JavaScript-Aufruf `getAuthToken()` an .</span><span class="sxs-lookup"><span data-stu-id="7b3e9-118">In the tab, a JavaScript call is made to `getAuthToken()`.</span></span> <span data-ttu-id="7b3e9-119">Dies weist Teams an, ein Authentifizierungstoken für die Registerkartenanwendung abzurufen.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-119">This tells Teams to obtain an authentication token for the tab application.</span></span>
2. <span data-ttu-id="7b3e9-120">Wenn dies das erste Mal ist, dass der aktuelle Benutzer Ihre Registerkartenanwendung verwendet, wird eine Anforderungsaufforderung zur Zustimmung (falls die Zustimmung erforderlich ist) oder zur Verarbeitung der Schrittweisen Authentifizierung (z. B. zweistufige Authentifizierung) angezeigt.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-120">If this is the first time the current user has used your tab application, there will be a request prompt to consent (if consent is required) or to handle step-up authentication (such as two-factor authentication).</span></span>
3. <span data-ttu-id="7b3e9-121">Teams fordert das Registerkartenanwendungstoken vom Azure AD-Endpunkt für den aktuellen Benutzer an.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-121">Teams requests the tab application token from the Azure AD endpoint for the current user.</span></span>
4. <span data-ttu-id="7b3e9-122">Azure AD sendet das Registerkartenanwendungstoken an die Teams-Anwendung.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-122">Azure AD sends the tab application token to the Teams application.</span></span>
5. <span data-ttu-id="7b3e9-123">Teams sendet das Registerkartenanwendungstoken als Teil des vom Aufruf zurückgegebenen Ergebnisobjekts an die `getAuthToken()` Registerkarte.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-123">Teams sends the tab application token to the tab as part of the result object returned by the `getAuthToken()` call.</span></span>
6. <span data-ttu-id="7b3e9-124">Das Token wird in der Registerkartenanwendung über JavaScript analysiert, um die erforderlichen Informationen zu extrahieren, z. B. die E-Mail-Adresse des Benutzers.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-124">The token will be parsed in the tab application, via JavaScript, to extract the needed information, such as the user's email address.</span></span>

> [!NOTE]
> <span data-ttu-id="7b3e9-125">Dies gilt nur für die Zustimmung zu einer begrenzten Gruppe von APIs auf Benutzerebene `getAuthToken()` – E-Mail, Profil, offline_access und OpenId – und nicht für weitere Microsoft Graph-Bereiche wie oder `User.Read` `Mail.Read` .</span><span class="sxs-lookup"><span data-stu-id="7b3e9-125">The `getAuthToken()` is only valid for consenting to a limited set of user-level APIs — email, profile, offline_access and OpenId — and not for further Microsoft Graph scopes such as `User.Read` or `Mail.Read`.</span></span> <span data-ttu-id="7b3e9-126">In unserem Abschnitt am Ende dieses Dokuments finden Sie Vorschläge für Problemumgehungen, wenn Sie zusätzliche [Graph-Bereiche benötigen.](#apps-that-require-additional-microsoft-graph-scopes)</span><span class="sxs-lookup"><span data-stu-id="7b3e9-126">See our section at the end of this document for suggested workarounds if you require [additional Graph scopes](#apps-that-require-additional-microsoft-graph-scopes).</span></span>

<span data-ttu-id="7b3e9-127">Die SSO-API funktioniert auch in [Aufgabenmodulen,](../../../task-modules-and-cards/what-are-task-modules.md) die Webinhalte einbetten.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-127">The SSO API will also work in [Task Modules](../../../task-modules-and-cards/what-are-task-modules.md) that embed web content.</span></span>

## <a name="develop-an-sso-microsoft-teams-tab"></a><span data-ttu-id="7b3e9-128">Entwickeln einer Microsoft Teams-SSO-Registerkarte</span><span class="sxs-lookup"><span data-stu-id="7b3e9-128">Develop an SSO Microsoft Teams tab</span></span>

<span data-ttu-id="7b3e9-129">In diesem Abschnitt werden die Aufgaben beschrieben, die beim Erstellen einer Registerkarte "Teams" mit SSO ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-129">This section describes the tasks involved in creating a Teams tab that uses SSO.</span></span> <span data-ttu-id="7b3e9-130">Diese Aufgaben werden hier sprach- und frameworkunabhängig beschrieben.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-130">These tasks are described here are language- and framework-agnostic.</span></span>

### <a name="1-create-your-azure-active-directory-azure-ad-application"></a><span data-ttu-id="7b3e9-131">1. Erstellen Ihrer Azure Active Directory (Azure AD)-Anwendung</span><span class="sxs-lookup"><span data-stu-id="7b3e9-131">1. Create your Azure Active Directory (Azure AD) application</span></span>

#### <a name="registering-your-application-in-theazure-ad-portal-overview"></a><span data-ttu-id="7b3e9-132">Registrieren Ihrer Anwendung im[Azure AD-Portal (](https://azure.microsoft.com/features/azure-portal/) Übersicht):</span><span class="sxs-lookup"><span data-stu-id="7b3e9-132">Registering your application in the[Azure AD portal](https://azure.microsoft.com/features/azure-portal/) overview:</span></span>

1. <span data-ttu-id="7b3e9-133">Erhalten Sie [Ihre Azure AD-Anwendungs-ID.](/azure/active-directory/develop/howto-create-service-principal-portal#get-values-for-signing-in)</span><span class="sxs-lookup"><span data-stu-id="7b3e9-133">Get your [Azure AD Application ID](/azure/active-directory/develop/howto-create-service-principal-portal#get-values-for-signing-in).</span></span>
2. <span data-ttu-id="7b3e9-134">Geben Sie die Berechtigungen an, die Ihre Anwendung für den Azure AD-Endpunkt und optional Microsoft Graph benötigt.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-134">Specify the permissions that your application needs for the Azure AD endpoint and, optionally, Microsoft Graph.</span></span>
3. <span data-ttu-id="7b3e9-135">[Erteilen von Berechtigungen](/azure/active-directory/develop/howto-create-service-principal-portal#configure-access-policies-on-resources) für Desktop-, Web- und mobile Anwendungen von Teams.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-135">[Grant permissions](/azure/active-directory/develop/howto-create-service-principal-portal#configure-access-policies-on-resources) for Teams desktop, web, and mobile applications.</span></span>
4. <span data-ttu-id="7b3e9-136">Autorisieren Sie Teams vorab, indem Sie **die** Schaltfläche "Bereich hinzufügen" auswählen, und geben Sie im bereich, der geöffnet wird, `access_as_user` den **Bereichsnamen ein.**</span><span class="sxs-lookup"><span data-stu-id="7b3e9-136">Pre-authorize Teams by selecting the **Add a scope** button and in the panel that opens, enter `access_as_user` as the **Scope name**.</span></span>

> [!NOTE]
> <span data-ttu-id="7b3e9-137">Es gibt einige wichtige Einschränkungen, die Sie beachten sollten:</span><span class="sxs-lookup"><span data-stu-id="7b3e9-137">There are some important restrictions you should be aware of:</span></span>
>
> * <span data-ttu-id="7b3e9-138">Wir unterstützen nur Microsoft Graph-API-Berechtigungen auf Benutzerebene, d. h. E-Mail, Profil, offline_access, OpenId.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-138">We only support user-level Microsoft Graph API permissions, i.e., email, profile, offline_access, OpenId.</span></span> <span data-ttu-id="7b3e9-139">Wenn Sie Zugriff auf andere Microsoft Graph-Bereiche benötigen (z. B. oder ), lesen Sie unsere empfohlene Problemumgehung am Ende `User.Read` `Mail.Read` dieser Dokumentation. [](#apps-that-require-additional-microsoft-graph-scopes)</span><span class="sxs-lookup"><span data-stu-id="7b3e9-139">If you need access to other Microsoft Graph scopes (such as `User.Read` or `Mail.Read`), see our [recommended workaround](#apps-that-require-additional-microsoft-graph-scopes) at the end of this documentation.</span></span>
> * <span data-ttu-id="7b3e9-140">Es ist wichtig, dass der Domänenname Ihrer Anwendung mit dem Domänennamen identisch ist, den Sie für Ihre Azure AD-Anwendung registriert haben.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-140">It's important that your application's domain name is the same as the domain name you've registering for your Azure AD application.</span></span>
> * <span data-ttu-id="7b3e9-141">Wir unterstützen derzeit nicht mehrere Domänen pro App.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-141">We don't currently support multiple domains per app.</span></span>
> * <span data-ttu-id="7b3e9-142">Anwendungen, die die Domäne verwenden, werden nicht unterstützt, da sie zu häufig verwendet werden und `azurewebsites.net` möglicherweise ein Sicherheitsrisiko darstellen.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-142">We don't support applications that use the `azurewebsites.net` domain because it is too common and may be a security risk.</span></span> <span data-ttu-id="7b3e9-143">Wir versuchen jedoch aktiv, diese Einschränkung zu entfernen.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-143">However, we're actively seeking to remove this restriction.</span></span>

#### <a name="registering-your-app-through-the-azure-active-directory-portal-in-depth"></a><span data-ttu-id="7b3e9-144">Ausführliche Registrierung Ihrer App über das Azure Active Directory-Portal:</span><span class="sxs-lookup"><span data-stu-id="7b3e9-144">Registering your app through the Azure Active Directory portal in-depth:</span></span>

1. <span data-ttu-id="7b3e9-145">Registrieren Sie eine neue Anwendung im [Azure Active Directory – App-Registrierungsportal.](https://go.microsoft.com/fwlink/?linkid=2083908)</span><span class="sxs-lookup"><span data-stu-id="7b3e9-145">Register a new application in the [Azure Active Directory – App Registrations](https://go.microsoft.com/fwlink/?linkid=2083908) portal.</span></span>
2. <span data-ttu-id="7b3e9-146">Wählen **Sie "Neue Registrierung"** aus, und legen Sie auf der *Seite "Anwendung registrieren"* die folgenden Werte ein:</span><span class="sxs-lookup"><span data-stu-id="7b3e9-146">Select **New Registration** and on the *register an application page*, set following values:</span></span>
    * <span data-ttu-id="7b3e9-147">Legen **Sie den** Namen auf ihren App-Namen.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-147">Set **name** to your app name.</span></span>
    * <span data-ttu-id="7b3e9-148">Wählen Sie **die unterstützten Kontotypen** aus (jeder Kontotyp funktioniert) ¹</span><span class="sxs-lookup"><span data-stu-id="7b3e9-148">Choose the **supported account types** (any account type will work) ¹</span></span>
    * <span data-ttu-id="7b3e9-149">Lassen Sie **URI umleiten** leer.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-149">Leave **Redirect URI** empty.</span></span>
    * <span data-ttu-id="7b3e9-150">Wählen Sie **Registrieren** aus.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-150">Choose **Register**.</span></span>
3. <span data-ttu-id="7b3e9-151">Kopieren und speichern Sie auf der Übersichtsseite die **Anwendungs-ID (Client-ID).**</span><span class="sxs-lookup"><span data-stu-id="7b3e9-151">On the overview page, copy and save the **Application (client) ID**.</span></span> <span data-ttu-id="7b3e9-152">Sie benötigen sie später beim Aktualisieren Ihres Teams-Anwendungsmanifests.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-152">You’ll need it later when updating your Teams application manifest.</span></span>
4. <span data-ttu-id="7b3e9-153">Wählen Sie unter **Verwalten** die Option **Eine API verfügbar machen** aus.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-153">Under **Manage**, select **Expose an API**.</span></span> 
5. <span data-ttu-id="7b3e9-154">Wählen Sie den **Link "Set"** aus, um den Anwendungs-ID-URI in Form von zu `api://{AppID}` generieren.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-154">Select the **Set** link to generate the Application ID URI in the form of `api://{AppID}`.</span></span> <span data-ttu-id="7b3e9-155">Fügen Sie Ihren vollqualifizierten Domänennamen (mit einem Schrägstrich "/" am Ende) zwischen den doppelten Schrägstrichen und der GUID ein.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-155">Insert your fully qualified domain name (with a forward slash "/" appended to the end) between the double forward slashes and the GUID.</span></span> <span data-ttu-id="7b3e9-156">Die gesamte ID sollte die Form `api://fully-qualified-domain-name.com/{AppID}` 1 haben:</span><span class="sxs-lookup"><span data-stu-id="7b3e9-156">The entire ID should have the form of: `api://fully-qualified-domain-name.com/{AppID}` ²</span></span>
    * <span data-ttu-id="7b3e9-157">Beispiel: `api://subdomain.example.com/00000000-0000-0000-0000-000000000000` .</span><span class="sxs-lookup"><span data-stu-id="7b3e9-157">ex: `api://subdomain.example.com/00000000-0000-0000-0000-000000000000`.</span></span>
    
    <span data-ttu-id="7b3e9-158">Der vollqualifizierte Domänenname ist der lesbare Domänenname, von dem aus Ihre App bedient wird.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-158">The fully qualified domain name is the human readable domain name from which your app is served.</span></span> <span data-ttu-id="7b3e9-159">Wenn Sie einen Tunnelingdienst wie ngrok verwenden, müssen Sie diesen Wert aktualisieren, sobald sich Ihre ngrok-Unterdomäne ändert.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-159">If you are using a tunneling service such as ngrok, you will need to update     this value whenever your ngrok subdomain changes.</span></span> 
6. <span data-ttu-id="7b3e9-160">Wählen Sie die Schaltfläche **Bereich hinzufügen** aus.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-160">Select the **Add a scope** button.</span></span> <span data-ttu-id="7b3e9-161">Geben Sie im Bereich, der geöffnet wird, `access_as_user` für **Bereichsname** ein.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-161">In the panel that opens, enter `access_as_user` as the **Scope name**.</span></span>
7. <span data-ttu-id="7b3e9-162">Festlegen, **wer zustimmen kann?**`Admins and users`</span><span class="sxs-lookup"><span data-stu-id="7b3e9-162">Set **Who can consent?** to `Admins and users`</span></span>
8. <span data-ttu-id="7b3e9-163">Füllen Sie die Felder für die Konfiguration der Eingabeaufforderungen für Administratoren und Benutzer mit Werten aus, die für den Bereich geeignet `access_as_user` sind:</span><span class="sxs-lookup"><span data-stu-id="7b3e9-163">Fill in the fields for configuring the admin and user consent prompts with values that are appropriate for the `access_as_user` scope:</span></span>
    * <span data-ttu-id="7b3e9-164">**Titel der Administrator-Zustimmung:** Teams können auf das Profil des Benutzers zugreifen.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-164">**Admin consent title:** Teams can access the user’s profile.</span></span>
    * <span data-ttu-id="7b3e9-165">**Beschreibung der** Administrator-Zustimmung: Ermöglicht Teams das Aufrufen der App-Web-APIs als aktueller Benutzer.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-165">**Admin consent description**: Allows Teams to call the app’s web APIs as the current user.</span></span>
    * <span data-ttu-id="7b3e9-166">**Benutzer-Zustimmungstitel:** Teams kann auf das Benutzerprofil zugreifen und Anforderungen im Namen des Benutzers stellen.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-166">**User consent title**: Teams can access the user profile and make requests on the user's behalf.</span></span>
    * <span data-ttu-id="7b3e9-167">**Beschreibung der Benutzer zustimmung:** Ermöglichen Sie Teams, die APIs dieser App mit denselben Rechten wie der Benutzer auf aufruft.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-167">**User consent description:** Enable Teams to call this app’s APIs with the same rights as the user.</span></span>
9. <span data-ttu-id="7b3e9-168">Stellen Sie **sicher, dass "State"** auf **"Enabled" festgelegt ist.**</span><span class="sxs-lookup"><span data-stu-id="7b3e9-168">Ensure that **State** is set to **Enabled**</span></span>
10. <span data-ttu-id="7b3e9-169">Select the **Add scope** button to save</span><span class="sxs-lookup"><span data-stu-id="7b3e9-169">Select the **Add scope** button to save</span></span> 
    * <span data-ttu-id="7b3e9-170">Der Domänenteil  des Bereichsnamens, der direkt unterhalb des Textfelds angezeigt wird, sollte automatisch mit dem **anwendungs-ID-URI** übereinstimmen, der im vorherigen Schritt festgelegt wurde, und am Ende angefügt `/access_as_user` werden:</span><span class="sxs-lookup"><span data-stu-id="7b3e9-170">The domain part of the **Scope name** displayed just below the text field should automatically match the **Application ID** URI set in the previous step, with `/access_as_user` appended to the end:</span></span>
        * `api://subdomain.example.com/00000000-0000-0000-0000-000000000000/access_as_user`
11. <span data-ttu-id="7b3e9-171">Identifizieren Sie **im Abschnitt "Autorisierte Clientanwendungen"** die Anwendungen, die Sie für die Webanwendung Ihrer App autorisieren möchten.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-171">In the **Authorized client applications** section, identify the applications that you want to authorize for your app’s web application.</span></span> <span data-ttu-id="7b3e9-172">Wählen *Sie "Clientanwendung hinzufügen" aus.*</span><span class="sxs-lookup"><span data-stu-id="7b3e9-172">Select *Add a client application*.</span></span> <span data-ttu-id="7b3e9-173">Geben Sie jede der folgenden Client-IDs ein, und wählen Sie den autorisierten Bereich aus, den Sie im vorherigen Schritt erstellt haben:</span><span class="sxs-lookup"><span data-stu-id="7b3e9-173">Enter each of the following client IDs and select the authorized scope you created in the previous step:</span></span>
    * <span data-ttu-id="7b3e9-174">`1fec8e78-bce4-4aaf-ab1b-5451cc387264` (Mobile Teams-/Desktopanwendung)</span><span class="sxs-lookup"><span data-stu-id="7b3e9-174">`1fec8e78-bce4-4aaf-ab1b-5451cc387264` (Teams mobile/desktop application)</span></span>
    * <span data-ttu-id="7b3e9-175">`5e3ce6c0-2b1f-4285-8d4b-75ee78787346` (Teams-Webanwendung)</span><span class="sxs-lookup"><span data-stu-id="7b3e9-175">`5e3ce6c0-2b1f-4285-8d4b-75ee78787346` (Teams web application)</span></span>
12. <span data-ttu-id="7b3e9-176">Navigieren Sie zu **API-Berechtigungen.**</span><span class="sxs-lookup"><span data-stu-id="7b3e9-176">Navigate to **API Permissions**.</span></span> <span data-ttu-id="7b3e9-177">Wählen *Sie "Delegierte Berechtigungen für* Microsoft Graph hinzufügen" aus, und fügen Sie dann die folgenden Berechtigungen aus der Microsoft  >    >  Graph-API hinzu:</span><span class="sxs-lookup"><span data-stu-id="7b3e9-177">Select *Add a permission* > *Microsoft Graph* > *Delegated permissions*, then add the following permissions from Microsoft Graph API:</span></span>
    * <span data-ttu-id="7b3e9-178">User.Read (standardmäßig aktiviert)</span><span class="sxs-lookup"><span data-stu-id="7b3e9-178">User.Read (enabled by default)</span></span>
    * <span data-ttu-id="7b3e9-179">email</span><span class="sxs-lookup"><span data-stu-id="7b3e9-179">email</span></span>
    * <span data-ttu-id="7b3e9-180">offline_access</span><span class="sxs-lookup"><span data-stu-id="7b3e9-180">offline_access</span></span>
    * <span data-ttu-id="7b3e9-181">OpenId</span><span class="sxs-lookup"><span data-stu-id="7b3e9-181">OpenId</span></span>
    * <span data-ttu-id="7b3e9-182">Profil</span><span class="sxs-lookup"><span data-stu-id="7b3e9-182">profile</span></span>

13. <span data-ttu-id="7b3e9-183">Navigieren zur **Authentifizierung**</span><span class="sxs-lookup"><span data-stu-id="7b3e9-183">Navigate to **Authentication**</span></span>

    <span data-ttu-id="7b3e9-184">Wenn einer App keine Zustimmung des IT-Admins erteilt wurde, müssen Benutzer ihre Zustimmung erteilen, wenn sie eine App zum ersten Mal verwenden.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-184">If an app hasn't been granted IT admin consent, users will have to provide consent the first time they use an app.</span></span>

    <span data-ttu-id="7b3e9-185">Festlegen eines Umleitungs-URI:</span><span class="sxs-lookup"><span data-stu-id="7b3e9-185">Set a redirect URI:</span></span>
    * <span data-ttu-id="7b3e9-186">Wählen Sie **"Plattform hinzufügen" aus.**</span><span class="sxs-lookup"><span data-stu-id="7b3e9-186">Select **Add a platform**.</span></span>
    * <span data-ttu-id="7b3e9-187">Wählen Sie **Web** aus.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-187">Select **web**.</span></span>
    * <span data-ttu-id="7b3e9-188">Geben Sie den **Umleitungs-URI** für Ihre App ein.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-188">Enter the **redirect URI** for your app.</span></span> <span data-ttu-id="7b3e9-189">Dies ist die Seite, auf der der Benutzer durch einen erfolgreichen impliziten Genehmigungsfluss umgeleitet wird.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-189">This will be the page where a successful implicit grant flow will redirect the user.</span></span> <span data-ttu-id="7b3e9-190">Dies ist derselbe vollqualifizierte Domänenname, den Sie in Schritt 5 eingegeben haben, gefolgt von der API-Route, an die eine Authentifizierungsantwort gesendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-190">This will be same fully qualified domain name that you entered in step 5 followed by the API route where a authentication response should be sent.</span></span> <span data-ttu-id="7b3e9-191">Wenn Sie einem der Teams-Beispiele folgen, ist dies Folgendes: `https://subdomain.example.com/auth-end`</span><span class="sxs-lookup"><span data-stu-id="7b3e9-191">If you are following any of the Teams samples, this will be: `https://subdomain.example.com/auth-end`</span></span>

    <span data-ttu-id="7b3e9-192">Aktivieren Sie als Nächstes die implizite Gewährung, indem Sie die folgenden Kontrollkästchen aktivieren:</span><span class="sxs-lookup"><span data-stu-id="7b3e9-192">Next, enable implicit grant by checking the following boxes:</span></span>  
    <span data-ttu-id="7b3e9-193">✔-ID-Token</span><span class="sxs-lookup"><span data-stu-id="7b3e9-193">✔ ID Token</span></span>  
    <span data-ttu-id="7b3e9-194">✔ Zugriffstoken</span><span class="sxs-lookup"><span data-stu-id="7b3e9-194">✔ Access Token</span></span>  
    
<span data-ttu-id="7b3e9-195">Herzlichen Glückwunsch!</span><span class="sxs-lookup"><span data-stu-id="7b3e9-195">Congratulations!</span></span> <span data-ttu-id="7b3e9-196">Sie haben die Voraussetzungen für die App-Registrierung erfüllt, um mit ihrer Registerkarten-SSO-App fortzufahren.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-196">You have completed the app registration prerequisites to proceed with your tab SSO app.</span></span>     

> [!NOTE]
>
> * <span data-ttu-id="7b3e9-197">¹ Wenn Ihre Azure AD-App im selben Mandanten registriert ist, in dem Sie eine Authentifizierungsanforderung in Teams stellen, wird der Benutzer nicht zur Zustimmung aufgefordert und erhält sofort ein Zugriffstoken. </span><span class="sxs-lookup"><span data-stu-id="7b3e9-197">¹ If your Azure AD app is registered in the _same_ tenant where you're making an authentication request in Teams, the user won't be asked to consent and will be granted an access token right away.</span></span> <span data-ttu-id="7b3e9-198">Benutzer müssen diesen Berechtigungen nur zustimmen, wenn die Azure AD-App in einem anderen Mandanten registriert ist.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-198">Users only need to consent to these permissions if the Azure AD app is registered in a different tenant.</span></span>
> * <span data-ttu-id="7b3e9-199">Wenn Sie eine Fehlermeldung erhalten, die besagt, dass die Domäne bereits im Besitz ist und Sie der Besitzer sind, führen Sie das Verfahren unter [Schnellstart aus:](/azure/active-directory/fundamentals/add-custom-domain) Fügen Sie Azure Active Directory einen benutzerdefinierten Domänennamen hinzu, um die Domäne zu registrieren, und wiederholen Sie dann Schritt 5 oben.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-199">² If you get an error stating that the domain is already owned and you are the owner, follow the procedure at [Quickstart: Add a custom domain name to Azure Active Directory](/azure/active-directory/fundamentals/add-custom-domain) to register the domain, and then repeat step 5, above.</span></span> <span data-ttu-id="7b3e9-200">(Dieser Fehler kann auch auftreten, wenn Sie nicht mit Administratoranmeldeinformationen in der Office 365-Mandanz angemeldet sind).</span><span class="sxs-lookup"><span data-stu-id="7b3e9-200">(This error can also occur if you aren't signed in with Admin credentials in the Office 365 tenancy).</span></span>
> * <span data-ttu-id="7b3e9-201">Wenn Sie den UPN (Benutzerprinzipalnamen) im zurückgegebenen Zugriffstoken nicht erhalten, können Sie ihn als [optionalen](https://docs.microsoft.com/azure/active-directory/develop/active-directory-optional-claims) Anspruch in Azure AD hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-201">If you are not receiving the UPN (User Principal Name) in the returned access token, you can add it as an [optional claim](https://docs.microsoft.com/azure/active-directory/develop/active-directory-optional-claims) in Azure AD.</span></span>

### <a name="2-update-your-microsoft-teams-application-manifest"></a><span data-ttu-id="7b3e9-202">2. Aktualisieren Ihres Microsoft Teams-Anwendungsmanifests</span><span class="sxs-lookup"><span data-stu-id="7b3e9-202">2. Update your Microsoft Teams application manifest</span></span>

<span data-ttu-id="7b3e9-203">Fügen Sie Ihrem Microsoft Teams-Manifest neue Eigenschaften hinzu:</span><span class="sxs-lookup"><span data-stu-id="7b3e9-203">Add new properties to your Microsoft Teams manifest:</span></span>

* <span data-ttu-id="7b3e9-204">**WebApplicationInfo** – Das übergeordnete Element der folgenden Elemente:</span><span class="sxs-lookup"><span data-stu-id="7b3e9-204">**WebApplicationInfo** - The parent of the following elements:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="7b3e9-205">**id** – Die Client-ID der Anwendung.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-205">**id** - The client ID of the application.</span></span> <span data-ttu-id="7b3e9-206">Dies ist die Anwendungs-ID, die Sie im Rahmen der Registrierung der Anwendung bei Azure AD erhalten haben.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-206">This is the application ID that you obtained as part of registering the application with Azure AD.</span></span>
>* <span data-ttu-id="7b3e9-207">**resource** – Die Domäne und Unterdomäne Ihrer Anwendung.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-207">**resource** - The domain and subdomain of your application.</span></span> <span data-ttu-id="7b3e9-208">Dies ist der gleiche URI (einschließlich des Protokolls), den Sie beim Erstellen in Schritt `api://` `scope` 6 oben registriert haben.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-208">This is the same URI (including the `api://` protocol) that you registered when creating your `scope` in step 6 above.</span></span> <span data-ttu-id="7b3e9-209">Sie sollten den Pfad nicht `access_as_user` in Ihre Ressource verwenden.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-209">You shouldn't include the `access_as_user` path in your resource.</span></span> <span data-ttu-id="7b3e9-210">Der Domänenteil dieses URI sollte mit der Domäne übereinstimmen, einschließlich aller Unterdomänen, die in den URLs Ihres Anwendungsmanifests von Teams verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-210">The domain part of this URI should match the domain, including any subdomains, used in the URLs of your Teams application manifest.</span></span>

```json
"webApplicationInfo": {
  "id": "00000000-0000-0000-0000-000000000000",
  "resource": "api://subdomain.example.com/00000000-0000-0000-0000-000000000000"
}
```

> [!NOTE]
>
>* <span data-ttu-id="7b3e9-211">Die Ressource für eine AAD-App ist in der Regel der Stamm der Website-URL und der appID (z. `api://subdomain.example.com/00000000-0000-0000-0000-000000000000` B.).</span><span class="sxs-lookup"><span data-stu-id="7b3e9-211">The resource for an AAD app will usually be the root of its site URL and the appID (e.g. `api://subdomain.example.com/00000000-0000-0000-0000-000000000000`).</span></span> <span data-ttu-id="7b3e9-212">Wir verwenden diesen Wert auch, um sicherzustellen, dass Ihre Anforderung von derselben Domäne kommt.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-212">We also use this value to ensure your request is coming from the same domain.</span></span> <span data-ttu-id="7b3e9-213">Stellen Sie daher sicher, dass die `contentURL` Registerkarte für Ihre Registerkarte dieselben Domänen wie Ihre Ressourceneigenschaft verwendet.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-213">Therefore, make sure that the `contentURL` for your tab uses the same domains as your resource property.</span></span>
>* <span data-ttu-id="7b3e9-214">Sie müssen die Manifestversion 1.5 oder höher verwenden, um das Feld zu `webApplicationInfo` implementieren.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-214">You need to use manifest version 1.5 or higher to implement the `webApplicationInfo` field.</span></span>

### <a name="3-get-an-authentication-token-from-your-client-side-code"></a><span data-ttu-id="7b3e9-215">3. Erhalten eines Authentifizierungstokens aus Ihrem clientseitigen Code</span><span class="sxs-lookup"><span data-stu-id="7b3e9-215">3. Get an authentication token from your client-side code</span></span>

<span data-ttu-id="7b3e9-216">So sieht die Authentifizierungs-API aus:</span><span class="sxs-lookup"><span data-stu-id="7b3e9-216">Here's what the authentication API looks like:</span></span>

```javascript
var authTokenRequest = {
  successCallback: function(result) { console.log("Success: " + result); },
  failureCallback: function(error) { console.log("Failure: " + error); }
};
microsoftTeams.authentication.getAuthToken(authTokenRequest);
```

<span data-ttu-id="7b3e9-217">Wenn Sie anrufen – und zusätzliche Zustimmung des Benutzers ist erforderlich (für Berechtigungen auf Benutzerebene) – wird dem Benutzer ein Dialogfeld angezeigt, in dem er dazu ermuntert wird, zusätzliche `getAuthToken` Zustimmung zu erteilen.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-217">When you call `getAuthToken` - and additional user consent is required (for user-level permissions) - we will show a dialog to the user encouraging them to grant additional consent.</span></span> 

<span data-ttu-id="7b3e9-218">Nachdem Sie das Zugriffstoken im Erfolgsrückruf erhalten haben, können Sie das Zugriffstoken decodieren, um die mit diesem Token verknüpften Ansprüche anzeigen zu können.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-218">Once you've received the access token in the success callback you can decode the access token to view the claims associated with that token.</span></span> <span data-ttu-id="7b3e9-219">(Optional können Sie das Zugriffstoken manuell kopieren/in ein Tool einfügen, z. B. [JWT.io,](https://jwt.io/) um den Inhalt zu überprüfen).</span><span class="sxs-lookup"><span data-stu-id="7b3e9-219">(Optionally, you can manually copy/paste the access token into a tool such as [JWT.io](https://jwt.io/) to inspect its contents).</span></span> <span data-ttu-id="7b3e9-220">Wenn Sie den UPN (Benutzerprinzipalnamen) im zurückgegebenen Zugriffstoken nicht erhalten, können Sie ihn als [optionalen](https://docs.microsoft.com/azure/active-directory/develop/active-directory-optional-claims) Anspruch in Azure AD hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-220">If you are not receiving the UPN (User Principal Name) in the returned access token, you can add it as an [optional claim](https://docs.microsoft.com/azure/active-directory/develop/active-directory-optional-claims) in Azure AD.</span></span>

<p>
    <img src="~/assets/images/tabs/tabs-sso-prompt.png" alt="Tab single sign-on SSO dialog prompt" width="75%"/>
</p>

## <a name="sample-code"></a><span data-ttu-id="7b3e9-221">Beispielcode</span><span class="sxs-lookup"><span data-stu-id="7b3e9-221">Sample code</span></span>

<span data-ttu-id="7b3e9-222">Besuchen Sie unsere Beispielanwendung: [MSTeams PnP-SSO-Beispiel](https://github.com/pnp/teams-dev-samples/tree/master/samples/tab-sso)</span><span class="sxs-lookup"><span data-stu-id="7b3e9-222">Visit our sample application: [MSTeams PnP SSO Sample](https://github.com/pnp/teams-dev-samples/tree/master/samples/tab-sso)</span></span>

<span data-ttu-id="7b3e9-223">ReadME erläutert, wie Sie Ihre Entwicklungsumgebung einrichten und Ihre Anwendung in Azure AD konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-223">The README explains how to set up your development environment and how to configure your application in Azure AD.</span></span> <span data-ttu-id="7b3e9-224">Weitere Informationen zur Struktur des Beispiels finden [](https://github.com/OfficeDev/msteams-tabs-sso-sample-nodejs#app-structure) Sie auch im Abschnitt "App-Struktur", um sich mit der Codebasis vertraut zu machen.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-224">You can also find further information on how the sample is structured in the [app structure section](https://github.com/OfficeDev/msteams-tabs-sso-sample-nodejs#app-structure) to help familiarize yourself with the codebase.</span></span>

## <a name="known-limitations"></a><span data-ttu-id="7b3e9-225">Bekannte Einschränkungen</span><span class="sxs-lookup"><span data-stu-id="7b3e9-225">Known Limitations</span></span>

### <a name="apps-that-require-additional-microsoft-graph-scopes"></a><span data-ttu-id="7b3e9-226">Apps, die zusätzliche Microsoft Graph-Bereiche erfordern</span><span class="sxs-lookup"><span data-stu-id="7b3e9-226">Apps that require additional Microsoft Graph Scopes</span></span>

<span data-ttu-id="7b3e9-227">Unsere aktuelle Implementierung für SSO erteilt nur zustimmungsberechtigungen auf Benutzerebene – E-Mail, Profil, offline_access, OpenId – nicht für andere APIs (z. B. User.Read oder Mail.Read).</span><span class="sxs-lookup"><span data-stu-id="7b3e9-227">Our current implementation for SSO only grants consent for user-level permissions — email, profile, offline_access, OpenId — not for other APIs (such as User.Read or Mail.Read).</span></span> <span data-ttu-id="7b3e9-228">Wenn Ihre App weitere Microsoft Graph-Bereiche benötigt, finden Sie hier einige mögliche Problemumgehungen:</span><span class="sxs-lookup"><span data-stu-id="7b3e9-228">If your app needs further Microsoft Graph scopes, here are some enabling workarounds:</span></span>

#### <a name="tenant-admin-consent"></a><span data-ttu-id="7b3e9-229">Mandantenadministrator-Zustimmung</span><span class="sxs-lookup"><span data-stu-id="7b3e9-229">Tenant Admin Consent</span></span>

<span data-ttu-id="7b3e9-230">Der einfachste Ansatz besteht in der Vorab zustimmung eines Mandantenadministrators im Namen der Organisation.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-230">The simplest approach is to get a tenant admin to pre-consent on behalf of the organization.</span></span> <span data-ttu-id="7b3e9-231">Dies bedeutet, dass Benutzer diesen Bereich nicht zustimmen müssen, und Sie können dann die Tokenserverseite mithilfe des [Im-Auftrag-von-Ablaufs](/azure/active-directory/develop/v1-oauth2-on-behalf-of-flow)von Azure AD austauschen.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-231">This means users won’t have to consent to these scopes and you can then be free to exchange the token server side using Azure AD’s [on-behalf-of flow](/azure/active-directory/develop/v1-oauth2-on-behalf-of-flow).</span></span> <span data-ttu-id="7b3e9-232">Diese Problemumgehung ist für interne Line-of-Business-Anwendungen akzeptabel, reicht aber möglicherweise nicht für Drittanbieterentwickler aus, die sich möglicherweise nicht auf die Genehmigung des Mandantenadministrators verlassen können.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-232">This workaround is acceptable for internal line-of-business applications but may not be enough for third-party developers who may not be able to rely on tenant admin approval.</span></span>

<span data-ttu-id="7b3e9-233">Eine einfache Möglichkeit der Zustimmung im Namen einer Organisation (als Mandantenadministrator) besteht im Besuch:</span><span class="sxs-lookup"><span data-stu-id="7b3e9-233">A simple way of consenting on behalf of an organization (as a tenant admin) is to visit:</span></span>

* `https://login.microsoftonline.com/common/adminconsent?client_id=<AAD_App_ID>`

#### <a name="asking-for-additional-consent-using-the-auth-api"></a><span data-ttu-id="7b3e9-234">Bitten um zusätzliche Zustimmung mithilfe der Authentifizierungs-API</span><span class="sxs-lookup"><span data-stu-id="7b3e9-234">Asking for additional consent using the Auth API</span></span>

<span data-ttu-id="7b3e9-235">Ein weiterer Ansatz zum Abrufen zusätzlicher Microsoft Graph-Bereiche ist die Darstellung eines Zustimmungsdialogfelds mithilfe unseres vorhandenen webbasierten Azure AD-Authentifizierungsansatzes, bei dem ein Azure [AD-Zustimmungsdialogfeld](~/tabs/how-to/authentication/auth-tab-aad.md#navigate-to-the-authorization-page-from-your-popup-page) angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-235">Another approach for getting additional Microsoft Graph scopes is to present a consent dialog using our existing [web-based Azure AD authentication approach](~/tabs/how-to/authentication/auth-tab-aad.md#navigate-to-the-authorization-page-from-your-popup-page) which involves popping up an Azure AD consent dialog.</span></span> <span data-ttu-id="7b3e9-236">Es gibt einige wichtige Ergänzungen:</span><span class="sxs-lookup"><span data-stu-id="7b3e9-236">There are some notable additions:</span></span>

1. <span data-ttu-id="7b3e9-237">Das mithilfe der Verwendung abgerufene Token muss serverseitig mithilfe des `getAuthToken()` Azure [AD-Im-Auftrag-von-Ablaufs](/azure/active-directory/develop/v2-oauth2-on-behalf-of-flow) ausgetauscht werden, um Zugriff auf diese zusätzlichen Microsoft Graph-APIs zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-237">The token retrieved using `getAuthToken()` needs to be exchanged server-side using Azure AD [on-behalf-of flow](/azure/active-directory/develop/v2-oauth2-on-behalf-of-flow) to get access to those additional Microsoft Graph APIs.</span></span>
    * <span data-ttu-id="7b3e9-238">Achten Sie darauf, den v2 Microsoft Graph-Endpunkt für diesen Austausch zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-238">Be sure to use the v2 Microsoft Graph endpoint for this exchange</span></span>
2. <span data-ttu-id="7b3e9-239">Wenn der Austausch fehlschlägt, gibt Azure AD eine ungültige Erteilungsausnahme zurück.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-239">If the exchange fails, Azure AD will return an invalid grant exception.</span></span> <span data-ttu-id="7b3e9-240">Es gibt in der Regel eine von zwei Fehlermeldungen: `invalid_grant` oder `interaction_required`</span><span class="sxs-lookup"><span data-stu-id="7b3e9-240">There are usually one of two error messages: `invalid_grant` or `interaction_required`</span></span>
3. <span data-ttu-id="7b3e9-241">Wenn der Austausch fehlschlägt, müssen Sie um zusätzliche Zustimmung bitten.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-241">When the exchange fails, then you need to ask for additional consent.</span></span> <span data-ttu-id="7b3e9-242">Es wird empfohlen, eine Benutzeroberfläche zu zeigen, in der der Benutzer aufgefordert wird, eine zusätzliche Zustimmung zu erteilen.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-242">We recommend showing some UI asking the user to grant additional consent.</span></span> <span data-ttu-id="7b3e9-243">Diese Benutzeroberfläche sollte eine Schaltfläche enthalten, die ein Azure AD-Zustimmungsdialogfeld mithilfe unserer [Azure AD-Authentifizierungs-API auslöst.](~/concepts/authentication/auth-silent-aad.md)</span><span class="sxs-lookup"><span data-stu-id="7b3e9-243">This UI should include a button that triggers an Azure AD consent dialog using our [Azure AD authentication API](~/concepts/authentication/auth-silent-aad.md).</span></span>
4. <span data-ttu-id="7b3e9-244">Wenn Sie eine zusätzliche Zustimmung von Azure AD einholen, müssen Sie `prompt=consent` ihren [Abfragezeichenfolgenparameter](~/tabs/how-to/authentication/auth-silent-aad.md#get-the-user-context) in Azure AD angeben, andernfalls fordert Azure AD die zusätzlichen Bereiche nicht an.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-244">When asking for additional consent from Azure AD, you need to include `prompt=consent` in your [query-string-parameter](~/tabs/how-to/authentication/auth-silent-aad.md#get-the-user-context) to Azure AD otherwise Azure AD will not ask for the additional scopes.</span></span>
    * <span data-ttu-id="7b3e9-245">Statt: `?scope={scopes}`</span><span class="sxs-lookup"><span data-stu-id="7b3e9-245">Instead of: `?scope={scopes}`</span></span>
    * <span data-ttu-id="7b3e9-246">Verwenden Sie dies: `?prompt=consent&scope={scopes}`</span><span class="sxs-lookup"><span data-stu-id="7b3e9-246">Use this: `?prompt=consent&scope={scopes}`</span></span>
    * <span data-ttu-id="7b3e9-247">Achten Sie darauf, dass alle Bereiche enthalten sind, für die Der Benutzer aufgefordert wird (z. B. `{scopes}` Mail.Read oder User.Read).</span><span class="sxs-lookup"><span data-stu-id="7b3e9-247">Be sure that `{scopes}` includes all the scopes you are prompting the user for (ex: Mail.Read or User.Read).</span></span>
5. <span data-ttu-id="7b3e9-248">Nachdem der Benutzer zusätzliche Berechtigungen erteilt hat, wiederholen Sie den Im-Auftrag-von-Fluss, um Zugriff auf diese zusätzlichen APIs zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-248">Once the user has granted additional permission, retry the on-behalf-of-flow to get access to these additional APIs.</span></span>

### <a name="non-azure-ad-authentication"></a><span data-ttu-id="7b3e9-249">Nicht-Azure AD-Authentifizierung</span><span class="sxs-lookup"><span data-stu-id="7b3e9-249">Non-Azure AD Authentication</span></span>

<span data-ttu-id="7b3e9-250">Die oben beschriebene Authentifizierungslösung funktioniert nur für Apps und Dienste, die Azure AD als Identitätsanbieter unterstützen.</span><span class="sxs-lookup"><span data-stu-id="7b3e9-250">The above-described authentication solution only works for apps and services that support Azure AD as an identity provider.</span></span> <span data-ttu-id="7b3e9-251">Apps, die sich mit nicht azure AD-basierten Diensten authentifizieren möchten, müssen weiterhin den Pop-up-basierten [Webauthentifizierungsfluss verwenden.](~/concepts/authentication.md)</span><span class="sxs-lookup"><span data-stu-id="7b3e9-251">Apps that want to authenticate using non-Azure AD based services need to continue using the pop-up-based [web authentication flow](~/concepts/authentication.md).</span></span>
