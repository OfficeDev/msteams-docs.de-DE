---
title: Authentifizierungsfluss für Registerkarten
description: Beschreibt den Authentifizierungsfluss auf Registerkarten
ms.topic: conceptual
keywords: Registerkarten für den Authentifizierungsfluss von Teams
ms.openlocfilehash: 9505419a6594529bcf8d19a90d029705e573c67b
ms.sourcegitcommit: 976e870cc925f61b76c3830ec04ba6e4bdfde32f
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/27/2021
ms.locfileid: "50014586"
---
# <a name="microsoft-teams-authentication-flow-for-tabs"></a><span data-ttu-id="190b9-104">Microsoft Teams-Authentifizierungsfluss für Registerkarten</span><span class="sxs-lookup"><span data-stu-id="190b9-104">Microsoft Teams authentication flow for tabs</span></span>

> [!Note]
> <span data-ttu-id="190b9-105">Damit die Authentifizierung für Ihre Registerkarte auf mobilen Clients funktioniert, müssen Sie sicherstellen, dass Sie mindestens die Version 1.4.1 des JavaScript SDK für Teams verwenden.</span><span class="sxs-lookup"><span data-stu-id="190b9-105">For authentication to work for your tab on mobile clients, you need to ensure you're using at least the 1.4.1 version of the Teams JavaScript SDK.</span></span>
> <span data-ttu-id="190b9-106">Das Teams SDK startet ein separates Fenster für den Authentifizierungsfluss, und daher kann dasselbe Standortattribut auf "Lax" festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="190b9-106">Teams SDK launches separate window for authentication flow and hence samesite attribute can be set to 'Lax'.</span></span> <span data-ttu-id="190b9-107">Derzeit wird SameSite=None vom Desktopclient von Teams oder älteren Versionen von Chrome oder Safari nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="190b9-107">Currently, SameSite=None is not supported by the Teams desktop client or older versions of Chrome or Safari.</span></span>

<span data-ttu-id="190b9-108">OAuth 2.0 ist ein offener Standard für die Authentifizierung und Autorisierung, der von Azure AD und vielen anderen Identitätsanbietern verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="190b9-108">OAuth 2.0 is an open standard for authentication and authorization used by Azure AD and many other identity providers.</span></span> <span data-ttu-id="190b9-109">Ein grundlegendes Verständnis von OAuth 2.0 ist eine Voraussetzung für die Arbeit mit der Authentifizierung in Teams; [Hier finden Sie eine gute Übersicht,](https://aaronparecki.com/oauth-2-simplified/) die einfacher zu befolgen ist als die [formale Spezifikation.](https://oauth.net/2/)</span><span class="sxs-lookup"><span data-stu-id="190b9-109">A basic understanding of OAuth 2.0 is a prerequisite for working with authentication in Teams; [here's a good overview](https://aaronparecki.com/oauth-2-simplified/) that's easier to follow than the [formal specification](https://oauth.net/2/).</span></span> <span data-ttu-id="190b9-110">Der Authentifizierungsfluss für Registerkarten und Bots ist etwas anders, da Registerkarten Websites sehr ähnlich sind, sodass sie OAuth 2.0 direkt verwenden können. Bots sind nicht und müssen einige Dinge anders tun, aber die Kernkonzepte sind identisch.</span><span class="sxs-lookup"><span data-stu-id="190b9-110">Authentication flow for tabs and bots are a little different because tabs are very similar to websites so they can use OAuth 2.0 directly; bots are not and must do a few things differently, but the core concepts are identical.</span></span>

<span data-ttu-id="190b9-111">*Unter* ["Initiieren des Authentifizierungsflusses](~/tabs/how-to/authentication/auth-tab-aad.md#initiate-authentication-flow) für Registerkarten" finden Sie ein Beispiel für den Authentifizierungsfluss für Registerkarten und Bots, die Node und den impliziten [OAuth 2.0-Gewährungstyp verwenden.](https://oauth.net/2/grant-types/implicit/)</span><span class="sxs-lookup"><span data-stu-id="190b9-111">*See*, [Initiate authentication flow for tabs](~/tabs/how-to/authentication/auth-tab-aad.md#initiate-authentication-flow) for an example of authentication flow for tabs and bots using Node and the [OAuth 2.0 implicit grant type](https://oauth.net/2/grant-types/implicit/).</span></span>

![Diagramm der Registerkartenauthentifizierungssequenz](~/assets/images/authentication/tab_auth_sequence_diagram.png)

1. <span data-ttu-id="190b9-113">Der Benutzer interagiert mit dem Inhalt auf der Registerkartenkonfiguration oder Inhaltsseite, in der Regel eine Schaltfläche mit der Bezeichnung "Anmelden" oder "Anmelden".</span><span class="sxs-lookup"><span data-stu-id="190b9-113">The user interacts with the content on the tab configuration or content page, commonly a button labeled "Sign in" or "Log in".</span></span>
2. <span data-ttu-id="190b9-114">Die Registerkarte erstellt die URL für die Startseite der Authentifizierung, optional mithilfe von Informationen von URL-Platzhaltern oder durch Aufrufen der Teams-Client-SDK-Methode, um die Authentifizierungserfahrung für den Benutzer `microsoftTeams.getContext()` zu optimieren.</span><span class="sxs-lookup"><span data-stu-id="190b9-114">The tab constructs the URL for its auth start page, optionally using information from URL placeholders or by calling `microsoftTeams.getContext()` Teams client SDK method to streamline the authentication experience for the user.</span></span> <span data-ttu-id="190b9-115">Wenn der Parameter beispielsweise bei der Authentifizierung mit Azure AD auf die E-Mail-Adresse des Benutzers festgelegt ist, muss sich der Benutzer möglicherweise nicht einmal anmelden, wenn er dies kürzlich getan hat, da Azure AD die zwischengespeicherten Anmeldeinformationen des Benutzers nach Möglichkeit verwendet: Das Popup blinkt kurz und verschwindet `login_hint` dann.</span><span class="sxs-lookup"><span data-stu-id="190b9-115">For example, when authenticating with Azure AD, if the `login_hint` parameter is set to the user's email address, the user may not even have to sign in if they have done so recently, because Azure AD will use the user's cached credentials if possible: the popup will flash briefly and then disappear.</span></span>
3. <span data-ttu-id="190b9-116">Auf der Registerkarte wird dann die `microsoftTeams.authentication.authenticate()`-Methode aufgerufen und die `successCallback`- und die `failureCallback`-Funktion registriert.</span><span class="sxs-lookup"><span data-stu-id="190b9-116">The tab then calls the `microsoftTeams.authentication.authenticate()` method and registers the `successCallback` and `failureCallback` functions.</span></span>
4. <span data-ttu-id="190b9-117">Teams öffnet die Startseite in einem iframe in einem Popupfenster.</span><span class="sxs-lookup"><span data-stu-id="190b9-117">Teams opens the start page in an iframe in a pop-up window.</span></span> <span data-ttu-id="190b9-118">Die Startseite generiert zufällige Daten, speichert sie für die zukünftige Überprüfung und leitet sie an den Endpunkt des Identitätsanbieters um, z. B. `state` `/authorize` für Azure `https://login.microsoftonline.com/<tenant ID>/oauth2/authorize` AD.</span><span class="sxs-lookup"><span data-stu-id="190b9-118">The start page generates random `state` data, saves it for future validation, and redirects to the identity provider's `/authorize` endpoint such as `https://login.microsoftonline.com/<tenant ID>/oauth2/authorize` for Azure AD.</span></span> <span data-ttu-id="190b9-119">Ersetzen `<tenant id>` Sie diese durch Ihre eigene Mandanten-ID (context.tid).</span><span class="sxs-lookup"><span data-stu-id="190b9-119">Replace `<tenant id>` with your own tenant id (context.tid).</span></span>
    * <span data-ttu-id="190b9-120">Wie bei anderen Authentifizierungsflüssen in Teams muss sich die Startseite in einer Domäne befinden, die sich in ihrer Liste und in derselben Domäne wie die Umleitungsseite nach der Anmeldung `validDomains` befinden.</span><span class="sxs-lookup"><span data-stu-id="190b9-120">Like other application auth flows in Teams, the start page must be on a domain that's in its `validDomains` list, and on the same domain as the post-login redirect page.</span></span>
    * <span data-ttu-id="190b9-121">**WICHTIG:** Der implizite OAuth 2.0-Genehmigungsfluss ruft einen Parameter in der Authentifizierungsanforderung auf, der eindeutige Sitzungsdaten enthält, um einen angriffsübergreifenden Angriff auf `state` Anforderungsfälscher [zu verhindern.](https://en.wikipedia.org/wiki/Cross-site_request_forgery)</span><span class="sxs-lookup"><span data-stu-id="190b9-121">**IMPORTANT**: The OAuth 2.0 implicit grant flow calls for a `state` parameter in the authentication request which contains unique session data to prevent a [cross-site request forgery attack](https://en.wikipedia.org/wiki/Cross-site_request_forgery).</span></span> <span data-ttu-id="190b9-122">In den folgenden Beispielen wird eine zufällig generierte GUID für die Daten `state` verwendet.</span><span class="sxs-lookup"><span data-stu-id="190b9-122">The examples below use a randomly-generated GUID for the `state` data.</span></span>
5. <span data-ttu-id="190b9-123">Auf der Website des Anbieters meldet sich der Benutzer an und gewährt Zugriff auf die Registerkarte.</span><span class="sxs-lookup"><span data-stu-id="190b9-123">On the provider's site, the user signs in and grants access to the tab.</span></span>
6. <span data-ttu-id="190b9-124">Der Anbieter leitet den Benutzer mit einem Zugriffstoken zur OAuth 2.0-Umleitungsseite der Registerkarte.</span><span class="sxs-lookup"><span data-stu-id="190b9-124">The provider takes the user to the tab's OAuth 2.0 redirect page with an access token.</span></span>
7. <span data-ttu-id="190b9-125">Die Registerkarte überprüft, ob der zurückgegebene Wert dem entspricht, was zuvor gespeichert wurde, und ruft auf, wodurch wiederum die in Schritt 3 registrierte `state` `microsoftTeams.authentication.notifySuccess()` Funktion `successCallback` aufruft.</span><span class="sxs-lookup"><span data-stu-id="190b9-125">The tab checks that the returned `state` value matches what was saved earlier, and calls `microsoftTeams.authentication.notifySuccess()`, which in turn calls the `successCallback` function registered in step 3.</span></span>
8. <span data-ttu-id="190b9-126">Teams schließt das Popupfenster.</span><span class="sxs-lookup"><span data-stu-id="190b9-126">Teams closes the pop-up window.</span></span>
9. <span data-ttu-id="190b9-127">Auf der Registerkarte wird entweder die Konfigurationsbenutzeroberfläche angezeigt oder der Inhalt der Registerkarten aktualisiert oder neu geladen, je nachdem, wo der Benutzer begonnen hat.</span><span class="sxs-lookup"><span data-stu-id="190b9-127">The tab either displays configuration UI or refreshes or reloads the tabs content, depending on where the user started from.</span></span>

## <a name="treat-tab-context-as-hints"></a><span data-ttu-id="190b9-128">Behandeln des Registerkartenkontexts als Hinweise</span><span class="sxs-lookup"><span data-stu-id="190b9-128">Treat tab context as hints</span></span>

<span data-ttu-id="190b9-129">Obwohl der Registerkartenkontext hilfreiche Informationen zum Benutzer enthält, sollten Sie diese Informationen nicht verwenden, um den Benutzer zu authentifizieren, unabhängig davon, ob Sie sie als URL-Parameter für Ihre Registerkarteninhalts-URL oder durch Aufrufen der Funktion im `microsoftTeams.getContext()` Microsoft Teams-Client-SDK erhalten.</span><span class="sxs-lookup"><span data-stu-id="190b9-129">Although the tab context provides helpful information regarding the user, don't use this information to authenticate the user whether you get it as URL parameters to your tab content URL or by calling the `microsoftTeams.getContext()` function in the Microsoft Teams client SDK.</span></span> <span data-ttu-id="190b9-130">Ein böswilliger Akteur könnte die URL des Registerkarteninhalts mit seinen eigenen Parametern aufrufen, und eine Webseite, die microsoft Teams als Identitätswechsel antsprecht, könnte die URL des Registerkarteninhalts in einem iframe laden und eigene Daten an die Funktion `getContext()` zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="190b9-130">A malicious actor could invoke your tab content URL with its own parameters, and a web page impersonating Microsoft Teams could load your tab content URL in an iframe and return its own data to the `getContext()` function.</span></span> <span data-ttu-id="190b9-131">Sie sollten die identitätsbezogenen Informationen im Registerkartenkontext einfach als Hinweise behandeln und vor der Verwendung überprüfen.</span><span class="sxs-lookup"><span data-stu-id="190b9-131">You should treat the identity-related information in the tab context simply as hints and validate them before use.</span></span> <span data-ttu-id="190b9-132">Lesen Sie die Hinweise unter [Navigieren zur Autorisierungsseite von Ihrer Popupseite aus.](~/tabs/how-to/authentication/auth-tab-aad.md#navigate-to-the-authorization-page-from-your-popup-page)</span><span class="sxs-lookup"><span data-stu-id="190b9-132">Refer to the notes in [Navigate to the authorization page from your popup page](~/tabs/how-to/authentication/auth-tab-aad.md#navigate-to-the-authorization-page-from-your-popup-page).</span></span>

## <a name="samples"></a><span data-ttu-id="190b9-133">Beispiele</span><span class="sxs-lookup"><span data-stu-id="190b9-133">Samples</span></span>

<span data-ttu-id="190b9-134">Beispielcode für den Prozess der Registerkartenauthentifizierung finden Sie unter:</span><span class="sxs-lookup"><span data-stu-id="190b9-134">For sample code showing the tab authentication process see:</span></span>

* [<span data-ttu-id="190b9-135">Beispiel für die Microsoft Teams-Registerkartenauthentifizierung (Knoten)</span><span class="sxs-lookup"><span data-stu-id="190b9-135">Microsoft Teams tab authentication sample (Node)</span></span>](https://github.com/OfficeDev/microsoft-teams-sample-complete-node)
* [<span data-ttu-id="190b9-136">Beispiel für die Registerkartenauthentifizierung in Microsoft Teams (C#)</span><span class="sxs-lookup"><span data-stu-id="190b9-136">Microsoft Teams tab authentication sample (C#)</span></span>](https://github.com/OfficeDev/microsoft-teams-sample-complete-csharp)

## <a name="more-details"></a><span data-ttu-id="190b9-137">Weitere Details</span><span class="sxs-lookup"><span data-stu-id="190b9-137">More details</span></span>

<span data-ttu-id="190b9-138">Eine ausführliche implementierungs exemplarische Vorgehensweise für die Registerkartenauthentifizierung für Azure Active Directory finden Sie unter:</span><span class="sxs-lookup"><span data-stu-id="190b9-138">For a detailed implementation walkthrough for tab authentication targeting Azure Active Directory see:</span></span>

* [<span data-ttu-id="190b9-139">Authentifizieren eines Benutzers auf einer Microsoft Teams-Registerkarte</span><span class="sxs-lookup"><span data-stu-id="190b9-139">Authenticate a user in a Microsoft Teams tab</span></span>](~/tabs/how-to/authentication/auth-tab-AAD.md)
* [<span data-ttu-id="190b9-140">Automatische Authentifizierung</span><span class="sxs-lookup"><span data-stu-id="190b9-140">Silent authentication</span></span>](~/tabs/how-to/authentication/auth-silent-AAD.md)
